;;; -*- coding: utf-8; -*-

(in-package :jp-numeral.test)

(defun test-jp-formal-integer-4digits ()
  ;; 0
  (assert-equal "〇" (jp-str :formal 0))
  ;; 1-9
  (assert-equal "壱" (jp-str :formal 1))
  (assert-equal "弐" (jp-str :formal 2))
  (assert-equal "参" (jp-str :formal 3))
  (assert-equal "四" (jp-str :formal 4))
  (assert-equal "五" (jp-str :formal 5))
  (assert-equal "六" (jp-str :formal 6))
  (assert-equal "七" (jp-str :formal 7))
  (assert-equal "八" (jp-str :formal 8))
  (assert-equal "九" (jp-str :formal 9))
  ;; 10-19
  (assert-equal "拾" (jp-str :formal 10))
  (assert-equal "拾壱" (jp-str :formal 11))
  (assert-equal "拾弐" (jp-str :formal 12))
  (assert-equal "拾参" (jp-str :formal 13))
  (assert-equal "拾四" (jp-str :formal 14))
  (assert-equal "拾五" (jp-str :formal 15))
  (assert-equal "拾六" (jp-str :formal 16))
  (assert-equal "拾七" (jp-str :formal 17))
  (assert-equal "拾八" (jp-str :formal 18))
  (assert-equal "拾九" (jp-str :formal 19))
  ;; 20-99
  (assert-equal "弐拾" (jp-str :formal 20))
  (assert-equal "弐拾壱" (jp-str :formal 21))
  (assert-equal "弐拾九" (jp-str :formal 29))
  (assert-equal "参拾" (jp-str :formal 30))
  (assert-equal "参拾壱" (jp-str :formal 31))
  (assert-equal "参拾九" (jp-str :formal 39))
  (assert-equal "四拾" (jp-str :formal 40))
  (assert-equal "四拾壱" (jp-str :formal 41))
  (assert-equal "四拾九" (jp-str :formal 49))
  (assert-equal "五拾" (jp-str :formal 50))
  (assert-equal "五拾壱" (jp-str :formal 51))
  (assert-equal "五拾九" (jp-str :formal 59))
  (assert-equal "六拾" (jp-str :formal 60))
  (assert-equal "六拾壱" (jp-str :formal 61))
  (assert-equal "六拾九" (jp-str :formal 69))
  (assert-equal "七拾" (jp-str :formal 70))
  (assert-equal "七拾壱" (jp-str :formal 71))
  (assert-equal "七拾九" (jp-str :formal 79))
  (assert-equal "八拾" (jp-str :formal 80))
  (assert-equal "八拾壱" (jp-str :formal 81))
  (assert-equal "八拾九" (jp-str :formal 89))
  (assert-equal "九拾" (jp-str :formal 90))
  (assert-equal "九拾壱" (jp-str :formal 91))
  (assert-equal "九拾九" (jp-str :formal 99))
  ;; 100
  (assert-equal "壱百" (jp-str :formal 100))
  ;; 101-109
  (assert-equal "壱百壱" (jp-str :formal 101))
  (assert-equal "壱百弐" (jp-str :formal 102))
  (assert-equal "壱百参" (jp-str :formal 103))
  (assert-equal "壱百四" (jp-str :formal 104))
  (assert-equal "壱百五" (jp-str :formal 105))
  (assert-equal "壱百六" (jp-str :formal 106))
  (assert-equal "壱百七" (jp-str :formal 107))
  (assert-equal "壱百八" (jp-str :formal 108))
  (assert-equal "壱百九" (jp-str :formal 109))
  ;; 110-119
  (assert-equal "壱百拾" (jp-str :formal 110))
  (assert-equal "壱百拾壱" (jp-str :formal 111))
  (assert-equal "壱百拾弐" (jp-str :formal 112))
  (assert-equal "壱百拾参" (jp-str :formal 113))
  (assert-equal "壱百拾四" (jp-str :formal 114))
  (assert-equal "壱百拾五" (jp-str :formal 115))
  (assert-equal "壱百拾六" (jp-str :formal 116))
  (assert-equal "壱百拾七" (jp-str :formal 117))
  (assert-equal "壱百拾八" (jp-str :formal 118))
  (assert-equal "壱百拾九" (jp-str :formal 119))
  ;; 120-199
  (assert-equal "壱百弐拾" (jp-str :formal 120))
  (assert-equal "壱百弐拾壱" (jp-str :formal 121))
  (assert-equal "壱百弐拾九" (jp-str :formal 129))
  (assert-equal "壱百参拾" (jp-str :formal 130))
  (assert-equal "壱百参拾壱" (jp-str :formal 131))
  (assert-equal "壱百参拾九" (jp-str :formal 139))
  (assert-equal "壱百四拾" (jp-str :formal 140))
  (assert-equal "壱百四拾壱" (jp-str :formal 141))
  (assert-equal "壱百四拾九" (jp-str :formal 149))
  (assert-equal "壱百五拾" (jp-str :formal 150))
  (assert-equal "壱百五拾壱" (jp-str :formal 151))
  (assert-equal "壱百五拾九" (jp-str :formal 159))
  (assert-equal "壱百六拾" (jp-str :formal 160))
  (assert-equal "壱百六拾壱" (jp-str :formal 161))
  (assert-equal "壱百六拾九" (jp-str :formal 169))
  (assert-equal "壱百七拾" (jp-str :formal 170))
  (assert-equal "壱百七拾壱" (jp-str :formal 171))
  (assert-equal "壱百七拾九" (jp-str :formal 179))
  (assert-equal "壱百八拾" (jp-str :formal 180))
  (assert-equal "壱百八拾壱" (jp-str :formal 181))
  (assert-equal "壱百八拾九" (jp-str :formal 189))
  (assert-equal "壱百九拾" (jp-str :formal 190))
  (assert-equal "壱百九拾壱" (jp-str :formal 191))
  (assert-equal "壱百九拾九" (jp-str :formal 199))
  ;; 200-999
  (assert-equal "弐百" (jp-str :formal 200))
  (assert-equal "弐百壱" (jp-str :formal 201))
  (assert-equal "弐百九" (jp-str :formal 209))
  (assert-equal "弐百拾" (jp-str :formal 210))
  (assert-equal "弐百拾壱" (jp-str :formal 211))
  (assert-equal "弐百拾九" (jp-str :formal 219))
  (assert-equal "弐百弐拾" (jp-str :formal 220))
  (assert-equal "弐百弐拾壱" (jp-str :formal 221))
  (assert-equal "弐百九拾九" (jp-str :formal 299))
  (assert-equal "参百" (jp-str :formal 300))
  (assert-equal "参百壱" (jp-str :formal 301))
  (assert-equal "参百九" (jp-str :formal 309))
  (assert-equal "参百拾" (jp-str :formal 310))
  (assert-equal "参百拾壱" (jp-str :formal 311))
  (assert-equal "参百拾九" (jp-str :formal 319))
  (assert-equal "参百弐拾" (jp-str :formal 320))
  (assert-equal "参百弐拾壱" (jp-str :formal 321))
  (assert-equal "参百九拾九" (jp-str :formal 399))
  (assert-equal "四百" (jp-str :formal 400))
  (assert-equal "四百壱" (jp-str :formal 401))
  (assert-equal "四百九" (jp-str :formal 409))
  (assert-equal "四百拾" (jp-str :formal 410))
  (assert-equal "四百拾壱" (jp-str :formal 411))
  (assert-equal "四百拾九" (jp-str :formal 419))
  (assert-equal "四百弐拾" (jp-str :formal 420))
  (assert-equal "四百弐拾壱" (jp-str :formal 421))
  (assert-equal "四百九拾九" (jp-str :formal 499))
  (assert-equal "五百" (jp-str :formal 500))
  (assert-equal "五百壱" (jp-str :formal 501))
  (assert-equal "五百九" (jp-str :formal 509))
  (assert-equal "五百拾" (jp-str :formal 510))
  (assert-equal "五百拾壱" (jp-str :formal 511))
  (assert-equal "五百拾九" (jp-str :formal 519))
  (assert-equal "五百弐拾" (jp-str :formal 520))
  (assert-equal "五百弐拾壱" (jp-str :formal 521))
  (assert-equal "五百九拾九" (jp-str :formal 599))
  (assert-equal "六百" (jp-str :formal 600))
  (assert-equal "六百壱" (jp-str :formal 601))
  (assert-equal "六百九" (jp-str :formal 609))
  (assert-equal "六百拾" (jp-str :formal 610))
  (assert-equal "六百拾壱" (jp-str :formal 611))
  (assert-equal "六百拾九" (jp-str :formal 619))
  (assert-equal "六百弐拾" (jp-str :formal 620))
  (assert-equal "六百弐拾壱" (jp-str :formal 621))
  (assert-equal "六百九拾九" (jp-str :formal 699))
  (assert-equal "七百" (jp-str :formal 700))
  (assert-equal "七百壱" (jp-str :formal 701))
  (assert-equal "七百九" (jp-str :formal 709))
  (assert-equal "七百拾" (jp-str :formal 710))
  (assert-equal "七百拾壱" (jp-str :formal 711))
  (assert-equal "七百拾九" (jp-str :formal 719))
  (assert-equal "七百弐拾" (jp-str :formal 720))
  (assert-equal "七百弐拾壱" (jp-str :formal 721))
  (assert-equal "七百九拾九" (jp-str :formal 799))
  (assert-equal "八百" (jp-str :formal 800))
  (assert-equal "八百壱" (jp-str :formal 801))
  (assert-equal "八百九" (jp-str :formal 809))
  (assert-equal "八百拾" (jp-str :formal 810))
  (assert-equal "八百拾壱" (jp-str :formal 811))
  (assert-equal "八百拾九" (jp-str :formal 819))
  (assert-equal "八百弐拾" (jp-str :formal 820))
  (assert-equal "八百弐拾壱" (jp-str :formal 821))
  (assert-equal "八百九拾九" (jp-str :formal 899))
  (assert-equal "九百" (jp-str :formal 900))
  (assert-equal "九百壱" (jp-str :formal 901))
  (assert-equal "九百九" (jp-str :formal 909))
  (assert-equal "九百拾" (jp-str :formal 910))
  (assert-equal "九百拾壱" (jp-str :formal 911))
  (assert-equal "九百拾九" (jp-str :formal 919))
  (assert-equal "九百弐拾" (jp-str :formal 920))
  (assert-equal "九百弐拾壱" (jp-str :formal 921))
  (assert-equal "九百九拾九" (jp-str :formal 999))
  ;; 1000 - 1099
  (assert-equal "壱千" (jp-str :formal 1000))
  (assert-equal "壱千壱" (jp-str :formal 1001))
  (assert-equal "壱千弐" (jp-str :formal 1002))
  (assert-equal "壱千九" (jp-str :formal 1009))
  (assert-equal "壱千拾" (jp-str :formal 1010))
  (assert-equal "壱千拾壱" (jp-str :formal 1011))
  (assert-equal "壱千拾九" (jp-str :formal 1019))
  (assert-equal "壱千弐拾" (jp-str :formal 1020))
  (assert-equal "壱千弐拾壱" (jp-str :formal 1021))
  (assert-equal "壱千弐拾九" (jp-str :formal 1029))
  (assert-equal "壱千参拾" (jp-str :formal 1030))
  (assert-equal "壱千九拾九" (jp-str :formal 1099))
  ;; 1100 - 9999
  (assert-equal "壱千壱百" (jp-str :formal 1100))
  (assert-equal "壱千壱百壱" (jp-str :formal 1101))
  (assert-equal "壱千壱百九" (jp-str :formal 1109))
  (assert-equal "壱千壱百拾" (jp-str :formal 1110))
  (assert-equal "壱千壱百拾壱" (jp-str :formal 1111))
  (assert-equal "壱千壱百拾九" (jp-str :formal 1119))
  (assert-equal "壱千壱百弐拾" (jp-str :formal 1120))
  (assert-equal "壱千壱百弐拾壱" (jp-str :formal 1121))
  (assert-equal "壱千壱百弐拾九" (jp-str :formal 1129))
  (assert-equal "壱千壱百九拾九" (jp-str :formal 1199))
  (assert-equal "壱千弐百" (jp-str :formal 1200))
  (assert-equal "壱千弐百壱" (jp-str :formal 1201))
  (assert-equal "壱千弐百九" (jp-str :formal 1209))
  (assert-equal "壱千弐百拾" (jp-str :formal 1210))
  (assert-equal "壱千弐百拾壱" (jp-str :formal 1211))
  (assert-equal "壱千弐百拾九" (jp-str :formal 1219))
  (assert-equal "壱千弐百弐拾" (jp-str :formal 1220))
  (assert-equal "壱千弐百弐拾壱" (jp-str :formal 1221))
  (assert-equal "壱千弐百弐拾九" (jp-str :formal 1229))
  (assert-equal "壱千弐百九拾九" (jp-str :formal 1299))
  (assert-equal "壱千九百" (jp-str :formal 1900))
  (assert-equal "壱千九百壱" (jp-str :formal 1901))
  (assert-equal "壱千九百九" (jp-str :formal 1909))
  (assert-equal "壱千九百拾" (jp-str :formal 1910))
  (assert-equal "壱千九百拾壱" (jp-str :formal 1911))
  (assert-equal "壱千九百拾九" (jp-str :formal 1919))
  (assert-equal "壱千九百弐拾" (jp-str :formal 1920))
  (assert-equal "壱千九百弐拾壱" (jp-str :formal 1921))
  (assert-equal "壱千九百弐拾九" (jp-str :formal 1929))
  (assert-equal "壱千九百九拾九" (jp-str :formal 1999))
  ;; 2000 - 9999
  (assert-equal "弐千" (jp-str :formal 2000))
  (assert-equal "弐千壱" (jp-str :formal 2001))
  (assert-equal "弐千拾" (jp-str :formal 2010))
  (assert-equal "弐千拾壱" (jp-str :formal 2011))
  (assert-equal "弐千弐拾" (jp-str :formal 2020))
  (assert-equal "弐千弐拾壱" (jp-str :formal 2021))
  (assert-equal "弐千壱百" (jp-str :formal 2100))
  (assert-equal "弐千壱百壱" (jp-str :formal 2101))
  (assert-equal "弐千壱百拾" (jp-str :formal 2110))
  (assert-equal "弐千壱百拾壱" (jp-str :formal 2111))
  (assert-equal "弐千壱百弐拾" (jp-str :formal 2120))
  (assert-equal "弐千壱百弐拾壱" (jp-str :formal 2121))
  (assert-equal "弐千弐百" (jp-str :formal 2200))
  (assert-equal "弐千弐百壱" (jp-str :formal 2201))
  (assert-equal "弐千弐百拾" (jp-str :formal 2210))
  (assert-equal "弐千弐百拾壱" (jp-str :formal 2211))
  (assert-equal "弐千弐百弐拾" (jp-str :formal 2220))
  (assert-equal "弐千弐百弐拾壱" (jp-str :formal 2221))
  (assert-equal "参千" (jp-str :formal 3000))
  (assert-equal "参千壱" (jp-str :formal 3001))
  (assert-equal "参千拾" (jp-str :formal 3010))
  (assert-equal "参千拾壱" (jp-str :formal 3011))
  (assert-equal "参千弐拾" (jp-str :formal 3020))
  (assert-equal "参千弐拾壱" (jp-str :formal 3021))
  (assert-equal "参千壱百" (jp-str :formal 3100))
  (assert-equal "参千壱百壱" (jp-str :formal 3101))
  (assert-equal "参千壱百拾" (jp-str :formal 3110))
  (assert-equal "参千壱百拾壱" (jp-str :formal 3111))
  (assert-equal "参千壱百弐拾" (jp-str :formal 3120))
  (assert-equal "参千壱百弐拾壱" (jp-str :formal 3121))
  (assert-equal "参千弐百" (jp-str :formal 3200))
  (assert-equal "参千弐百壱" (jp-str :formal 3201))
  (assert-equal "参千弐百拾" (jp-str :formal 3210))
  (assert-equal "参千弐百拾壱" (jp-str :formal 3211))
  (assert-equal "参千弐百弐拾" (jp-str :formal 3220))
  (assert-equal "参千弐百弐拾壱" (jp-str :formal 3221))
  (assert-equal "四千" (jp-str :formal 4000))
  (assert-equal "四千壱" (jp-str :formal 4001))
  (assert-equal "四千拾" (jp-str :formal 4010))
  (assert-equal "四千拾壱" (jp-str :formal 4011))
  (assert-equal "四千弐拾" (jp-str :formal 4020))
  (assert-equal "四千弐拾壱" (jp-str :formal 4021))
  (assert-equal "四千壱百" (jp-str :formal 4100))
  (assert-equal "四千壱百壱" (jp-str :formal 4101))
  (assert-equal "四千壱百拾" (jp-str :formal 4110))
  (assert-equal "四千壱百拾壱" (jp-str :formal 4111))
  (assert-equal "四千壱百弐拾" (jp-str :formal 4120))
  (assert-equal "四千壱百弐拾壱" (jp-str :formal 4121))
  (assert-equal "四千弐百" (jp-str :formal 4200))
  (assert-equal "四千弐百壱" (jp-str :formal 4201))
  (assert-equal "四千弐百拾" (jp-str :formal 4210))
  (assert-equal "四千弐百拾壱" (jp-str :formal 4211))
  (assert-equal "四千弐百弐拾" (jp-str :formal 4220))
  (assert-equal "四千弐百弐拾壱" (jp-str :formal 4221))
  (assert-equal "五千" (jp-str :formal 5000))
  (assert-equal "五千壱" (jp-str :formal 5001))
  (assert-equal "五千拾" (jp-str :formal 5010))
  (assert-equal "五千拾壱" (jp-str :formal 5011))
  (assert-equal "五千弐拾" (jp-str :formal 5020))
  (assert-equal "五千弐拾壱" (jp-str :formal 5021))
  (assert-equal "五千壱百" (jp-str :formal 5100))
  (assert-equal "五千壱百壱" (jp-str :formal 5101))
  (assert-equal "五千壱百拾" (jp-str :formal 5110))
  (assert-equal "五千壱百拾壱" (jp-str :formal 5111))
  (assert-equal "五千壱百弐拾" (jp-str :formal 5120))
  (assert-equal "五千壱百弐拾壱" (jp-str :formal 5121))
  (assert-equal "五千弐百" (jp-str :formal 5200))
  (assert-equal "五千弐百壱" (jp-str :formal 5201))
  (assert-equal "五千弐百拾" (jp-str :formal 5210))
  (assert-equal "五千弐百拾壱" (jp-str :formal 5211))
  (assert-equal "五千弐百弐拾" (jp-str :formal 5220))
  (assert-equal "五千弐百弐拾壱" (jp-str :formal 5221))
  (assert-equal "六千" (jp-str :formal 6000))
  (assert-equal "六千壱" (jp-str :formal 6001))
  (assert-equal "六千拾" (jp-str :formal 6010))
  (assert-equal "六千拾壱" (jp-str :formal 6011))
  (assert-equal "六千弐拾" (jp-str :formal 6020))
  (assert-equal "六千弐拾壱" (jp-str :formal 6021))
  (assert-equal "六千壱百" (jp-str :formal 6100))
  (assert-equal "六千壱百壱" (jp-str :formal 6101))
  (assert-equal "六千壱百拾" (jp-str :formal 6110))
  (assert-equal "六千壱百拾壱" (jp-str :formal 6111))
  (assert-equal "六千壱百弐拾" (jp-str :formal 6120))
  (assert-equal "六千壱百弐拾壱" (jp-str :formal 6121))
  (assert-equal "六千弐百" (jp-str :formal 6200))
  (assert-equal "六千弐百壱" (jp-str :formal 6201))
  (assert-equal "六千弐百拾" (jp-str :formal 6210))
  (assert-equal "六千弐百拾壱" (jp-str :formal 6211))
  (assert-equal "六千弐百弐拾" (jp-str :formal 6220))
  (assert-equal "六千弐百弐拾壱" (jp-str :formal 6221))
  (assert-equal "七千" (jp-str :formal 7000))
  (assert-equal "七千壱" (jp-str :formal 7001))
  (assert-equal "七千拾" (jp-str :formal 7010))
  (assert-equal "七千拾壱" (jp-str :formal 7011))
  (assert-equal "七千弐拾" (jp-str :formal 7020))
  (assert-equal "七千弐拾壱" (jp-str :formal 7021))
  (assert-equal "七千壱百" (jp-str :formal 7100))
  (assert-equal "七千壱百壱" (jp-str :formal 7101))
  (assert-equal "七千壱百拾" (jp-str :formal 7110))
  (assert-equal "七千壱百拾壱" (jp-str :formal 7111))
  (assert-equal "七千壱百弐拾" (jp-str :formal 7120))
  (assert-equal "七千壱百弐拾壱" (jp-str :formal 7121))
  (assert-equal "七千弐百" (jp-str :formal 7200))
  (assert-equal "七千弐百壱" (jp-str :formal 7201))
  (assert-equal "七千弐百拾" (jp-str :formal 7210))
  (assert-equal "七千弐百拾壱" (jp-str :formal 7211))
  (assert-equal "七千弐百弐拾" (jp-str :formal 7220))
  (assert-equal "七千弐百弐拾壱" (jp-str :formal 7221))
  (assert-equal "八千" (jp-str :formal 8000))
  (assert-equal "八千壱" (jp-str :formal 8001))
  (assert-equal "八千拾" (jp-str :formal 8010))
  (assert-equal "八千拾壱" (jp-str :formal 8011))
  (assert-equal "八千弐拾" (jp-str :formal 8020))
  (assert-equal "八千弐拾壱" (jp-str :formal 8021))
  (assert-equal "八千壱百" (jp-str :formal 8100))
  (assert-equal "八千壱百壱" (jp-str :formal 8101))
  (assert-equal "八千壱百拾" (jp-str :formal 8110))
  (assert-equal "八千壱百拾壱" (jp-str :formal 8111))
  (assert-equal "八千壱百弐拾" (jp-str :formal 8120))
  (assert-equal "八千壱百弐拾壱" (jp-str :formal 8121))
  (assert-equal "八千弐百" (jp-str :formal 8200))
  (assert-equal "八千弐百壱" (jp-str :formal 8201))
  (assert-equal "八千弐百拾" (jp-str :formal 8210))
  (assert-equal "八千弐百拾壱" (jp-str :formal 8211))
  (assert-equal "八千弐百弐拾" (jp-str :formal 8220))
  (assert-equal "八千弐百弐拾壱" (jp-str :formal 8221))
  (assert-equal "九千" (jp-str :formal 9000))
  (assert-equal "九千壱" (jp-str :formal 9001))
  (assert-equal "九千拾" (jp-str :formal 9010))
  (assert-equal "九千拾壱" (jp-str :formal 9011))
  (assert-equal "九千弐拾" (jp-str :formal 9020))
  (assert-equal "九千弐拾壱" (jp-str :formal 9021))
  (assert-equal "九千壱百" (jp-str :formal 9100))
  (assert-equal "九千壱百壱" (jp-str :formal 9101))
  (assert-equal "九千壱百拾" (jp-str :formal 9110))
  (assert-equal "九千壱百拾壱" (jp-str :formal 9111))
  (assert-equal "九千壱百弐拾" (jp-str :formal 9120))
  (assert-equal "九千壱百弐拾壱" (jp-str :formal 9121))
  (assert-equal "九千弐百" (jp-str :formal 9200))
  (assert-equal "九千弐百壱" (jp-str :formal 9201))
  (assert-equal "九千弐百拾" (jp-str :formal 9210))
  (assert-equal "九千弐百拾壱" (jp-str :formal 9211))
  (assert-equal "九千弐百弐拾" (jp-str :formal 9220))
  (assert-equal "九千弐百弐拾壱" (jp-str :formal 9221))
  (assert-equal "九千九百九拾九" (jp-str :formal 9999))
  ;; 
  t)

(defun test-jp-formal-integer-bignums ()
  ;; 10000 - 19999
  (assert-equal "壱万" (jp-str :formal 10000))
  (assert-equal "壱万壱" (jp-str :formal 10001))
  (assert-equal "壱万九" (jp-str :formal 10009))
  (assert-equal "壱万拾" (jp-str :formal 10010))
  (assert-equal "壱万拾壱" (jp-str :formal 10011))
  (assert-equal "壱万拾九" (jp-str :formal 10019))
  (assert-equal "壱万弐拾" (jp-str :formal 10020))
  (assert-equal "壱万弐拾壱" (jp-str :formal 10021))
  (assert-equal "壱万弐拾九" (jp-str :formal 10029))
  (assert-equal "壱万壱百" (jp-str :formal 10100))
  (assert-equal "壱万壱百壱" (jp-str :formal 10101))
  (assert-equal "壱万壱百九" (jp-str :formal 10109))
  (assert-equal "壱万壱百拾" (jp-str :formal 10110))
  (assert-equal "壱万壱百拾壱" (jp-str :formal 10111))
  (assert-equal "壱万壱百拾九" (jp-str :formal 10119))
  (assert-equal "壱万壱百弐拾" (jp-str :formal 10120))
  (assert-equal "壱万壱百弐拾壱" (jp-str :formal 10121))
  (assert-equal "壱万壱百弐拾九" (jp-str :formal 10129))
  (assert-equal "壱万弐百" (jp-str :formal 10200))
  (assert-equal "壱万弐百壱" (jp-str :formal 10201))
  (assert-equal "壱万弐百九" (jp-str :formal 10209))
  (assert-equal "壱万弐百拾" (jp-str :formal 10210))
  (assert-equal "壱万弐百拾壱" (jp-str :formal 10211))
  (assert-equal "壱万弐百拾九" (jp-str :formal 10219))
  (assert-equal "壱万弐百弐拾" (jp-str :formal 10220))
  (assert-equal "壱万弐百弐拾壱" (jp-str :formal 10221))
  (assert-equal "壱万弐百弐拾九" (jp-str :formal 10229))
  (assert-equal "壱万壱千" (jp-str :formal 11000))
  (assert-equal "壱万壱千壱" (jp-str :formal 11001))
  (assert-equal "壱万壱千九" (jp-str :formal 11009))
  (assert-equal "壱万壱千拾" (jp-str :formal 11010))
  (assert-equal "壱万壱千拾壱" (jp-str :formal 11011))
  (assert-equal "壱万壱千拾九" (jp-str :formal 11019))
  (assert-equal "壱万壱千弐拾" (jp-str :formal 11020))
  (assert-equal "壱万壱千弐拾壱" (jp-str :formal 11021))
  (assert-equal "壱万壱千弐拾九" (jp-str :formal 11029))
  (assert-equal "壱万壱千壱百" (jp-str :formal 11100))
  (assert-equal "壱万壱千壱百壱" (jp-str :formal 11101))
  (assert-equal "壱万壱千壱百九" (jp-str :formal 11109))
  (assert-equal "壱万壱千壱百拾" (jp-str :formal 11110))
  (assert-equal "壱万壱千壱百拾壱" (jp-str :formal 11111))
  (assert-equal "壱万壱千壱百拾九" (jp-str :formal 11119))
  (assert-equal "壱万壱千壱百弐拾" (jp-str :formal 11120))
  (assert-equal "壱万壱千壱百弐拾壱" (jp-str :formal 11121))
  (assert-equal "壱万壱千壱百弐拾九" (jp-str :formal 11129))
  (assert-equal "壱万壱千弐百" (jp-str :formal 11200))
  (assert-equal "壱万壱千弐百壱" (jp-str :formal 11201))
  (assert-equal "壱万壱千弐百九" (jp-str :formal 11209))
  (assert-equal "壱万壱千弐百拾" (jp-str :formal 11210))
  (assert-equal "壱万壱千弐百拾壱" (jp-str :formal 11211))
  (assert-equal "壱万壱千弐百拾九" (jp-str :formal 11219))
  (assert-equal "壱万壱千弐百弐拾" (jp-str :formal 11220))
  (assert-equal "壱万壱千弐百弐拾壱" (jp-str :formal 11221))
  (assert-equal "壱万壱千弐百弐拾九" (jp-str :formal 11229))
  (assert-equal "壱万弐千" (jp-str :formal 12000))
  (assert-equal "壱万弐千壱" (jp-str :formal 12001))
  (assert-equal "壱万弐千九" (jp-str :formal 12009))
  (assert-equal "壱万弐千拾" (jp-str :formal 12010))
  (assert-equal "壱万弐千拾壱" (jp-str :formal 12011))
  (assert-equal "壱万弐千拾九" (jp-str :formal 12019))
  (assert-equal "壱万弐千弐拾" (jp-str :formal 12020))
  (assert-equal "壱万弐千弐拾壱" (jp-str :formal 12021))
  (assert-equal "壱万弐千弐拾九" (jp-str :formal 12029))
  (assert-equal "壱万弐千壱百" (jp-str :formal 12100))
  (assert-equal "壱万弐千壱百壱" (jp-str :formal 12101))
  (assert-equal "壱万弐千壱百九" (jp-str :formal 12109))
  (assert-equal "壱万弐千壱百拾" (jp-str :formal 12110))
  (assert-equal "壱万弐千壱百拾壱" (jp-str :formal 12111))
  (assert-equal "壱万弐千壱百拾九" (jp-str :formal 12119))
  (assert-equal "壱万弐千壱百弐拾" (jp-str :formal 12120))
  (assert-equal "壱万弐千壱百弐拾壱" (jp-str :formal 12121))
  (assert-equal "壱万弐千壱百弐拾九" (jp-str :formal 12129))
  (assert-equal "壱万弐千弐百" (jp-str :formal 12200))
  (assert-equal "壱万弐千弐百壱" (jp-str :formal 12201))
  (assert-equal "壱万弐千弐百九" (jp-str :formal 12209))
  (assert-equal "壱万弐千弐百拾" (jp-str :formal 12210))
  (assert-equal "壱万弐千弐百拾壱" (jp-str :formal 12211))
  (assert-equal "壱万弐千弐百拾九" (jp-str :formal 12219))
  (assert-equal "壱万弐千弐百弐拾" (jp-str :formal 12220))
  (assert-equal "壱万弐千弐百弐拾壱" (jp-str :formal 12221))
  (assert-equal "壱万弐千弐百弐拾九" (jp-str :formal 12229))
  (assert-equal "壱万九千九百九拾九" (jp-str :formal 19999))
  ;; 20000 - 99990000
  (assert-equal "弐万" (jp-str :formal 20000))
  (assert-equal "九万" (jp-str :formal 90000))
  (assert-equal "拾万" (jp-str :formal 100000))
  (assert-equal "拾壱万" (jp-str :formal 110000))
  (assert-equal "拾九万" (jp-str :formal 190000))
  (assert-equal "弐拾万" (jp-str :formal 200000))
  (assert-equal "弐拾壱万" (jp-str :formal 210000))
  (assert-equal "弐拾九万" (jp-str :formal 290000))
  (assert-equal "壱百万" (jp-str :formal 1000000))
  (assert-equal "壱百壱万" (jp-str :formal 1010000))
  (assert-equal "壱百九万" (jp-str :formal 1090000))
  (assert-equal "壱百拾万" (jp-str :formal 1100000))
  (assert-equal "壱百拾壱万" (jp-str :formal 1110000))
  (assert-equal "壱百拾九万" (jp-str :formal 1190000))
  (assert-equal "壱百弐拾万" (jp-str :formal 1200000))
  (assert-equal "壱百弐拾壱万" (jp-str :formal 1210000))
  (assert-equal "壱百弐拾九万" (jp-str :formal 1290000))
  (assert-equal "弐百万" (jp-str :formal 2000000))
  (assert-equal "弐百壱万" (jp-str :formal 2010000))
  (assert-equal "弐百九万" (jp-str :formal 2090000))
  (assert-equal "弐百拾万" (jp-str :formal 2100000))
  (assert-equal "弐百拾壱万" (jp-str :formal 2110000))
  (assert-equal "弐百拾九万" (jp-str :formal 2190000))
  (assert-equal "弐百弐拾万" (jp-str :formal 2200000))
  (assert-equal "弐百弐拾壱万" (jp-str :formal 2210000))
  (assert-equal "弐百弐拾九万" (jp-str :formal 2290000))
  (assert-equal "壱千万" (jp-str :formal 10000000))
  (assert-equal "壱千壱万" (jp-str :formal 10010000))
  (assert-equal "壱千九万" (jp-str :formal 10090000))
  (assert-equal "壱千拾万" (jp-str :formal 10100000))
  (assert-equal "壱千拾壱万" (jp-str :formal 10110000))
  (assert-equal "壱千拾九万" (jp-str :formal 10190000))
  (assert-equal "壱千弐拾万" (jp-str :formal 10200000))
  (assert-equal "壱千弐拾壱万" (jp-str :formal 10210000))
  (assert-equal "壱千弐拾九万" (jp-str :formal 10290000))
  (assert-equal "壱千壱百万" (jp-str :formal 11000000))
  (assert-equal "壱千壱百壱万" (jp-str :formal 11010000))
  (assert-equal "壱千壱百九万" (jp-str :formal 11090000))
  (assert-equal "壱千壱百拾万" (jp-str :formal 11100000))
  (assert-equal "壱千壱百拾壱万" (jp-str :formal 11110000))
  (assert-equal "壱千壱百拾九万" (jp-str :formal 11190000))
  (assert-equal "壱千壱百弐拾万" (jp-str :formal 11200000))
  (assert-equal "壱千壱百弐拾壱万" (jp-str :formal 11210000))
  (assert-equal "壱千壱百弐拾九万" (jp-str :formal 11290000))
  (assert-equal "壱千弐百万" (jp-str :formal 12000000))
  (assert-equal "壱千弐百壱万" (jp-str :formal 12010000))
  (assert-equal "壱千弐百九万" (jp-str :formal 12090000))
  (assert-equal "壱千弐百拾万" (jp-str :formal 12100000))
  (assert-equal "壱千弐百拾壱万" (jp-str :formal 12110000))
  (assert-equal "壱千弐百拾九万" (jp-str :formal 12190000))
  (assert-equal "壱千弐百弐拾万" (jp-str :formal 12200000))
  (assert-equal "壱千弐百弐拾壱万" (jp-str :formal 12210000))
  (assert-equal "壱千弐百弐拾九万" (jp-str :formal 12290000))
  (assert-equal "弐千万" (jp-str :formal 20000000))
  (assert-equal "弐千壱万" (jp-str :formal 20010000))
  (assert-equal "弐千九万" (jp-str :formal 20090000))
  (assert-equal "弐千拾万" (jp-str :formal 20100000))
  (assert-equal "弐千拾壱万" (jp-str :formal 20110000))
  (assert-equal "弐千拾九万" (jp-str :formal 20190000))
  (assert-equal "弐千弐拾万" (jp-str :formal 20200000))
  (assert-equal "弐千弐拾壱万" (jp-str :formal 20210000))
  (assert-equal "弐千弐拾九万" (jp-str :formal 20290000))
  (assert-equal "弐千壱百万" (jp-str :formal 21000000))
  (assert-equal "弐千壱百壱万" (jp-str :formal 21010000))
  (assert-equal "弐千壱百九万" (jp-str :formal 21090000))
  (assert-equal "弐千壱百拾万" (jp-str :formal 21100000))
  (assert-equal "弐千壱百拾壱万" (jp-str :formal 21110000))
  (assert-equal "弐千壱百拾九万" (jp-str :formal 21190000))
  (assert-equal "弐千壱百弐拾万" (jp-str :formal 21200000))
  (assert-equal "弐千壱百弐拾壱万" (jp-str :formal 21210000))
  (assert-equal "弐千壱百弐拾九万" (jp-str :formal 21290000))
  (assert-equal "弐千弐百万" (jp-str :formal 22000000))
  (assert-equal "弐千弐百壱万" (jp-str :formal 22010000))
  (assert-equal "弐千弐百九万" (jp-str :formal 22090000))
  (assert-equal "弐千弐百拾万" (jp-str :formal 22100000))
  (assert-equal "弐千弐百拾壱万" (jp-str :formal 22110000))
  (assert-equal "弐千弐百拾九万" (jp-str :formal 22190000))
  (assert-equal "弐千弐百弐拾万" (jp-str :formal 22200000))
  (assert-equal "弐千弐百弐拾壱万" (jp-str :formal 22210000))
  (assert-equal "弐千弐百弐拾九万" (jp-str :formal 22290000))
  (assert-equal "九千九百九拾九万" (jp-str :formal 99990000))
  ;; 100000000 - 100009999
  (assert-equal "壱億" (jp-str :formal 100000000))
  (assert-equal "壱億壱" (jp-str :formal 100000001))
  (assert-equal "壱億九" (jp-str :formal 100000009))
  (assert-equal "壱億拾" (jp-str :formal 100000010))
  (assert-equal "壱億拾壱" (jp-str :formal 100000011))
  (assert-equal "壱億拾九" (jp-str :formal 100000019))
  (assert-equal "壱億弐拾" (jp-str :formal 100000020))
  (assert-equal "壱億弐拾壱" (jp-str :formal 100000021))
  (assert-equal "壱億弐拾九" (jp-str :formal 100000029))
  (assert-equal "壱億壱百" (jp-str :formal 100000100))
  (assert-equal "壱億壱百壱" (jp-str :formal 100000101))
  (assert-equal "壱億壱百九" (jp-str :formal 100000109))
  (assert-equal "壱億壱百拾" (jp-str :formal 100000110))
  (assert-equal "壱億壱百拾壱" (jp-str :formal 100000111))
  (assert-equal "壱億壱百拾九" (jp-str :formal 100000119))
  (assert-equal "壱億壱百弐拾" (jp-str :formal 100000120))
  (assert-equal "壱億壱百弐拾壱" (jp-str :formal 100000121))
  (assert-equal "壱億壱百弐拾九" (jp-str :formal 100000129))
  (assert-equal "壱億弐百" (jp-str :formal 100000200))
  (assert-equal "壱億弐百壱" (jp-str :formal 100000201))
  (assert-equal "壱億弐百九" (jp-str :formal 100000209))
  (assert-equal "壱億弐百拾" (jp-str :formal 100000210))
  (assert-equal "壱億弐百拾壱" (jp-str :formal 100000211))
  (assert-equal "壱億弐百拾九" (jp-str :formal 100000219))
  (assert-equal "壱億弐百弐拾" (jp-str :formal 100000220))
  (assert-equal "壱億弐百弐拾壱" (jp-str :formal 100000221))
  (assert-equal "壱億弐百弐拾九" (jp-str :formal 100000229))
  (assert-equal "壱億壱千" (jp-str :formal 100001000))
  (assert-equal "壱億壱千壱" (jp-str :formal 100001001))
  (assert-equal "壱億壱千九" (jp-str :formal 100001009))
  (assert-equal "壱億壱千拾" (jp-str :formal 100001010))
  (assert-equal "壱億壱千拾壱" (jp-str :formal 100001011))
  (assert-equal "壱億壱千拾九" (jp-str :formal 100001019))
  (assert-equal "壱億壱千弐拾" (jp-str :formal 100001020))
  (assert-equal "壱億壱千弐拾壱" (jp-str :formal 100001021))
  (assert-equal "壱億壱千弐拾九" (jp-str :formal 100001029))
  (assert-equal "壱億壱千壱百" (jp-str :formal 100001100))
  (assert-equal "壱億壱千壱百壱" (jp-str :formal 100001101))
  (assert-equal "壱億壱千壱百九" (jp-str :formal 100001109))
  (assert-equal "壱億壱千壱百拾" (jp-str :formal 100001110))
  (assert-equal "壱億壱千壱百拾壱" (jp-str :formal 100001111))
  (assert-equal "壱億壱千壱百拾九" (jp-str :formal 100001119))
  (assert-equal "壱億壱千壱百弐拾" (jp-str :formal 100001120))
  (assert-equal "壱億壱千壱百弐拾壱" (jp-str :formal 100001121))
  (assert-equal "壱億壱千壱百弐拾九" (jp-str :formal 100001129))
  (assert-equal "壱億壱千弐百" (jp-str :formal 100001200))
  (assert-equal "壱億壱千弐百壱" (jp-str :formal 100001201))
  (assert-equal "壱億壱千弐百九" (jp-str :formal 100001209))
  (assert-equal "壱億壱千弐百拾" (jp-str :formal 100001210))
  (assert-equal "壱億壱千弐百拾壱" (jp-str :formal 100001211))
  (assert-equal "壱億壱千弐百拾九" (jp-str :formal 100001219))
  (assert-equal "壱億壱千弐百弐拾" (jp-str :formal 100001220))
  (assert-equal "壱億壱千弐百弐拾壱" (jp-str :formal 100001221))
  (assert-equal "壱億壱千弐百弐拾九" (jp-str :formal 100001229))
  (assert-equal "壱億弐千" (jp-str :formal 100002000))
  (assert-equal "壱億弐千壱" (jp-str :formal 100002001))
  (assert-equal "壱億弐千九" (jp-str :formal 100002009))
  (assert-equal "壱億弐千拾" (jp-str :formal 100002010))
  (assert-equal "壱億弐千拾壱" (jp-str :formal 100002011))
  (assert-equal "壱億弐千拾九" (jp-str :formal 100002019))
  (assert-equal "壱億弐千弐拾" (jp-str :formal 100002020))
  (assert-equal "壱億弐千弐拾壱" (jp-str :formal 100002021))
  (assert-equal "壱億弐千弐拾九" (jp-str :formal 100002029))
  (assert-equal "壱億弐千壱百" (jp-str :formal 100002100))
  (assert-equal "壱億弐千壱百壱" (jp-str :formal 100002101))
  (assert-equal "壱億弐千壱百九" (jp-str :formal 100002109))
  (assert-equal "壱億弐千壱百拾" (jp-str :formal 100002110))
  (assert-equal "壱億弐千壱百拾壱" (jp-str :formal 100002111))
  (assert-equal "壱億弐千壱百拾九" (jp-str :formal 100002119))
  (assert-equal "壱億弐千壱百弐拾" (jp-str :formal 100002120))
  (assert-equal "壱億弐千壱百弐拾壱" (jp-str :formal 100002121))
  (assert-equal "壱億弐千壱百弐拾九" (jp-str :formal 100002129))
  (assert-equal "壱億弐千弐百" (jp-str :formal 100002200))
  (assert-equal "壱億弐千弐百壱" (jp-str :formal 100002201))
  (assert-equal "壱億弐千弐百九" (jp-str :formal 100002209))
  (assert-equal "壱億弐千弐百拾" (jp-str :formal 100002210))
  (assert-equal "壱億弐千弐百拾壱" (jp-str :formal 100002211))
  (assert-equal "壱億弐千弐百拾九" (jp-str :formal 100002219))
  (assert-equal "壱億弐千弐百弐拾" (jp-str :formal 100002220))
  (assert-equal "壱億弐千弐百弐拾壱" (jp-str :formal 100002221))
  (assert-equal "壱億弐千弐百弐拾九" (jp-str :formal 100002229))
  (assert-equal "壱億九千九百九拾九" (jp-str :formal 100009999))
  ;; 100010000 - 100019999
  (assert-equal "壱億壱万" (jp-str :formal 100010000))
  (assert-equal "壱億壱万壱" (jp-str :formal 100010001))
  (assert-equal "壱億壱万九" (jp-str :formal 100010009))
  (assert-equal "壱億壱万拾" (jp-str :formal 100010010))
  (assert-equal "壱億壱万拾壱" (jp-str :formal 100010011))
  (assert-equal "壱億壱万拾九" (jp-str :formal 100010019))
  (assert-equal "壱億壱万弐拾" (jp-str :formal 100010020))
  (assert-equal "壱億壱万弐拾壱" (jp-str :formal 100010021))
  (assert-equal "壱億壱万弐拾九" (jp-str :formal 100010029))
  (assert-equal "壱億壱万壱百" (jp-str :formal 100010100))
  (assert-equal "壱億壱万壱百壱" (jp-str :formal 100010101))
  (assert-equal "壱億壱万壱百九" (jp-str :formal 100010109))
  (assert-equal "壱億壱万壱百拾" (jp-str :formal 100010110))
  (assert-equal "壱億壱万壱百拾壱" (jp-str :formal 100010111))
  (assert-equal "壱億壱万壱百拾九" (jp-str :formal 100010119))
  (assert-equal "壱億壱万壱百弐拾" (jp-str :formal 100010120))
  (assert-equal "壱億壱万壱百弐拾壱" (jp-str :formal 100010121))
  (assert-equal "壱億壱万壱百弐拾九" (jp-str :formal 100010129))
  (assert-equal "壱億壱万弐百" (jp-str :formal 100010200))
  (assert-equal "壱億壱万弐百壱" (jp-str :formal 100010201))
  (assert-equal "壱億壱万弐百九" (jp-str :formal 100010209))
  (assert-equal "壱億壱万弐百拾" (jp-str :formal 100010210))
  (assert-equal "壱億壱万弐百拾壱" (jp-str :formal 100010211))
  (assert-equal "壱億壱万弐百拾九" (jp-str :formal 100010219))
  (assert-equal "壱億壱万弐百弐拾" (jp-str :formal 100010220))
  (assert-equal "壱億壱万弐百弐拾壱" (jp-str :formal 100010221))
  (assert-equal "壱億壱万弐百弐拾九" (jp-str :formal 100010229))
  (assert-equal "壱億壱万壱千" (jp-str :formal 100011000))
  (assert-equal "壱億壱万壱千壱" (jp-str :formal 100011001))
  (assert-equal "壱億壱万壱千九" (jp-str :formal 100011009))
  (assert-equal "壱億壱万壱千拾" (jp-str :formal 100011010))
  (assert-equal "壱億壱万壱千拾壱" (jp-str :formal 100011011))
  (assert-equal "壱億壱万壱千拾九" (jp-str :formal 100011019))
  (assert-equal "壱億壱万壱千弐拾" (jp-str :formal 100011020))
  (assert-equal "壱億壱万壱千弐拾壱" (jp-str :formal 100011021))
  (assert-equal "壱億壱万壱千弐拾九" (jp-str :formal 100011029))
  (assert-equal "壱億壱万壱千壱百" (jp-str :formal 100011100))
  (assert-equal "壱億壱万壱千壱百壱" (jp-str :formal 100011101))
  (assert-equal "壱億壱万壱千壱百九" (jp-str :formal 100011109))
  (assert-equal "壱億壱万壱千壱百拾" (jp-str :formal 100011110))
  (assert-equal "壱億壱万壱千壱百拾壱" (jp-str :formal 100011111))
  (assert-equal "壱億壱万壱千壱百拾九" (jp-str :formal 100011119))
  (assert-equal "壱億壱万壱千壱百弐拾" (jp-str :formal 100011120))
  (assert-equal "壱億壱万壱千壱百弐拾壱" (jp-str :formal 100011121))
  (assert-equal "壱億壱万壱千壱百弐拾九" (jp-str :formal 100011129))
  (assert-equal "壱億壱万壱千弐百" (jp-str :formal 100011200))
  (assert-equal "壱億壱万壱千弐百壱" (jp-str :formal 100011201))
  (assert-equal "壱億壱万壱千弐百九" (jp-str :formal 100011209))
  (assert-equal "壱億壱万壱千弐百拾" (jp-str :formal 100011210))
  (assert-equal "壱億壱万壱千弐百拾壱" (jp-str :formal 100011211))
  (assert-equal "壱億壱万壱千弐百拾九" (jp-str :formal 100011219))
  (assert-equal "壱億壱万壱千弐百弐拾" (jp-str :formal 100011220))
  (assert-equal "壱億壱万壱千弐百弐拾壱" (jp-str :formal 100011221))
  (assert-equal "壱億壱万壱千弐百弐拾九" (jp-str :formal 100011229))
  (assert-equal "壱億壱万弐千" (jp-str :formal 100012000))
  (assert-equal "壱億壱万弐千壱" (jp-str :formal 100012001))
  (assert-equal "壱億壱万弐千九" (jp-str :formal 100012009))
  (assert-equal "壱億壱万弐千拾" (jp-str :formal 100012010))
  (assert-equal "壱億壱万弐千拾壱" (jp-str :formal 100012011))
  (assert-equal "壱億壱万弐千拾九" (jp-str :formal 100012019))
  (assert-equal "壱億壱万弐千弐拾" (jp-str :formal 100012020))
  (assert-equal "壱億壱万弐千弐拾壱" (jp-str :formal 100012021))
  (assert-equal "壱億壱万弐千弐拾九" (jp-str :formal 100012029))
  (assert-equal "壱億壱万弐千壱百" (jp-str :formal 100012100))
  (assert-equal "壱億壱万弐千壱百壱" (jp-str :formal 100012101))
  (assert-equal "壱億壱万弐千壱百九" (jp-str :formal 100012109))
  (assert-equal "壱億壱万弐千壱百拾" (jp-str :formal 100012110))
  (assert-equal "壱億壱万弐千壱百拾壱" (jp-str :formal 100012111))
  (assert-equal "壱億壱万弐千壱百拾九" (jp-str :formal 100012119))
  (assert-equal "壱億壱万弐千壱百弐拾" (jp-str :formal 100012120))
  (assert-equal "壱億壱万弐千壱百弐拾壱" (jp-str :formal 100012121))
  (assert-equal "壱億壱万弐千壱百弐拾九" (jp-str :formal 100012129))
  (assert-equal "壱億壱万弐千弐百" (jp-str :formal 100012200))
  (assert-equal "壱億壱万弐千弐百壱" (jp-str :formal 100012201))
  (assert-equal "壱億壱万弐千弐百九" (jp-str :formal 100012209))
  (assert-equal "壱億壱万弐千弐百拾" (jp-str :formal 100012210))
  (assert-equal "壱億壱万弐千弐百拾壱" (jp-str :formal 100012211))
  (assert-equal "壱億壱万弐千弐百拾九" (jp-str :formal 100012219))
  (assert-equal "壱億壱万弐千弐百弐拾" (jp-str :formal 100012220))
  (assert-equal "壱億壱万弐千弐百弐拾壱" (jp-str :formal 100012221))
  (assert-equal "壱億壱万弐千弐百弐拾九" (jp-str :formal 100012229))
  (assert-equal "壱億壱万九千九百九拾九" (jp-str :formal 100019999))
  ;; 100020000 - 199990000
  (assert-equal "壱億弐万" (jp-str :formal 100020000))
  (assert-equal "壱億九万" (jp-str :formal 100090000))
  (assert-equal "壱億拾万" (jp-str :formal 100100000))
  (assert-equal "壱億拾壱万" (jp-str :formal 100110000))
  (assert-equal "壱億拾九万" (jp-str :formal 100190000))
  (assert-equal "壱億弐拾万" (jp-str :formal 100200000))
  (assert-equal "壱億弐拾壱万" (jp-str :formal 100210000))
  (assert-equal "壱億弐拾九万" (jp-str :formal 100290000))
  (assert-equal "壱億壱百万" (jp-str :formal 101000000))
  (assert-equal "壱億壱百壱万" (jp-str :formal 101010000))
  (assert-equal "壱億壱百九万" (jp-str :formal 101090000))
  (assert-equal "壱億壱百拾万" (jp-str :formal 101100000))
  (assert-equal "壱億壱百拾壱万" (jp-str :formal 101110000))
  (assert-equal "壱億壱百拾九万" (jp-str :formal 101190000))
  (assert-equal "壱億壱百弐拾万" (jp-str :formal 101200000))
  (assert-equal "壱億壱百弐拾壱万" (jp-str :formal 101210000))
  (assert-equal "壱億壱百弐拾九万" (jp-str :formal 101290000))
  (assert-equal "壱億弐百万" (jp-str :formal 102000000))
  (assert-equal "壱億弐百壱万" (jp-str :formal 102010000))
  (assert-equal "壱億弐百九万" (jp-str :formal 102090000))
  (assert-equal "壱億弐百拾万" (jp-str :formal 102100000))
  (assert-equal "壱億弐百拾壱万" (jp-str :formal 102110000))
  (assert-equal "壱億弐百拾九万" (jp-str :formal 102190000))
  (assert-equal "壱億弐百弐拾万" (jp-str :formal 102200000))
  (assert-equal "壱億弐百弐拾壱万" (jp-str :formal 102210000))
  (assert-equal "壱億弐百弐拾九万" (jp-str :formal 102290000))
  (assert-equal "壱億壱千万" (jp-str :formal 110000000))
  (assert-equal "壱億壱千壱万" (jp-str :formal 110010000))
  (assert-equal "壱億壱千九万" (jp-str :formal 110090000))
  (assert-equal "壱億壱千拾万" (jp-str :formal 110100000))
  (assert-equal "壱億壱千拾壱万" (jp-str :formal 110110000))
  (assert-equal "壱億壱千拾九万" (jp-str :formal 110190000))
  (assert-equal "壱億壱千弐拾万" (jp-str :formal 110200000))
  (assert-equal "壱億壱千弐拾壱万" (jp-str :formal 110210000))
  (assert-equal "壱億壱千弐拾九万" (jp-str :formal 110290000))
  (assert-equal "壱億壱千壱百万" (jp-str :formal 111000000))
  (assert-equal "壱億壱千壱百壱万" (jp-str :formal 111010000))
  (assert-equal "壱億壱千壱百九万" (jp-str :formal 111090000))
  (assert-equal "壱億壱千壱百拾万" (jp-str :formal 111100000))
  (assert-equal "壱億壱千壱百拾壱万" (jp-str :formal 111110000))
  (assert-equal "壱億壱千壱百拾九万" (jp-str :formal 111190000))
  (assert-equal "壱億壱千壱百弐拾万" (jp-str :formal 111200000))
  (assert-equal "壱億壱千壱百弐拾壱万" (jp-str :formal 111210000))
  (assert-equal "壱億壱千壱百弐拾九万" (jp-str :formal 111290000))
  (assert-equal "壱億壱千弐百万" (jp-str :formal 112000000))
  (assert-equal "壱億壱千弐百壱万" (jp-str :formal 112010000))
  (assert-equal "壱億壱千弐百九万" (jp-str :formal 112090000))
  (assert-equal "壱億壱千弐百拾万" (jp-str :formal 112100000))
  (assert-equal "壱億壱千弐百拾壱万" (jp-str :formal 112110000))
  (assert-equal "壱億壱千弐百拾九万" (jp-str :formal 112190000))
  (assert-equal "壱億壱千弐百弐拾万" (jp-str :formal 112200000))
  (assert-equal "壱億壱千弐百弐拾壱万" (jp-str :formal 112210000))
  (assert-equal "壱億壱千弐百弐拾九万" (jp-str :formal 112290000))
  (assert-equal "壱億弐千万" (jp-str :formal 120000000))
  (assert-equal "壱億弐千壱万" (jp-str :formal 120010000))
  (assert-equal "壱億弐千九万" (jp-str :formal 120090000))
  (assert-equal "壱億弐千拾万" (jp-str :formal 120100000))
  (assert-equal "壱億弐千拾壱万" (jp-str :formal 120110000))
  (assert-equal "壱億弐千拾九万" (jp-str :formal 120190000))
  (assert-equal "壱億弐千弐拾万" (jp-str :formal 120200000))
  (assert-equal "壱億弐千弐拾壱万" (jp-str :formal 120210000))
  (assert-equal "壱億弐千弐拾九万" (jp-str :formal 120290000))
  (assert-equal "壱億弐千壱百万" (jp-str :formal 121000000))
  (assert-equal "壱億弐千壱百壱万" (jp-str :formal 121010000))
  (assert-equal "壱億弐千壱百九万" (jp-str :formal 121090000))
  (assert-equal "壱億弐千壱百拾万" (jp-str :formal 121100000))
  (assert-equal "壱億弐千壱百拾壱万" (jp-str :formal 121110000))
  (assert-equal "壱億弐千壱百拾九万" (jp-str :formal 121190000))
  (assert-equal "壱億弐千壱百弐拾万" (jp-str :formal 121200000))
  (assert-equal "壱億弐千壱百弐拾壱万" (jp-str :formal 121210000))
  (assert-equal "壱億弐千壱百弐拾九万" (jp-str :formal 121290000))
  (assert-equal "壱億弐千弐百万" (jp-str :formal 122000000))
  (assert-equal "壱億弐千弐百壱万" (jp-str :formal 122010000))
  (assert-equal "壱億弐千弐百九万" (jp-str :formal 122090000))
  (assert-equal "壱億弐千弐百拾万" (jp-str :formal 122100000))
  (assert-equal "壱億弐千弐百拾壱万" (jp-str :formal 122110000))
  (assert-equal "壱億弐千弐百拾九万" (jp-str :formal 122190000))
  (assert-equal "壱億弐千弐百弐拾万" (jp-str :formal 122200000))
  (assert-equal "壱億弐千弐百弐拾壱万" (jp-str :formal 122210000))
  (assert-equal "壱億弐千弐百弐拾九万" (jp-str :formal 122290000))
  (assert-equal "壱億九千九百九拾九万" (jp-str :formal 199990000))

  ;; more big nums
  (let ((num 12300001001))
    (assert-equal "壱百弐拾参億壱千壱" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参兆壱千壱万" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参京壱千壱億" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参垓壱千壱兆" (jp-str :formal num))
    (mulf num 10000)
    (when (<= #x25771 char-code-limit)	; contains U+25771 (10^24)
      (assert-equal "壱百弐拾参𥝱壱千壱京" (jp-str :formal num)))
    (mulf num 10000)
    (assert-equal "壱百弐拾参穣壱千壱垓" (jp-str :formal num))
    (mulf num 10000)
    (when (<= #x25771 char-code-limit)	; contains U+25771 (10^24)
      (assert-equal "壱百弐拾参溝壱千壱𥝱" (jp-str :formal num)))
    (mulf num 10000)
    (assert-equal "壱百弐拾参澗壱千壱穣" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参正壱千壱溝" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参載壱千壱澗" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参極壱千壱正" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参恒河沙壱千壱載" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参阿僧祇壱千壱極" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参那由他壱千壱恒河沙" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参不可思議壱千壱阿僧祇" (jp-str :formal num))
    (mulf num 10000)
    (assert-equal "壱百弐拾参無量大数壱千壱那由他" (jp-str :formal num)))
  ;; 
  t)

(defun test-jp-formal-integer-minus ()
  (assert-equal "マイナス壱" (jp-str :formal -1))
  (assert-equal "マイナス弐" (jp-str :formal -2))
  (assert-equal "マイナス参" (jp-str :formal -3))
  (assert-equal "マイナス四" (jp-str :formal -4))
  (assert-equal "マイナス五" (jp-str :formal -5))
  (assert-equal "マイナス六" (jp-str :formal -6))
  (assert-equal "マイナス七" (jp-str :formal -7))
  (assert-equal "マイナス八" (jp-str :formal -8))
  (assert-equal "マイナス九" (jp-str :formal -9))
  (assert-equal "マイナス拾" (jp-str :formal -10))
  (assert-equal "マイナス弐拾" (jp-str :formal -20))
  (assert-equal "マイナス壱百" (jp-str :formal -100))
  (assert-equal "マイナス五百" (jp-str :formal -500))
  (assert-equal "マイナス壱千" (jp-str :formal -1000))
  (assert-equal "マイナス壱万" (jp-str :formal -10000))
  (assert-equal "マイナス壱万弐千参百四拾五" (jp-str :formal -12345))
  ;; 
  t)
  
(defun test-jp-formal-rational ()
  (assert-equal "弐分の壱" (jp-str :formal 1/2))
  (assert-equal "拾分の壱" (jp-str :formal 1/10))
  (assert-equal "弐拾分の壱" (jp-str :formal 1/20))
  (assert-equal "壱百分の壱" (jp-str :formal 1/100))
  (assert-equal "壱百拾分の壱" (jp-str :formal 1/110))
  (assert-equal "壱百拾壱分の壱" (jp-str :formal 1/111))
  (assert-equal "壱百弐拾分の壱" (jp-str :formal 1/120))
  (assert-equal "壱百弐拾壱分の壱" (jp-str :formal 1/121))
  (assert-equal "弐百分の壱" (jp-str :formal 1/200))
  (assert-equal "弐百拾分の壱" (jp-str :formal 1/210))
  (assert-equal "弐百拾壱分の壱" (jp-str :formal 1/211))
  (assert-equal "弐百弐拾分の壱" (jp-str :formal 1/220))
  (assert-equal "弐百弐拾壱分の壱" (jp-str :formal 1/221))
  (assert-equal "壱千分の壱" (jp-str :formal 1/1000))
  (assert-equal "壱千拾分の壱" (jp-str :formal 1/1010))
  (assert-equal "壱千拾壱分の壱" (jp-str :formal 1/1011))
  (assert-equal "壱千弐拾分の壱" (jp-str :formal 1/1020))
  (assert-equal "壱千弐拾壱分の壱" (jp-str :formal 1/1021))
  (assert-equal "壱千壱百分の壱" (jp-str :formal 1/1100))
  (assert-equal "壱千壱百拾分の壱" (jp-str :formal 1/1110))
  (assert-equal "壱千壱百拾壱分の壱" (jp-str :formal 1/1111))
  (assert-equal "壱千壱百弐拾分の壱" (jp-str :formal 1/1120))
  (assert-equal "壱千壱百弐拾壱分の壱" (jp-str :formal 1/1121))
  (assert-equal "弐千弐百壱分の壱" (jp-str :formal 1/2201))
  (assert-equal "壱万分の壱" (jp-str :formal 1/10000))
  (assert-equal "壱万壱千壱百拾壱分の壱" (jp-str :formal 1/11111))
  (assert-equal "弐万弐千弐百弐拾弐分の壱" (jp-str :formal 1/22222))
  (assert-equal "壱億分の壱" (jp-str :formal 1/100000000))

  (assert-equal "壱万九千九百九拾七分の壱" (jp-str :formal 1/19997)) ; 19997 is a prime.
  (assert-equal "壱万九千九百九拾七分の弐" (jp-str :formal 2/19997))
  (assert-equal "壱万九千九百九拾七分の拾" (jp-str :formal 10/19997))
  (assert-equal "壱万九千九百九拾七分の拾壱" (jp-str :formal 11/19997))
  (assert-equal "壱万九千九百九拾七分の弐拾壱" (jp-str :formal 21/19997))
  (assert-equal "壱万九千九百九拾七分の九拾九" (jp-str :formal 99/19997))
  (assert-equal "壱万九千九百九拾七分の壱百" (jp-str :formal 100/19997))
  (assert-equal "壱万九千九百九拾七分の壱百壱" (jp-str :formal 101/19997))
  (assert-equal "壱万九千九百九拾七分の壱百拾壱" (jp-str :formal 111/19997))
  (assert-equal "壱万九千九百九拾七分の弐百拾壱" (jp-str :formal 211/19997))
  (assert-equal "壱万九千九百九拾七分の壱千壱" (jp-str :formal 1001/19997))
  (assert-equal "壱万九千九百九拾七分の壱千壱百拾壱" (jp-str :formal 1111/19997))
  (assert-equal "壱万九千九百九拾七分の弐千弐百弐拾弐" (jp-str :formal 2222/19997))
  (assert-equal "壱万九千九百九拾七分の壱万" (jp-str :formal 10000/19997))
  (assert-equal "壱万九千九百九拾七分の壱万壱" (jp-str :formal 10001/19997))
  (assert-equal "壱万九千九百九拾七分の壱万壱千壱百拾" (jp-str :formal 11110/19997))
  (assert-equal "壱万九千九百九拾七分の壱万五千弐" (jp-str :formal 15002/19997))
  (assert-equal "壱万九千九百九拾七分の壱万九千九百九拾六" (jp-str :formal 19996/19997))

  (assert-equal "マイナス弐分の壱" (jp-str :formal -1/2))
  ;; 
  t)
  
(defun test-jp-formal-float ()
  ;; int
  (assert-equal "〇" (jp-str :formal 0.0))
  (assert-equal "壱" (jp-str :formal 1.0))
  (assert-equal "拾" (jp-str :formal 10.0))
  ;; 0.1-0.9
  (assert-equal "壱分" (jp-str :formal 0.1))
  (assert-equal "弐分" (jp-str :formal 0.2))
  (assert-equal "参分" (jp-str :formal 0.3))
  (assert-equal "四分" (jp-str :formal 0.4))
  (assert-equal "五分" (jp-str :formal 0.5))
  (assert-equal "六分" (jp-str :formal 0.6))
  (assert-equal "七分" (jp-str :formal 0.7))
  (assert-equal "八分" (jp-str :formal 0.8))
  (assert-equal "九分" (jp-str :formal 0.9))
  ;; 0.10-0.30
  (assert-equal "壱分" (jp-str :formal 0.10))
  (assert-equal "壱分壱厘" (jp-str :formal 0.11))
  (assert-equal "壱分弐厘" (jp-str :formal 0.12))
  (assert-equal "壱分参厘" (jp-str :formal 0.13))
  (assert-equal "壱分四厘" (jp-str :formal 0.14))
  (assert-equal "壱分五厘" (jp-str :formal 0.15))
  (assert-equal "壱分六厘" (jp-str :formal 0.16))
  (assert-equal "壱分七厘" (jp-str :formal 0.17))
  (assert-equal "壱分八厘" (jp-str :formal 0.18))
  (assert-equal "壱分九厘" (jp-str :formal 0.19))
  (assert-equal "弐分" (jp-str :formal 0.20))
  (assert-equal "弐分壱厘" (jp-str :formal 0.21))
  (assert-equal "弐分弐厘" (jp-str :formal 0.22))
  (assert-equal "弐分参厘" (jp-str :formal 0.23))
  (assert-equal "弐分四厘" (jp-str :formal 0.24))
  (assert-equal "弐分五厘" (jp-str :formal 0.25))
  (assert-equal "弐分六厘" (jp-str :formal 0.26))
  (assert-equal "弐分七厘" (jp-str :formal 0.27))
  (assert-equal "弐分八厘" (jp-str :formal 0.28))
  (assert-equal "弐分九厘" (jp-str :formal 0.29))
  (assert-equal "参分" (jp-str :formal 0.30))
  ;; small nums
  (assert-equal "拾・参分四厘" (jp-str :formal 10.34))
  (assert-equal "壱・参厘四毛" (jp-str :formal 1.034))
  (assert-equal "壱分参毛四糸" (jp-str :formal 0.1034))
  (assert-equal "壱厘参糸四忽" (jp-str :formal 0.01034))
  (assert-equal "壱毛参忽四微" (jp-str :formal 0.001034))
  (assert-equal "壱糸参微四繊" (jp-str :formal 0.0001034))
  (assert-equal "壱忽参繊四沙" (jp-str :formal 0.00001034))
  (assert-equal "壱微参沙四塵" (jp-str :formal 0.000001034))
  (assert-equal "壱繊参塵四埃" (jp-str :formal 0.0000001034))
  (assert-equal "壱沙参埃四渺" (jp-str :formal 0.00000001034))
  (assert-equal "壱塵参渺四漠" (jp-str :formal 0.000000001034))
  (assert-equal "壱埃参漠四模糊" (jp-str :formal 0.0000000001034))
  (assert-equal "壱渺参模糊四逡巡" (jp-str :formal 0.00000000001034))
  (assert-equal "壱漠参逡巡四須臾" (jp-str :formal 0.000000000001034))
  (assert-equal "壱模糊参須臾四瞬息" (jp-str :formal 0.0000000000001034))
  (assert-equal "壱逡巡参瞬息四弾指" (jp-str :formal 0.00000000000001034))
  (assert-equal "壱須臾参弾指四刹那" (jp-str :formal 0.000000000000001034))
  (assert-equal "壱瞬息参刹那四六徳" (jp-str :formal 0.0000000000000001034))
  (assert-equal "壱弾指参六徳四虚空" (jp-str :formal 0.00000000000000001034))
  (assert-equal "壱刹那参虚空四清浄" (jp-str :formal 0.000000000000000001034))
  ;; minus
  (assert-equal "マイナス壱分" (jp-str :formal -0.1))
  (assert-equal "マイナス弐分" (jp-str :formal -0.2))
  (assert-equal "マイナス壱分壱厘" (jp-str :formal -0.11))
  (assert-equal "マイナス弐厘" (jp-str :formal -0.02))
  (assert-equal "マイナス壱・壱分" (jp-str :formal -1.1))
  (assert-equal "マイナス壱・壱厘" (jp-str :formal -1.01))
  ;;
  t)

(defun test-jp-formal-fallback ()
  ;; too big num
  (assert-equal "壱無量大数" (jp-str :formal (expt 10 68)))
  (assert-equal "一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
		(jp-str :formal (expt 10 72)))
  (assert-equal "マイナス壱無量大数" (jp-str :formal (- (expt 10 68))))
  (assert-equal "−一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
		(jp-str :formal (- (expt 10 72))))
  ;; too small num
  (assert-equal "壱清浄" (jp-str :formal (float (expt 10 -21))))
  (assert-equal "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
		(jp-str :formal (float (expt 10 -22))))
  (assert-equal "マイナス壱清浄" (jp-str :formal (- (float (expt 10 -21)))))
  (assert-equal "−〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
		(jp-str :formal (- (float (expt 10 -22)))))
  ;; complex
  (assert-equal (format nil "~A" #c(1 1))
		(jp-str :formal #c(1 1)))
  ;;
  t)

(defun test-jp-formal-parameters ()
  ;; [Integer]
  ;; digits-after-dot -- ignored
  (assert-equal "壱" (jp-str :formal 1 :digits-after-dot nil))
  (assert-equal "壱" (jp-str :formal 1 :digits-after-dot 0))
  (assert-equal "壱" (jp-str :formal 1 :digits-after-dot 1))
  #+allegro(assert-equal "壱" (jp-str :formal 1 :digits-after-dot -1))
  ;; scale
  (assert-equal "壱" (jp-str :formal 1 :scale nil))
  (assert-equal "壱" (jp-str :formal 1 :scale 0))
  (assert-equal "拾" (jp-str :formal 1 :scale 1))
  (assert-equal "拾分の壱" (jp-str :formal 1 :scale -1))
  ;; radix-point
  (assert-equal "壱" (jp-str :formal 1 :radix-point nil))
  (assert-equal "壱a" (jp-str :formal 1 :radix-point #\a))
  (assert-equal "壱abc" (jp-str :formal 1 :radix-point "abc"))

  ;; [Rational]
  ;; digits-after-dot -- ignored
  (assert-equal "弐分の壱" (jp-str :formal 1/2 :digits-after-dot nil))
  (assert-equal "弐分の壱" (jp-str :formal 1/2 :digits-after-dot 0))
  (assert-equal "弐分の壱" (jp-str :formal 1/2 :digits-after-dot 1))
  #+allegro(assert-equal "弐分の壱" (jp-str :formal 1/2 :digits-after-dot -1))
  ;; scale
  (assert-equal "弐分の壱" (jp-str :formal 1/2 :scale nil))
  (assert-equal "弐分の壱" (jp-str :formal 1/2 :scale 0))
  (assert-equal "五" (jp-str :formal 1/2 :scale 1))
  (assert-equal "弐拾分の壱" (jp-str :formal 1/2 :scale -1))
  ;; radix-point
  (assert-equal "弐分の壱" (jp-str :formal 1/2 :radix-point nil))
  (assert-equal "弐分の壱a" (jp-str :formal 1/2 :radix-point #\a))
  (assert-equal "弐分の壱abc" (jp-str :formal 1/2 :radix-point "abc"))

  ;; [Float]
  ;; digits-after-dot
  (assert-equal "拾弐・参分四厘" (jp-str :formal 12.34 :digits-after-dot nil))
  (assert-equal "拾弐" (jp-str :formal 12.34 :digits-after-dot 0))
  (assert-equal "拾弐・参分" (jp-str :formal 12.34 :digits-after-dot 1))
  (assert-equal "拾弐・参分四厘" (jp-str :formal 12.34 :digits-after-dot 2))
  (assert-equal "拾弐・参分四厘" (jp-str :formal 12.34 :digits-after-dot 3))
  #+allegro(assert-equal "拾" (jp-str :formal 12.34 :digits-after-dot -1))
  #+allegro(assert-equal "〇" (jp-str :formal 12.34 :digits-after-dot -2))
  ;; scale
  (assert-equal "拾弐・参分四厘" (jp-str :formal 12.34 :scale nil))
  (assert-equal "拾弐・参分四厘" (jp-str :formal 12.34 :scale 0))
  (assert-equal "壱百弐拾参・四分" (jp-str :formal 12.34 :scale 1))
  (assert-equal "壱千弐百参拾四" (jp-str :formal 12.34 :scale 2))
  (assert-equal "壱・弐分参厘四毛" (jp-str :formal 12.34 :scale -1))
  (assert-equal "壱分弐厘参毛四糸" (jp-str :formal 12.34 :scale -2))
  ;; radix-point
  (assert-equal "拾弐・参分四厘" (jp-str :formal 12.34 :radix-point nil))
  (assert-equal "拾弐a参分四厘" (jp-str :formal 12.34 :radix-point #\a))
  (assert-equal "拾弐abc参分四厘" (jp-str :formal 12.34 :radix-point "abc"))
  (assert-equal "壱千弐百参拾四abc" (jp-str :formal 12.34 :radix-point "abc" :scale 2))
  (assert-equal "〇abc壱分弐厘参毛四糸" (jp-str :formal 12.34 :radix-point "abc" :scale -2))
  ;; 
  t)

(defun test-jp-formal ()
  (and (test-jp-formal-integer-4digits)
       (test-jp-formal-integer-bignums)
       (test-jp-formal-integer-minus)
       (test-jp-formal-rational)
       (test-jp-formal-float)
       (test-jp-formal-fallback)
       (test-jp-formal-parameters)
       t))
