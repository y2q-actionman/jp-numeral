;;; -*- coding: utf-8; -*-

(in-package :jp-numeral.test)

(defun jp-str/f (num &key digits-after-dot
		 scale radix-point)
  (with-output-to-string (stream)
    (jp-numeral:jp stream num t nil
		   digits-after-dot scale radix-point)))

(defun test-jp-formal-integer-4digits ()
  ;; 0
  (assert (equal "〇" (jp-str/f 0)))
  ;; 1-9
  (assert (equal "壱" (jp-str/f 1)))
  (assert (equal "弐" (jp-str/f 2)))
  (assert (equal "参" (jp-str/f 3)))
  (assert (equal "四" (jp-str/f 4)))
  (assert (equal "五" (jp-str/f 5)))
  (assert (equal "六" (jp-str/f 6)))
  (assert (equal "七" (jp-str/f 7)))
  (assert (equal "八" (jp-str/f 8)))
  (assert (equal "九" (jp-str/f 9)))
  ;; 10-19
  (assert (equal "拾" (jp-str/f 10)))
  (assert (equal "拾壱" (jp-str/f 11)))
  (assert (equal "拾弐" (jp-str/f 12)))
  (assert (equal "拾参" (jp-str/f 13)))
  (assert (equal "拾四" (jp-str/f 14)))
  (assert (equal "拾五" (jp-str/f 15)))
  (assert (equal "拾六" (jp-str/f 16)))
  (assert (equal "拾七" (jp-str/f 17)))
  (assert (equal "拾八" (jp-str/f 18)))
  (assert (equal "拾九" (jp-str/f 19)))
  ;; 20-99
  (assert (equal "弐拾" (jp-str/f 20)))
  (assert (equal "弐拾壱" (jp-str/f 21)))
  (assert (equal "弐拾九" (jp-str/f 29)))
  (assert (equal "参拾" (jp-str/f 30)))
  (assert (equal "参拾壱" (jp-str/f 31)))
  (assert (equal "参拾九" (jp-str/f 39)))
  (assert (equal "四拾" (jp-str/f 40)))
  (assert (equal "四拾壱" (jp-str/f 41)))
  (assert (equal "四拾九" (jp-str/f 49)))
  (assert (equal "五拾" (jp-str/f 50)))
  (assert (equal "五拾壱" (jp-str/f 51)))
  (assert (equal "五拾九" (jp-str/f 59)))
  (assert (equal "六拾" (jp-str/f 60)))
  (assert (equal "六拾壱" (jp-str/f 61)))
  (assert (equal "六拾九" (jp-str/f 69)))
  (assert (equal "七拾" (jp-str/f 70)))
  (assert (equal "七拾壱" (jp-str/f 71)))
  (assert (equal "七拾九" (jp-str/f 79)))
  (assert (equal "八拾" (jp-str/f 80)))
  (assert (equal "八拾壱" (jp-str/f 81)))
  (assert (equal "八拾九" (jp-str/f 89)))
  (assert (equal "九拾" (jp-str/f 90)))
  (assert (equal "九拾壱" (jp-str/f 91)))
  (assert (equal "九拾九" (jp-str/f 99)))
  ;; 100
  (assert (equal "壱百" (jp-str/f 100)))
  ;; 101-109
  (assert (equal "壱百壱" (jp-str/f 101)))
  (assert (equal "壱百弐" (jp-str/f 102)))
  (assert (equal "壱百参" (jp-str/f 103)))
  (assert (equal "壱百四" (jp-str/f 104)))
  (assert (equal "壱百五" (jp-str/f 105)))
  (assert (equal "壱百六" (jp-str/f 106)))
  (assert (equal "壱百七" (jp-str/f 107)))
  (assert (equal "壱百八" (jp-str/f 108)))
  (assert (equal "壱百九" (jp-str/f 109)))
  ;; 110-119
  (assert (equal "壱百拾" (jp-str/f 110)))
  (assert (equal "壱百拾壱" (jp-str/f 111)))
  (assert (equal "壱百拾弐" (jp-str/f 112)))
  (assert (equal "壱百拾参" (jp-str/f 113)))
  (assert (equal "壱百拾四" (jp-str/f 114)))
  (assert (equal "壱百拾五" (jp-str/f 115)))
  (assert (equal "壱百拾六" (jp-str/f 116)))
  (assert (equal "壱百拾七" (jp-str/f 117)))
  (assert (equal "壱百拾八" (jp-str/f 118)))
  (assert (equal "壱百拾九" (jp-str/f 119)))
  ;; 120-199
  (assert (equal "壱百弐拾" (jp-str/f 120)))
  (assert (equal "壱百弐拾壱" (jp-str/f 121)))
  (assert (equal "壱百弐拾九" (jp-str/f 129)))
  (assert (equal "壱百参拾" (jp-str/f 130)))
  (assert (equal "壱百参拾壱" (jp-str/f 131)))
  (assert (equal "壱百参拾九" (jp-str/f 139)))
  (assert (equal "壱百四拾" (jp-str/f 140)))
  (assert (equal "壱百四拾壱" (jp-str/f 141)))
  (assert (equal "壱百四拾九" (jp-str/f 149)))
  (assert (equal "壱百五拾" (jp-str/f 150)))
  (assert (equal "壱百五拾壱" (jp-str/f 151)))
  (assert (equal "壱百五拾九" (jp-str/f 159)))
  (assert (equal "壱百六拾" (jp-str/f 160)))
  (assert (equal "壱百六拾壱" (jp-str/f 161)))
  (assert (equal "壱百六拾九" (jp-str/f 169)))
  (assert (equal "壱百七拾" (jp-str/f 170)))
  (assert (equal "壱百七拾壱" (jp-str/f 171)))
  (assert (equal "壱百七拾九" (jp-str/f 179)))
  (assert (equal "壱百八拾" (jp-str/f 180)))
  (assert (equal "壱百八拾壱" (jp-str/f 181)))
  (assert (equal "壱百八拾九" (jp-str/f 189)))
  (assert (equal "壱百九拾" (jp-str/f 190)))
  (assert (equal "壱百九拾壱" (jp-str/f 191)))
  (assert (equal "壱百九拾九" (jp-str/f 199)))
  ;; 200-999
  (assert (equal "弐百" (jp-str/f 200)))
  (assert (equal "弐百壱" (jp-str/f 201)))
  (assert (equal "弐百九" (jp-str/f 209)))
  (assert (equal "弐百拾" (jp-str/f 210)))
  (assert (equal "弐百拾壱" (jp-str/f 211)))
  (assert (equal "弐百拾九" (jp-str/f 219)))
  (assert (equal "弐百弐拾" (jp-str/f 220)))
  (assert (equal "弐百弐拾壱" (jp-str/f 221)))
  (assert (equal "弐百九拾九" (jp-str/f 299)))
  (assert (equal "参百" (jp-str/f 300)))
  (assert (equal "参百壱" (jp-str/f 301)))
  (assert (equal "参百九" (jp-str/f 309)))
  (assert (equal "参百拾" (jp-str/f 310)))
  (assert (equal "参百拾壱" (jp-str/f 311)))
  (assert (equal "参百拾九" (jp-str/f 319)))
  (assert (equal "参百弐拾" (jp-str/f 320)))
  (assert (equal "参百弐拾壱" (jp-str/f 321)))
  (assert (equal "参百九拾九" (jp-str/f 399)))
  (assert (equal "四百" (jp-str/f 400)))
  (assert (equal "四百壱" (jp-str/f 401)))
  (assert (equal "四百九" (jp-str/f 409)))
  (assert (equal "四百拾" (jp-str/f 410)))
  (assert (equal "四百拾壱" (jp-str/f 411)))
  (assert (equal "四百拾九" (jp-str/f 419)))
  (assert (equal "四百弐拾" (jp-str/f 420)))
  (assert (equal "四百弐拾壱" (jp-str/f 421)))
  (assert (equal "四百九拾九" (jp-str/f 499)))
  (assert (equal "五百" (jp-str/f 500)))
  (assert (equal "五百壱" (jp-str/f 501)))
  (assert (equal "五百九" (jp-str/f 509)))
  (assert (equal "五百拾" (jp-str/f 510)))
  (assert (equal "五百拾壱" (jp-str/f 511)))
  (assert (equal "五百拾九" (jp-str/f 519)))
  (assert (equal "五百弐拾" (jp-str/f 520)))
  (assert (equal "五百弐拾壱" (jp-str/f 521)))
  (assert (equal "五百九拾九" (jp-str/f 599)))
  (assert (equal "六百" (jp-str/f 600)))
  (assert (equal "六百壱" (jp-str/f 601)))
  (assert (equal "六百九" (jp-str/f 609)))
  (assert (equal "六百拾" (jp-str/f 610)))
  (assert (equal "六百拾壱" (jp-str/f 611)))
  (assert (equal "六百拾九" (jp-str/f 619)))
  (assert (equal "六百弐拾" (jp-str/f 620)))
  (assert (equal "六百弐拾壱" (jp-str/f 621)))
  (assert (equal "六百九拾九" (jp-str/f 699)))
  (assert (equal "七百" (jp-str/f 700)))
  (assert (equal "七百壱" (jp-str/f 701)))
  (assert (equal "七百九" (jp-str/f 709)))
  (assert (equal "七百拾" (jp-str/f 710)))
  (assert (equal "七百拾壱" (jp-str/f 711)))
  (assert (equal "七百拾九" (jp-str/f 719)))
  (assert (equal "七百弐拾" (jp-str/f 720)))
  (assert (equal "七百弐拾壱" (jp-str/f 721)))
  (assert (equal "七百九拾九" (jp-str/f 799)))
  (assert (equal "八百" (jp-str/f 800)))
  (assert (equal "八百壱" (jp-str/f 801)))
  (assert (equal "八百九" (jp-str/f 809)))
  (assert (equal "八百拾" (jp-str/f 810)))
  (assert (equal "八百拾壱" (jp-str/f 811)))
  (assert (equal "八百拾九" (jp-str/f 819)))
  (assert (equal "八百弐拾" (jp-str/f 820)))
  (assert (equal "八百弐拾壱" (jp-str/f 821)))
  (assert (equal "八百九拾九" (jp-str/f 899)))
  (assert (equal "九百" (jp-str/f 900)))
  (assert (equal "九百壱" (jp-str/f 901)))
  (assert (equal "九百九" (jp-str/f 909)))
  (assert (equal "九百拾" (jp-str/f 910)))
  (assert (equal "九百拾壱" (jp-str/f 911)))
  (assert (equal "九百拾九" (jp-str/f 919)))
  (assert (equal "九百弐拾" (jp-str/f 920)))
  (assert (equal "九百弐拾壱" (jp-str/f 921)))
  (assert (equal "九百九拾九" (jp-str/f 999)))
  ;; 1000 - 1099
  (assert (equal "壱千" (jp-str/f 1000)))
  (assert (equal "壱千壱" (jp-str/f 1001)))
  (assert (equal "壱千弐" (jp-str/f 1002)))
  (assert (equal "壱千九" (jp-str/f 1009)))
  (assert (equal "壱千拾" (jp-str/f 1010)))
  (assert (equal "壱千拾壱" (jp-str/f 1011)))
  (assert (equal "壱千拾九" (jp-str/f 1019)))
  (assert (equal "壱千弐拾" (jp-str/f 1020)))
  (assert (equal "壱千弐拾壱" (jp-str/f 1021)))
  (assert (equal "壱千弐拾九" (jp-str/f 1029)))
  (assert (equal "壱千参拾" (jp-str/f 1030)))
  (assert (equal "壱千九拾九" (jp-str/f 1099)))
  ;; 1100 - 9999
  (assert (equal "壱千壱百" (jp-str/f 1100)))
  (assert (equal "壱千壱百壱" (jp-str/f 1101)))
  (assert (equal "壱千壱百九" (jp-str/f 1109)))
  (assert (equal "壱千壱百拾" (jp-str/f 1110)))
  (assert (equal "壱千壱百拾壱" (jp-str/f 1111)))
  (assert (equal "壱千壱百拾九" (jp-str/f 1119)))
  (assert (equal "壱千壱百弐拾" (jp-str/f 1120)))
  (assert (equal "壱千壱百弐拾壱" (jp-str/f 1121)))
  (assert (equal "壱千壱百弐拾九" (jp-str/f 1129)))
  (assert (equal "壱千壱百九拾九" (jp-str/f 1199)))
  (assert (equal "壱千弐百" (jp-str/f 1200)))
  (assert (equal "壱千弐百壱" (jp-str/f 1201)))
  (assert (equal "壱千弐百九" (jp-str/f 1209)))
  (assert (equal "壱千弐百拾" (jp-str/f 1210)))
  (assert (equal "壱千弐百拾壱" (jp-str/f 1211)))
  (assert (equal "壱千弐百拾九" (jp-str/f 1219)))
  (assert (equal "壱千弐百弐拾" (jp-str/f 1220)))
  (assert (equal "壱千弐百弐拾壱" (jp-str/f 1221)))
  (assert (equal "壱千弐百弐拾九" (jp-str/f 1229)))
  (assert (equal "壱千弐百九拾九" (jp-str/f 1299)))
  (assert (equal "壱千九百" (jp-str/f 1900)))
  (assert (equal "壱千九百壱" (jp-str/f 1901)))
  (assert (equal "壱千九百九" (jp-str/f 1909)))
  (assert (equal "壱千九百拾" (jp-str/f 1910)))
  (assert (equal "壱千九百拾壱" (jp-str/f 1911)))
  (assert (equal "壱千九百拾九" (jp-str/f 1919)))
  (assert (equal "壱千九百弐拾" (jp-str/f 1920)))
  (assert (equal "壱千九百弐拾壱" (jp-str/f 1921)))
  (assert (equal "壱千九百弐拾九" (jp-str/f 1929)))
  (assert (equal "壱千九百九拾九" (jp-str/f 1999)))
  ;; 2000 - 9999
  (assert (equal "弐千" (jp-str/f 2000)))
  (assert (equal "弐千壱" (jp-str/f 2001)))
  (assert (equal "弐千拾" (jp-str/f 2010)))
  (assert (equal "弐千拾壱" (jp-str/f 2011)))
  (assert (equal "弐千弐拾" (jp-str/f 2020)))
  (assert (equal "弐千弐拾壱" (jp-str/f 2021)))
  (assert (equal "弐千壱百" (jp-str/f 2100)))
  (assert (equal "弐千壱百壱" (jp-str/f 2101)))
  (assert (equal "弐千壱百拾" (jp-str/f 2110)))
  (assert (equal "弐千壱百拾壱" (jp-str/f 2111)))
  (assert (equal "弐千壱百弐拾" (jp-str/f 2120)))
  (assert (equal "弐千壱百弐拾壱" (jp-str/f 2121)))
  (assert (equal "弐千弐百" (jp-str/f 2200)))
  (assert (equal "弐千弐百壱" (jp-str/f 2201)))
  (assert (equal "弐千弐百拾" (jp-str/f 2210)))
  (assert (equal "弐千弐百拾壱" (jp-str/f 2211)))
  (assert (equal "弐千弐百弐拾" (jp-str/f 2220)))
  (assert (equal "弐千弐百弐拾壱" (jp-str/f 2221)))
  (assert (equal "参千" (jp-str/f 3000)))
  (assert (equal "参千壱" (jp-str/f 3001)))
  (assert (equal "参千拾" (jp-str/f 3010)))
  (assert (equal "参千拾壱" (jp-str/f 3011)))
  (assert (equal "参千弐拾" (jp-str/f 3020)))
  (assert (equal "参千弐拾壱" (jp-str/f 3021)))
  (assert (equal "参千壱百" (jp-str/f 3100)))
  (assert (equal "参千壱百壱" (jp-str/f 3101)))
  (assert (equal "参千壱百拾" (jp-str/f 3110)))
  (assert (equal "参千壱百拾壱" (jp-str/f 3111)))
  (assert (equal "参千壱百弐拾" (jp-str/f 3120)))
  (assert (equal "参千壱百弐拾壱" (jp-str/f 3121)))
  (assert (equal "参千弐百" (jp-str/f 3200)))
  (assert (equal "参千弐百壱" (jp-str/f 3201)))
  (assert (equal "参千弐百拾" (jp-str/f 3210)))
  (assert (equal "参千弐百拾壱" (jp-str/f 3211)))
  (assert (equal "参千弐百弐拾" (jp-str/f 3220)))
  (assert (equal "参千弐百弐拾壱" (jp-str/f 3221)))
  (assert (equal "四千" (jp-str/f 4000)))
  (assert (equal "四千壱" (jp-str/f 4001)))
  (assert (equal "四千拾" (jp-str/f 4010)))
  (assert (equal "四千拾壱" (jp-str/f 4011)))
  (assert (equal "四千弐拾" (jp-str/f 4020)))
  (assert (equal "四千弐拾壱" (jp-str/f 4021)))
  (assert (equal "四千壱百" (jp-str/f 4100)))
  (assert (equal "四千壱百壱" (jp-str/f 4101)))
  (assert (equal "四千壱百拾" (jp-str/f 4110)))
  (assert (equal "四千壱百拾壱" (jp-str/f 4111)))
  (assert (equal "四千壱百弐拾" (jp-str/f 4120)))
  (assert (equal "四千壱百弐拾壱" (jp-str/f 4121)))
  (assert (equal "四千弐百" (jp-str/f 4200)))
  (assert (equal "四千弐百壱" (jp-str/f 4201)))
  (assert (equal "四千弐百拾" (jp-str/f 4210)))
  (assert (equal "四千弐百拾壱" (jp-str/f 4211)))
  (assert (equal "四千弐百弐拾" (jp-str/f 4220)))
  (assert (equal "四千弐百弐拾壱" (jp-str/f 4221)))
  (assert (equal "五千" (jp-str/f 5000)))
  (assert (equal "五千壱" (jp-str/f 5001)))
  (assert (equal "五千拾" (jp-str/f 5010)))
  (assert (equal "五千拾壱" (jp-str/f 5011)))
  (assert (equal "五千弐拾" (jp-str/f 5020)))
  (assert (equal "五千弐拾壱" (jp-str/f 5021)))
  (assert (equal "五千壱百" (jp-str/f 5100)))
  (assert (equal "五千壱百壱" (jp-str/f 5101)))
  (assert (equal "五千壱百拾" (jp-str/f 5110)))
  (assert (equal "五千壱百拾壱" (jp-str/f 5111)))
  (assert (equal "五千壱百弐拾" (jp-str/f 5120)))
  (assert (equal "五千壱百弐拾壱" (jp-str/f 5121)))
  (assert (equal "五千弐百" (jp-str/f 5200)))
  (assert (equal "五千弐百壱" (jp-str/f 5201)))
  (assert (equal "五千弐百拾" (jp-str/f 5210)))
  (assert (equal "五千弐百拾壱" (jp-str/f 5211)))
  (assert (equal "五千弐百弐拾" (jp-str/f 5220)))
  (assert (equal "五千弐百弐拾壱" (jp-str/f 5221)))
  (assert (equal "六千" (jp-str/f 6000)))
  (assert (equal "六千壱" (jp-str/f 6001)))
  (assert (equal "六千拾" (jp-str/f 6010)))
  (assert (equal "六千拾壱" (jp-str/f 6011)))
  (assert (equal "六千弐拾" (jp-str/f 6020)))
  (assert (equal "六千弐拾壱" (jp-str/f 6021)))
  (assert (equal "六千壱百" (jp-str/f 6100)))
  (assert (equal "六千壱百壱" (jp-str/f 6101)))
  (assert (equal "六千壱百拾" (jp-str/f 6110)))
  (assert (equal "六千壱百拾壱" (jp-str/f 6111)))
  (assert (equal "六千壱百弐拾" (jp-str/f 6120)))
  (assert (equal "六千壱百弐拾壱" (jp-str/f 6121)))
  (assert (equal "六千弐百" (jp-str/f 6200)))
  (assert (equal "六千弐百壱" (jp-str/f 6201)))
  (assert (equal "六千弐百拾" (jp-str/f 6210)))
  (assert (equal "六千弐百拾壱" (jp-str/f 6211)))
  (assert (equal "六千弐百弐拾" (jp-str/f 6220)))
  (assert (equal "六千弐百弐拾壱" (jp-str/f 6221)))
  (assert (equal "七千" (jp-str/f 7000)))
  (assert (equal "七千壱" (jp-str/f 7001)))
  (assert (equal "七千拾" (jp-str/f 7010)))
  (assert (equal "七千拾壱" (jp-str/f 7011)))
  (assert (equal "七千弐拾" (jp-str/f 7020)))
  (assert (equal "七千弐拾壱" (jp-str/f 7021)))
  (assert (equal "七千壱百" (jp-str/f 7100)))
  (assert (equal "七千壱百壱" (jp-str/f 7101)))
  (assert (equal "七千壱百拾" (jp-str/f 7110)))
  (assert (equal "七千壱百拾壱" (jp-str/f 7111)))
  (assert (equal "七千壱百弐拾" (jp-str/f 7120)))
  (assert (equal "七千壱百弐拾壱" (jp-str/f 7121)))
  (assert (equal "七千弐百" (jp-str/f 7200)))
  (assert (equal "七千弐百壱" (jp-str/f 7201)))
  (assert (equal "七千弐百拾" (jp-str/f 7210)))
  (assert (equal "七千弐百拾壱" (jp-str/f 7211)))
  (assert (equal "七千弐百弐拾" (jp-str/f 7220)))
  (assert (equal "七千弐百弐拾壱" (jp-str/f 7221)))
  (assert (equal "八千" (jp-str/f 8000)))
  (assert (equal "八千壱" (jp-str/f 8001)))
  (assert (equal "八千拾" (jp-str/f 8010)))
  (assert (equal "八千拾壱" (jp-str/f 8011)))
  (assert (equal "八千弐拾" (jp-str/f 8020)))
  (assert (equal "八千弐拾壱" (jp-str/f 8021)))
  (assert (equal "八千壱百" (jp-str/f 8100)))
  (assert (equal "八千壱百壱" (jp-str/f 8101)))
  (assert (equal "八千壱百拾" (jp-str/f 8110)))
  (assert (equal "八千壱百拾壱" (jp-str/f 8111)))
  (assert (equal "八千壱百弐拾" (jp-str/f 8120)))
  (assert (equal "八千壱百弐拾壱" (jp-str/f 8121)))
  (assert (equal "八千弐百" (jp-str/f 8200)))
  (assert (equal "八千弐百壱" (jp-str/f 8201)))
  (assert (equal "八千弐百拾" (jp-str/f 8210)))
  (assert (equal "八千弐百拾壱" (jp-str/f 8211)))
  (assert (equal "八千弐百弐拾" (jp-str/f 8220)))
  (assert (equal "八千弐百弐拾壱" (jp-str/f 8221)))
  (assert (equal "九千" (jp-str/f 9000)))
  (assert (equal "九千壱" (jp-str/f 9001)))
  (assert (equal "九千拾" (jp-str/f 9010)))
  (assert (equal "九千拾壱" (jp-str/f 9011)))
  (assert (equal "九千弐拾" (jp-str/f 9020)))
  (assert (equal "九千弐拾壱" (jp-str/f 9021)))
  (assert (equal "九千壱百" (jp-str/f 9100)))
  (assert (equal "九千壱百壱" (jp-str/f 9101)))
  (assert (equal "九千壱百拾" (jp-str/f 9110)))
  (assert (equal "九千壱百拾壱" (jp-str/f 9111)))
  (assert (equal "九千壱百弐拾" (jp-str/f 9120)))
  (assert (equal "九千壱百弐拾壱" (jp-str/f 9121)))
  (assert (equal "九千弐百" (jp-str/f 9200)))
  (assert (equal "九千弐百壱" (jp-str/f 9201)))
  (assert (equal "九千弐百拾" (jp-str/f 9210)))
  (assert (equal "九千弐百拾壱" (jp-str/f 9211)))
  (assert (equal "九千弐百弐拾" (jp-str/f 9220)))
  (assert (equal "九千弐百弐拾壱" (jp-str/f 9221)))
  (assert (equal "九千九百九拾九" (jp-str/f 9999)))
  ;; 
  t)

(defun test-jp-formal-integer-bignums ()
  ;; 10000 - 19999
  (assert (equal "壱万" (jp-str/f 10000)))
  (assert (equal "壱万壱" (jp-str/f 10001)))
  (assert (equal "壱万九" (jp-str/f 10009)))
  (assert (equal "壱万拾" (jp-str/f 10010)))
  (assert (equal "壱万拾壱" (jp-str/f 10011)))
  (assert (equal "壱万拾九" (jp-str/f 10019)))
  (assert (equal "壱万弐拾" (jp-str/f 10020)))
  (assert (equal "壱万弐拾壱" (jp-str/f 10021)))
  (assert (equal "壱万弐拾九" (jp-str/f 10029)))
  (assert (equal "壱万壱百" (jp-str/f 10100)))
  (assert (equal "壱万壱百壱" (jp-str/f 10101)))
  (assert (equal "壱万壱百九" (jp-str/f 10109)))
  (assert (equal "壱万壱百拾" (jp-str/f 10110)))
  (assert (equal "壱万壱百拾壱" (jp-str/f 10111)))
  (assert (equal "壱万壱百拾九" (jp-str/f 10119)))
  (assert (equal "壱万壱百弐拾" (jp-str/f 10120)))
  (assert (equal "壱万壱百弐拾壱" (jp-str/f 10121)))
  (assert (equal "壱万壱百弐拾九" (jp-str/f 10129)))
  (assert (equal "壱万弐百" (jp-str/f 10200)))
  (assert (equal "壱万弐百壱" (jp-str/f 10201)))
  (assert (equal "壱万弐百九" (jp-str/f 10209)))
  (assert (equal "壱万弐百拾" (jp-str/f 10210)))
  (assert (equal "壱万弐百拾壱" (jp-str/f 10211)))
  (assert (equal "壱万弐百拾九" (jp-str/f 10219)))
  (assert (equal "壱万弐百弐拾" (jp-str/f 10220)))
  (assert (equal "壱万弐百弐拾壱" (jp-str/f 10221)))
  (assert (equal "壱万弐百弐拾九" (jp-str/f 10229)))
  (assert (equal "壱万壱千" (jp-str/f 11000)))
  (assert (equal "壱万壱千壱" (jp-str/f 11001)))
  (assert (equal "壱万壱千九" (jp-str/f 11009)))
  (assert (equal "壱万壱千拾" (jp-str/f 11010)))
  (assert (equal "壱万壱千拾壱" (jp-str/f 11011)))
  (assert (equal "壱万壱千拾九" (jp-str/f 11019)))
  (assert (equal "壱万壱千弐拾" (jp-str/f 11020)))
  (assert (equal "壱万壱千弐拾壱" (jp-str/f 11021)))
  (assert (equal "壱万壱千弐拾九" (jp-str/f 11029)))
  (assert (equal "壱万壱千壱百" (jp-str/f 11100)))
  (assert (equal "壱万壱千壱百壱" (jp-str/f 11101)))
  (assert (equal "壱万壱千壱百九" (jp-str/f 11109)))
  (assert (equal "壱万壱千壱百拾" (jp-str/f 11110)))
  (assert (equal "壱万壱千壱百拾壱" (jp-str/f 11111)))
  (assert (equal "壱万壱千壱百拾九" (jp-str/f 11119)))
  (assert (equal "壱万壱千壱百弐拾" (jp-str/f 11120)))
  (assert (equal "壱万壱千壱百弐拾壱" (jp-str/f 11121)))
  (assert (equal "壱万壱千壱百弐拾九" (jp-str/f 11129)))
  (assert (equal "壱万壱千弐百" (jp-str/f 11200)))
  (assert (equal "壱万壱千弐百壱" (jp-str/f 11201)))
  (assert (equal "壱万壱千弐百九" (jp-str/f 11209)))
  (assert (equal "壱万壱千弐百拾" (jp-str/f 11210)))
  (assert (equal "壱万壱千弐百拾壱" (jp-str/f 11211)))
  (assert (equal "壱万壱千弐百拾九" (jp-str/f 11219)))
  (assert (equal "壱万壱千弐百弐拾" (jp-str/f 11220)))
  (assert (equal "壱万壱千弐百弐拾壱" (jp-str/f 11221)))
  (assert (equal "壱万壱千弐百弐拾九" (jp-str/f 11229)))
  (assert (equal "壱万弐千" (jp-str/f 12000)))
  (assert (equal "壱万弐千壱" (jp-str/f 12001)))
  (assert (equal "壱万弐千九" (jp-str/f 12009)))
  (assert (equal "壱万弐千拾" (jp-str/f 12010)))
  (assert (equal "壱万弐千拾壱" (jp-str/f 12011)))
  (assert (equal "壱万弐千拾九" (jp-str/f 12019)))
  (assert (equal "壱万弐千弐拾" (jp-str/f 12020)))
  (assert (equal "壱万弐千弐拾壱" (jp-str/f 12021)))
  (assert (equal "壱万弐千弐拾九" (jp-str/f 12029)))
  (assert (equal "壱万弐千壱百" (jp-str/f 12100)))
  (assert (equal "壱万弐千壱百壱" (jp-str/f 12101)))
  (assert (equal "壱万弐千壱百九" (jp-str/f 12109)))
  (assert (equal "壱万弐千壱百拾" (jp-str/f 12110)))
  (assert (equal "壱万弐千壱百拾壱" (jp-str/f 12111)))
  (assert (equal "壱万弐千壱百拾九" (jp-str/f 12119)))
  (assert (equal "壱万弐千壱百弐拾" (jp-str/f 12120)))
  (assert (equal "壱万弐千壱百弐拾壱" (jp-str/f 12121)))
  (assert (equal "壱万弐千壱百弐拾九" (jp-str/f 12129)))
  (assert (equal "壱万弐千弐百" (jp-str/f 12200)))
  (assert (equal "壱万弐千弐百壱" (jp-str/f 12201)))
  (assert (equal "壱万弐千弐百九" (jp-str/f 12209)))
  (assert (equal "壱万弐千弐百拾" (jp-str/f 12210)))
  (assert (equal "壱万弐千弐百拾壱" (jp-str/f 12211)))
  (assert (equal "壱万弐千弐百拾九" (jp-str/f 12219)))
  (assert (equal "壱万弐千弐百弐拾" (jp-str/f 12220)))
  (assert (equal "壱万弐千弐百弐拾壱" (jp-str/f 12221)))
  (assert (equal "壱万弐千弐百弐拾九" (jp-str/f 12229)))
  (assert (equal "壱万九千九百九拾九" (jp-str/f 19999)))
  ;; 20000 - 99990000
  (assert (equal "弐万" (jp-str/f 20000)))
  (assert (equal "九万" (jp-str/f 90000)))
  (assert (equal "拾万" (jp-str/f 100000)))
  (assert (equal "拾壱万" (jp-str/f 110000)))
  (assert (equal "拾九万" (jp-str/f 190000)))
  (assert (equal "弐拾万" (jp-str/f 200000)))
  (assert (equal "弐拾壱万" (jp-str/f 210000)))
  (assert (equal "弐拾九万" (jp-str/f 290000)))
  (assert (equal "壱百万" (jp-str/f 1000000)))
  (assert (equal "壱百壱万" (jp-str/f 1010000)))
  (assert (equal "壱百九万" (jp-str/f 1090000)))
  (assert (equal "壱百拾万" (jp-str/f 1100000)))
  (assert (equal "壱百拾壱万" (jp-str/f 1110000)))
  (assert (equal "壱百拾九万" (jp-str/f 1190000)))
  (assert (equal "壱百弐拾万" (jp-str/f 1200000)))
  (assert (equal "壱百弐拾壱万" (jp-str/f 1210000)))
  (assert (equal "壱百弐拾九万" (jp-str/f 1290000)))
  (assert (equal "弐百万" (jp-str/f 2000000)))
  (assert (equal "弐百壱万" (jp-str/f 2010000)))
  (assert (equal "弐百九万" (jp-str/f 2090000)))
  (assert (equal "弐百拾万" (jp-str/f 2100000)))
  (assert (equal "弐百拾壱万" (jp-str/f 2110000)))
  (assert (equal "弐百拾九万" (jp-str/f 2190000)))
  (assert (equal "弐百弐拾万" (jp-str/f 2200000)))
  (assert (equal "弐百弐拾壱万" (jp-str/f 2210000)))
  (assert (equal "弐百弐拾九万" (jp-str/f 2290000)))
  (assert (equal "壱千万" (jp-str/f 10000000)))
  (assert (equal "壱千壱万" (jp-str/f 10010000)))
  (assert (equal "壱千九万" (jp-str/f 10090000)))
  (assert (equal "壱千拾万" (jp-str/f 10100000)))
  (assert (equal "壱千拾壱万" (jp-str/f 10110000)))
  (assert (equal "壱千拾九万" (jp-str/f 10190000)))
  (assert (equal "壱千弐拾万" (jp-str/f 10200000)))
  (assert (equal "壱千弐拾壱万" (jp-str/f 10210000)))
  (assert (equal "壱千弐拾九万" (jp-str/f 10290000)))
  (assert (equal "壱千壱百万" (jp-str/f 11000000)))
  (assert (equal "壱千壱百壱万" (jp-str/f 11010000)))
  (assert (equal "壱千壱百九万" (jp-str/f 11090000)))
  (assert (equal "壱千壱百拾万" (jp-str/f 11100000)))
  (assert (equal "壱千壱百拾壱万" (jp-str/f 11110000)))
  (assert (equal "壱千壱百拾九万" (jp-str/f 11190000)))
  (assert (equal "壱千壱百弐拾万" (jp-str/f 11200000)))
  (assert (equal "壱千壱百弐拾壱万" (jp-str/f 11210000)))
  (assert (equal "壱千壱百弐拾九万" (jp-str/f 11290000)))
  (assert (equal "壱千弐百万" (jp-str/f 12000000)))
  (assert (equal "壱千弐百壱万" (jp-str/f 12010000)))
  (assert (equal "壱千弐百九万" (jp-str/f 12090000)))
  (assert (equal "壱千弐百拾万" (jp-str/f 12100000)))
  (assert (equal "壱千弐百拾壱万" (jp-str/f 12110000)))
  (assert (equal "壱千弐百拾九万" (jp-str/f 12190000)))
  (assert (equal "壱千弐百弐拾万" (jp-str/f 12200000)))
  (assert (equal "壱千弐百弐拾壱万" (jp-str/f 12210000)))
  (assert (equal "壱千弐百弐拾九万" (jp-str/f 12290000)))
  (assert (equal "弐千万" (jp-str/f 20000000)))
  (assert (equal "弐千壱万" (jp-str/f 20010000)))
  (assert (equal "弐千九万" (jp-str/f 20090000)))
  (assert (equal "弐千拾万" (jp-str/f 20100000)))
  (assert (equal "弐千拾壱万" (jp-str/f 20110000)))
  (assert (equal "弐千拾九万" (jp-str/f 20190000)))
  (assert (equal "弐千弐拾万" (jp-str/f 20200000)))
  (assert (equal "弐千弐拾壱万" (jp-str/f 20210000)))
  (assert (equal "弐千弐拾九万" (jp-str/f 20290000)))
  (assert (equal "弐千壱百万" (jp-str/f 21000000)))
  (assert (equal "弐千壱百壱万" (jp-str/f 21010000)))
  (assert (equal "弐千壱百九万" (jp-str/f 21090000)))
  (assert (equal "弐千壱百拾万" (jp-str/f 21100000)))
  (assert (equal "弐千壱百拾壱万" (jp-str/f 21110000)))
  (assert (equal "弐千壱百拾九万" (jp-str/f 21190000)))
  (assert (equal "弐千壱百弐拾万" (jp-str/f 21200000)))
  (assert (equal "弐千壱百弐拾壱万" (jp-str/f 21210000)))
  (assert (equal "弐千壱百弐拾九万" (jp-str/f 21290000)))
  (assert (equal "弐千弐百万" (jp-str/f 22000000)))
  (assert (equal "弐千弐百壱万" (jp-str/f 22010000)))
  (assert (equal "弐千弐百九万" (jp-str/f 22090000)))
  (assert (equal "弐千弐百拾万" (jp-str/f 22100000)))
  (assert (equal "弐千弐百拾壱万" (jp-str/f 22110000)))
  (assert (equal "弐千弐百拾九万" (jp-str/f 22190000)))
  (assert (equal "弐千弐百弐拾万" (jp-str/f 22200000)))
  (assert (equal "弐千弐百弐拾壱万" (jp-str/f 22210000)))
  (assert (equal "弐千弐百弐拾九万" (jp-str/f 22290000)))
  (assert (equal "九千九百九拾九万" (jp-str/f 99990000)))
  ;; 100000000 - 100009999
  (assert (equal "壱億" (jp-str/f 100000000)))
  (assert (equal "壱億壱" (jp-str/f 100000001)))
  (assert (equal "壱億九" (jp-str/f 100000009)))
  (assert (equal "壱億拾" (jp-str/f 100000010)))
  (assert (equal "壱億拾壱" (jp-str/f 100000011)))
  (assert (equal "壱億拾九" (jp-str/f 100000019)))
  (assert (equal "壱億弐拾" (jp-str/f 100000020)))
  (assert (equal "壱億弐拾壱" (jp-str/f 100000021)))
  (assert (equal "壱億弐拾九" (jp-str/f 100000029)))
  (assert (equal "壱億壱百" (jp-str/f 100000100)))
  (assert (equal "壱億壱百壱" (jp-str/f 100000101)))
  (assert (equal "壱億壱百九" (jp-str/f 100000109)))
  (assert (equal "壱億壱百拾" (jp-str/f 100000110)))
  (assert (equal "壱億壱百拾壱" (jp-str/f 100000111)))
  (assert (equal "壱億壱百拾九" (jp-str/f 100000119)))
  (assert (equal "壱億壱百弐拾" (jp-str/f 100000120)))
  (assert (equal "壱億壱百弐拾壱" (jp-str/f 100000121)))
  (assert (equal "壱億壱百弐拾九" (jp-str/f 100000129)))
  (assert (equal "壱億弐百" (jp-str/f 100000200)))
  (assert (equal "壱億弐百壱" (jp-str/f 100000201)))
  (assert (equal "壱億弐百九" (jp-str/f 100000209)))
  (assert (equal "壱億弐百拾" (jp-str/f 100000210)))
  (assert (equal "壱億弐百拾壱" (jp-str/f 100000211)))
  (assert (equal "壱億弐百拾九" (jp-str/f 100000219)))
  (assert (equal "壱億弐百弐拾" (jp-str/f 100000220)))
  (assert (equal "壱億弐百弐拾壱" (jp-str/f 100000221)))
  (assert (equal "壱億弐百弐拾九" (jp-str/f 100000229)))
  (assert (equal "壱億壱千" (jp-str/f 100001000)))
  (assert (equal "壱億壱千壱" (jp-str/f 100001001)))
  (assert (equal "壱億壱千九" (jp-str/f 100001009)))
  (assert (equal "壱億壱千拾" (jp-str/f 100001010)))
  (assert (equal "壱億壱千拾壱" (jp-str/f 100001011)))
  (assert (equal "壱億壱千拾九" (jp-str/f 100001019)))
  (assert (equal "壱億壱千弐拾" (jp-str/f 100001020)))
  (assert (equal "壱億壱千弐拾壱" (jp-str/f 100001021)))
  (assert (equal "壱億壱千弐拾九" (jp-str/f 100001029)))
  (assert (equal "壱億壱千壱百" (jp-str/f 100001100)))
  (assert (equal "壱億壱千壱百壱" (jp-str/f 100001101)))
  (assert (equal "壱億壱千壱百九" (jp-str/f 100001109)))
  (assert (equal "壱億壱千壱百拾" (jp-str/f 100001110)))
  (assert (equal "壱億壱千壱百拾壱" (jp-str/f 100001111)))
  (assert (equal "壱億壱千壱百拾九" (jp-str/f 100001119)))
  (assert (equal "壱億壱千壱百弐拾" (jp-str/f 100001120)))
  (assert (equal "壱億壱千壱百弐拾壱" (jp-str/f 100001121)))
  (assert (equal "壱億壱千壱百弐拾九" (jp-str/f 100001129)))
  (assert (equal "壱億壱千弐百" (jp-str/f 100001200)))
  (assert (equal "壱億壱千弐百壱" (jp-str/f 100001201)))
  (assert (equal "壱億壱千弐百九" (jp-str/f 100001209)))
  (assert (equal "壱億壱千弐百拾" (jp-str/f 100001210)))
  (assert (equal "壱億壱千弐百拾壱" (jp-str/f 100001211)))
  (assert (equal "壱億壱千弐百拾九" (jp-str/f 100001219)))
  (assert (equal "壱億壱千弐百弐拾" (jp-str/f 100001220)))
  (assert (equal "壱億壱千弐百弐拾壱" (jp-str/f 100001221)))
  (assert (equal "壱億壱千弐百弐拾九" (jp-str/f 100001229)))
  (assert (equal "壱億弐千" (jp-str/f 100002000)))
  (assert (equal "壱億弐千壱" (jp-str/f 100002001)))
  (assert (equal "壱億弐千九" (jp-str/f 100002009)))
  (assert (equal "壱億弐千拾" (jp-str/f 100002010)))
  (assert (equal "壱億弐千拾壱" (jp-str/f 100002011)))
  (assert (equal "壱億弐千拾九" (jp-str/f 100002019)))
  (assert (equal "壱億弐千弐拾" (jp-str/f 100002020)))
  (assert (equal "壱億弐千弐拾壱" (jp-str/f 100002021)))
  (assert (equal "壱億弐千弐拾九" (jp-str/f 100002029)))
  (assert (equal "壱億弐千壱百" (jp-str/f 100002100)))
  (assert (equal "壱億弐千壱百壱" (jp-str/f 100002101)))
  (assert (equal "壱億弐千壱百九" (jp-str/f 100002109)))
  (assert (equal "壱億弐千壱百拾" (jp-str/f 100002110)))
  (assert (equal "壱億弐千壱百拾壱" (jp-str/f 100002111)))
  (assert (equal "壱億弐千壱百拾九" (jp-str/f 100002119)))
  (assert (equal "壱億弐千壱百弐拾" (jp-str/f 100002120)))
  (assert (equal "壱億弐千壱百弐拾壱" (jp-str/f 100002121)))
  (assert (equal "壱億弐千壱百弐拾九" (jp-str/f 100002129)))
  (assert (equal "壱億弐千弐百" (jp-str/f 100002200)))
  (assert (equal "壱億弐千弐百壱" (jp-str/f 100002201)))
  (assert (equal "壱億弐千弐百九" (jp-str/f 100002209)))
  (assert (equal "壱億弐千弐百拾" (jp-str/f 100002210)))
  (assert (equal "壱億弐千弐百拾壱" (jp-str/f 100002211)))
  (assert (equal "壱億弐千弐百拾九" (jp-str/f 100002219)))
  (assert (equal "壱億弐千弐百弐拾" (jp-str/f 100002220)))
  (assert (equal "壱億弐千弐百弐拾壱" (jp-str/f 100002221)))
  (assert (equal "壱億弐千弐百弐拾九" (jp-str/f 100002229)))
  (assert (equal "壱億九千九百九拾九" (jp-str/f 100009999)))
  ;; 100010000 - 100019999
  (assert (equal "壱億壱万" (jp-str/f 100010000)))
  (assert (equal "壱億壱万壱" (jp-str/f 100010001)))
  (assert (equal "壱億壱万九" (jp-str/f 100010009)))
  (assert (equal "壱億壱万拾" (jp-str/f 100010010)))
  (assert (equal "壱億壱万拾壱" (jp-str/f 100010011)))
  (assert (equal "壱億壱万拾九" (jp-str/f 100010019)))
  (assert (equal "壱億壱万弐拾" (jp-str/f 100010020)))
  (assert (equal "壱億壱万弐拾壱" (jp-str/f 100010021)))
  (assert (equal "壱億壱万弐拾九" (jp-str/f 100010029)))
  (assert (equal "壱億壱万壱百" (jp-str/f 100010100)))
  (assert (equal "壱億壱万壱百壱" (jp-str/f 100010101)))
  (assert (equal "壱億壱万壱百九" (jp-str/f 100010109)))
  (assert (equal "壱億壱万壱百拾" (jp-str/f 100010110)))
  (assert (equal "壱億壱万壱百拾壱" (jp-str/f 100010111)))
  (assert (equal "壱億壱万壱百拾九" (jp-str/f 100010119)))
  (assert (equal "壱億壱万壱百弐拾" (jp-str/f 100010120)))
  (assert (equal "壱億壱万壱百弐拾壱" (jp-str/f 100010121)))
  (assert (equal "壱億壱万壱百弐拾九" (jp-str/f 100010129)))
  (assert (equal "壱億壱万弐百" (jp-str/f 100010200)))
  (assert (equal "壱億壱万弐百壱" (jp-str/f 100010201)))
  (assert (equal "壱億壱万弐百九" (jp-str/f 100010209)))
  (assert (equal "壱億壱万弐百拾" (jp-str/f 100010210)))
  (assert (equal "壱億壱万弐百拾壱" (jp-str/f 100010211)))
  (assert (equal "壱億壱万弐百拾九" (jp-str/f 100010219)))
  (assert (equal "壱億壱万弐百弐拾" (jp-str/f 100010220)))
  (assert (equal "壱億壱万弐百弐拾壱" (jp-str/f 100010221)))
  (assert (equal "壱億壱万弐百弐拾九" (jp-str/f 100010229)))
  (assert (equal "壱億壱万壱千" (jp-str/f 100011000)))
  (assert (equal "壱億壱万壱千壱" (jp-str/f 100011001)))
  (assert (equal "壱億壱万壱千九" (jp-str/f 100011009)))
  (assert (equal "壱億壱万壱千拾" (jp-str/f 100011010)))
  (assert (equal "壱億壱万壱千拾壱" (jp-str/f 100011011)))
  (assert (equal "壱億壱万壱千拾九" (jp-str/f 100011019)))
  (assert (equal "壱億壱万壱千弐拾" (jp-str/f 100011020)))
  (assert (equal "壱億壱万壱千弐拾壱" (jp-str/f 100011021)))
  (assert (equal "壱億壱万壱千弐拾九" (jp-str/f 100011029)))
  (assert (equal "壱億壱万壱千壱百" (jp-str/f 100011100)))
  (assert (equal "壱億壱万壱千壱百壱" (jp-str/f 100011101)))
  (assert (equal "壱億壱万壱千壱百九" (jp-str/f 100011109)))
  (assert (equal "壱億壱万壱千壱百拾" (jp-str/f 100011110)))
  (assert (equal "壱億壱万壱千壱百拾壱" (jp-str/f 100011111)))
  (assert (equal "壱億壱万壱千壱百拾九" (jp-str/f 100011119)))
  (assert (equal "壱億壱万壱千壱百弐拾" (jp-str/f 100011120)))
  (assert (equal "壱億壱万壱千壱百弐拾壱" (jp-str/f 100011121)))
  (assert (equal "壱億壱万壱千壱百弐拾九" (jp-str/f 100011129)))
  (assert (equal "壱億壱万壱千弐百" (jp-str/f 100011200)))
  (assert (equal "壱億壱万壱千弐百壱" (jp-str/f 100011201)))
  (assert (equal "壱億壱万壱千弐百九" (jp-str/f 100011209)))
  (assert (equal "壱億壱万壱千弐百拾" (jp-str/f 100011210)))
  (assert (equal "壱億壱万壱千弐百拾壱" (jp-str/f 100011211)))
  (assert (equal "壱億壱万壱千弐百拾九" (jp-str/f 100011219)))
  (assert (equal "壱億壱万壱千弐百弐拾" (jp-str/f 100011220)))
  (assert (equal "壱億壱万壱千弐百弐拾壱" (jp-str/f 100011221)))
  (assert (equal "壱億壱万壱千弐百弐拾九" (jp-str/f 100011229)))
  (assert (equal "壱億壱万弐千" (jp-str/f 100012000)))
  (assert (equal "壱億壱万弐千壱" (jp-str/f 100012001)))
  (assert (equal "壱億壱万弐千九" (jp-str/f 100012009)))
  (assert (equal "壱億壱万弐千拾" (jp-str/f 100012010)))
  (assert (equal "壱億壱万弐千拾壱" (jp-str/f 100012011)))
  (assert (equal "壱億壱万弐千拾九" (jp-str/f 100012019)))
  (assert (equal "壱億壱万弐千弐拾" (jp-str/f 100012020)))
  (assert (equal "壱億壱万弐千弐拾壱" (jp-str/f 100012021)))
  (assert (equal "壱億壱万弐千弐拾九" (jp-str/f 100012029)))
  (assert (equal "壱億壱万弐千壱百" (jp-str/f 100012100)))
  (assert (equal "壱億壱万弐千壱百壱" (jp-str/f 100012101)))
  (assert (equal "壱億壱万弐千壱百九" (jp-str/f 100012109)))
  (assert (equal "壱億壱万弐千壱百拾" (jp-str/f 100012110)))
  (assert (equal "壱億壱万弐千壱百拾壱" (jp-str/f 100012111)))
  (assert (equal "壱億壱万弐千壱百拾九" (jp-str/f 100012119)))
  (assert (equal "壱億壱万弐千壱百弐拾" (jp-str/f 100012120)))
  (assert (equal "壱億壱万弐千壱百弐拾壱" (jp-str/f 100012121)))
  (assert (equal "壱億壱万弐千壱百弐拾九" (jp-str/f 100012129)))
  (assert (equal "壱億壱万弐千弐百" (jp-str/f 100012200)))
  (assert (equal "壱億壱万弐千弐百壱" (jp-str/f 100012201)))
  (assert (equal "壱億壱万弐千弐百九" (jp-str/f 100012209)))
  (assert (equal "壱億壱万弐千弐百拾" (jp-str/f 100012210)))
  (assert (equal "壱億壱万弐千弐百拾壱" (jp-str/f 100012211)))
  (assert (equal "壱億壱万弐千弐百拾九" (jp-str/f 100012219)))
  (assert (equal "壱億壱万弐千弐百弐拾" (jp-str/f 100012220)))
  (assert (equal "壱億壱万弐千弐百弐拾壱" (jp-str/f 100012221)))
  (assert (equal "壱億壱万弐千弐百弐拾九" (jp-str/f 100012229)))
  (assert (equal "壱億壱万九千九百九拾九" (jp-str/f 100019999)))
  ;; 100020000 - 199990000
  (assert (equal "壱億弐万" (jp-str/f 100020000)))
  (assert (equal "壱億九万" (jp-str/f 100090000)))
  (assert (equal "壱億拾万" (jp-str/f 100100000)))
  (assert (equal "壱億拾壱万" (jp-str/f 100110000)))
  (assert (equal "壱億拾九万" (jp-str/f 100190000)))
  (assert (equal "壱億弐拾万" (jp-str/f 100200000)))
  (assert (equal "壱億弐拾壱万" (jp-str/f 100210000)))
  (assert (equal "壱億弐拾九万" (jp-str/f 100290000)))
  (assert (equal "壱億壱百万" (jp-str/f 101000000)))
  (assert (equal "壱億壱百壱万" (jp-str/f 101010000)))
  (assert (equal "壱億壱百九万" (jp-str/f 101090000)))
  (assert (equal "壱億壱百拾万" (jp-str/f 101100000)))
  (assert (equal "壱億壱百拾壱万" (jp-str/f 101110000)))
  (assert (equal "壱億壱百拾九万" (jp-str/f 101190000)))
  (assert (equal "壱億壱百弐拾万" (jp-str/f 101200000)))
  (assert (equal "壱億壱百弐拾壱万" (jp-str/f 101210000)))
  (assert (equal "壱億壱百弐拾九万" (jp-str/f 101290000)))
  (assert (equal "壱億弐百万" (jp-str/f 102000000)))
  (assert (equal "壱億弐百壱万" (jp-str/f 102010000)))
  (assert (equal "壱億弐百九万" (jp-str/f 102090000)))
  (assert (equal "壱億弐百拾万" (jp-str/f 102100000)))
  (assert (equal "壱億弐百拾壱万" (jp-str/f 102110000)))
  (assert (equal "壱億弐百拾九万" (jp-str/f 102190000)))
  (assert (equal "壱億弐百弐拾万" (jp-str/f 102200000)))
  (assert (equal "壱億弐百弐拾壱万" (jp-str/f 102210000)))
  (assert (equal "壱億弐百弐拾九万" (jp-str/f 102290000)))
  (assert (equal "壱億壱千万" (jp-str/f 110000000)))
  (assert (equal "壱億壱千壱万" (jp-str/f 110010000)))
  (assert (equal "壱億壱千九万" (jp-str/f 110090000)))
  (assert (equal "壱億壱千拾万" (jp-str/f 110100000)))
  (assert (equal "壱億壱千拾壱万" (jp-str/f 110110000)))
  (assert (equal "壱億壱千拾九万" (jp-str/f 110190000)))
  (assert (equal "壱億壱千弐拾万" (jp-str/f 110200000)))
  (assert (equal "壱億壱千弐拾壱万" (jp-str/f 110210000)))
  (assert (equal "壱億壱千弐拾九万" (jp-str/f 110290000)))
  (assert (equal "壱億壱千壱百万" (jp-str/f 111000000)))
  (assert (equal "壱億壱千壱百壱万" (jp-str/f 111010000)))
  (assert (equal "壱億壱千壱百九万" (jp-str/f 111090000)))
  (assert (equal "壱億壱千壱百拾万" (jp-str/f 111100000)))
  (assert (equal "壱億壱千壱百拾壱万" (jp-str/f 111110000)))
  (assert (equal "壱億壱千壱百拾九万" (jp-str/f 111190000)))
  (assert (equal "壱億壱千壱百弐拾万" (jp-str/f 111200000)))
  (assert (equal "壱億壱千壱百弐拾壱万" (jp-str/f 111210000)))
  (assert (equal "壱億壱千壱百弐拾九万" (jp-str/f 111290000)))
  (assert (equal "壱億壱千弐百万" (jp-str/f 112000000)))
  (assert (equal "壱億壱千弐百壱万" (jp-str/f 112010000)))
  (assert (equal "壱億壱千弐百九万" (jp-str/f 112090000)))
  (assert (equal "壱億壱千弐百拾万" (jp-str/f 112100000)))
  (assert (equal "壱億壱千弐百拾壱万" (jp-str/f 112110000)))
  (assert (equal "壱億壱千弐百拾九万" (jp-str/f 112190000)))
  (assert (equal "壱億壱千弐百弐拾万" (jp-str/f 112200000)))
  (assert (equal "壱億壱千弐百弐拾壱万" (jp-str/f 112210000)))
  (assert (equal "壱億壱千弐百弐拾九万" (jp-str/f 112290000)))
  (assert (equal "壱億弐千万" (jp-str/f 120000000)))
  (assert (equal "壱億弐千壱万" (jp-str/f 120010000)))
  (assert (equal "壱億弐千九万" (jp-str/f 120090000)))
  (assert (equal "壱億弐千拾万" (jp-str/f 120100000)))
  (assert (equal "壱億弐千拾壱万" (jp-str/f 120110000)))
  (assert (equal "壱億弐千拾九万" (jp-str/f 120190000)))
  (assert (equal "壱億弐千弐拾万" (jp-str/f 120200000)))
  (assert (equal "壱億弐千弐拾壱万" (jp-str/f 120210000)))
  (assert (equal "壱億弐千弐拾九万" (jp-str/f 120290000)))
  (assert (equal "壱億弐千壱百万" (jp-str/f 121000000)))
  (assert (equal "壱億弐千壱百壱万" (jp-str/f 121010000)))
  (assert (equal "壱億弐千壱百九万" (jp-str/f 121090000)))
  (assert (equal "壱億弐千壱百拾万" (jp-str/f 121100000)))
  (assert (equal "壱億弐千壱百拾壱万" (jp-str/f 121110000)))
  (assert (equal "壱億弐千壱百拾九万" (jp-str/f 121190000)))
  (assert (equal "壱億弐千壱百弐拾万" (jp-str/f 121200000)))
  (assert (equal "壱億弐千壱百弐拾壱万" (jp-str/f 121210000)))
  (assert (equal "壱億弐千壱百弐拾九万" (jp-str/f 121290000)))
  (assert (equal "壱億弐千弐百万" (jp-str/f 122000000)))
  (assert (equal "壱億弐千弐百壱万" (jp-str/f 122010000)))
  (assert (equal "壱億弐千弐百九万" (jp-str/f 122090000)))
  (assert (equal "壱億弐千弐百拾万" (jp-str/f 122100000)))
  (assert (equal "壱億弐千弐百拾壱万" (jp-str/f 122110000)))
  (assert (equal "壱億弐千弐百拾九万" (jp-str/f 122190000)))
  (assert (equal "壱億弐千弐百弐拾万" (jp-str/f 122200000)))
  (assert (equal "壱億弐千弐百弐拾壱万" (jp-str/f 122210000)))
  (assert (equal "壱億弐千弐百弐拾九万" (jp-str/f 122290000)))
  (assert (equal "壱億九千九百九拾九万" (jp-str/f 199990000)))

  ;; more big nums
  (let ((num 12300001001))
    (assert (equal "壱百弐拾参億壱千壱" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参兆壱千壱万" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参京壱千壱億" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参垓壱千壱兆" (jp-str/f num)))
    (mulf num 10000)
    (when (<= #x25771 char-code-limit)	; contains U+25771 (10^24)
      (assert (equal "壱百弐拾参𥝱壱千壱京" (jp-str/f num))))
    (mulf num 10000)
    (assert (equal "壱百弐拾参穣壱千壱垓" (jp-str/f num)))
    (mulf num 10000)
    (when (<= #x25771 char-code-limit)	; contains U+25771 (10^24)
      (assert (equal "壱百弐拾参溝壱千壱𥝱" (jp-str/f num))))
    (mulf num 10000)
    (assert (equal "壱百弐拾参澗壱千壱穣" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参正壱千壱溝" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参載壱千壱澗" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参極壱千壱正" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参恒河沙壱千壱載" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参阿僧祇壱千壱極" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参那由他壱千壱恒河沙" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参不可思議壱千壱阿僧祇" (jp-str/f num)))
    (mulf num 10000)
    (assert (equal "壱百弐拾参無量大数壱千壱那由他" (jp-str/f num))))
  ;; 
  t)

(defun test-jp-formal-integer-minus ()
  (assert (equal "マイナス壱" (jp-str/f -1)))
  (assert (equal "マイナス弐" (jp-str/f -2)))
  (assert (equal "マイナス参" (jp-str/f -3)))
  (assert (equal "マイナス四" (jp-str/f -4)))
  (assert (equal "マイナス五" (jp-str/f -5)))
  (assert (equal "マイナス六" (jp-str/f -6)))
  (assert (equal "マイナス七" (jp-str/f -7)))
  (assert (equal "マイナス八" (jp-str/f -8)))
  (assert (equal "マイナス九" (jp-str/f -9)))
  (assert (equal "マイナス拾" (jp-str/f -10)))
  (assert (equal "マイナス弐拾" (jp-str/f -20)))
  (assert (equal "マイナス壱百" (jp-str/f -100)))
  (assert (equal "マイナス五百" (jp-str/f -500)))
  (assert (equal "マイナス壱千" (jp-str/f -1000)))
  (assert (equal "マイナス壱万" (jp-str/f -10000)))
  (assert (equal "マイナス壱万弐千参百四拾五" (jp-str/f -12345)))
  ;; 
  t)
  
(defun test-jp-formal-rational ()
  (assert (equal "弐分の壱" (jp-str/f 1/2)))
  (assert (equal "拾分の壱" (jp-str/f 1/10)))
  (assert (equal "弐拾分の壱" (jp-str/f 1/20)))
  (assert (equal "壱百分の壱" (jp-str/f 1/100)))
  (assert (equal "壱百拾分の壱" (jp-str/f 1/110)))
  (assert (equal "壱百拾壱分の壱" (jp-str/f 1/111)))
  (assert (equal "壱百弐拾分の壱" (jp-str/f 1/120)))
  (assert (equal "壱百弐拾壱分の壱" (jp-str/f 1/121)))
  (assert (equal "弐百分の壱" (jp-str/f 1/200)))
  (assert (equal "弐百拾分の壱" (jp-str/f 1/210)))
  (assert (equal "弐百拾壱分の壱" (jp-str/f 1/211)))
  (assert (equal "弐百弐拾分の壱" (jp-str/f 1/220)))
  (assert (equal "弐百弐拾壱分の壱" (jp-str/f 1/221)))
  (assert (equal "壱千分の壱" (jp-str/f 1/1000)))
  (assert (equal "壱千拾分の壱" (jp-str/f 1/1010)))
  (assert (equal "壱千拾壱分の壱" (jp-str/f 1/1011)))
  (assert (equal "壱千弐拾分の壱" (jp-str/f 1/1020)))
  (assert (equal "壱千弐拾壱分の壱" (jp-str/f 1/1021)))
  (assert (equal "壱千壱百分の壱" (jp-str/f 1/1100)))
  (assert (equal "壱千壱百拾分の壱" (jp-str/f 1/1110)))
  (assert (equal "壱千壱百拾壱分の壱" (jp-str/f 1/1111)))
  (assert (equal "壱千壱百弐拾分の壱" (jp-str/f 1/1120)))
  (assert (equal "壱千壱百弐拾壱分の壱" (jp-str/f 1/1121)))
  (assert (equal "弐千弐百壱分の壱" (jp-str/f 1/2201)))
  (assert (equal "壱万分の壱" (jp-str/f 1/10000)))
  (assert (equal "壱万壱千壱百拾壱分の壱" (jp-str/f 1/11111)))
  (assert (equal "弐万弐千弐百弐拾弐分の壱" (jp-str/f 1/22222)))
  (assert (equal "壱億分の壱" (jp-str/f 1/100000000)))

  (assert (equal "壱万九千九百九拾七分の壱" (jp-str/f 1/19997))) ; 19997 is a prime.
  (assert (equal "壱万九千九百九拾七分の弐" (jp-str/f 2/19997)))
  (assert (equal "壱万九千九百九拾七分の拾" (jp-str/f 10/19997)))
  (assert (equal "壱万九千九百九拾七分の拾壱" (jp-str/f 11/19997)))
  (assert (equal "壱万九千九百九拾七分の弐拾壱" (jp-str/f 21/19997)))
  (assert (equal "壱万九千九百九拾七分の九拾九" (jp-str/f 99/19997)))
  (assert (equal "壱万九千九百九拾七分の壱百" (jp-str/f 100/19997)))
  (assert (equal "壱万九千九百九拾七分の壱百壱" (jp-str/f 101/19997)))
  (assert (equal "壱万九千九百九拾七分の壱百拾壱" (jp-str/f 111/19997)))
  (assert (equal "壱万九千九百九拾七分の弐百拾壱" (jp-str/f 211/19997)))
  (assert (equal "壱万九千九百九拾七分の壱千壱" (jp-str/f 1001/19997)))
  (assert (equal "壱万九千九百九拾七分の壱千壱百拾壱" (jp-str/f 1111/19997)))
  (assert (equal "壱万九千九百九拾七分の弐千弐百弐拾弐" (jp-str/f 2222/19997)))
  (assert (equal "壱万九千九百九拾七分の壱万" (jp-str/f 10000/19997)))
  (assert (equal "壱万九千九百九拾七分の壱万壱" (jp-str/f 10001/19997)))
  (assert (equal "壱万九千九百九拾七分の壱万壱千壱百拾" (jp-str/f 11110/19997)))
  (assert (equal "壱万九千九百九拾七分の壱万五千弐" (jp-str/f 15002/19997)))
  (assert (equal "壱万九千九百九拾七分の壱万九千九百九拾六" (jp-str/f 19996/19997)))

  (assert (equal "マイナス弐分の壱" (jp-str/f -1/2)))
  ;; 
  t)
  
(defun test-jp-formal-float ()
  ;; 0.1-0.9
  (assert (equal "壱分" (jp-str/f 0.1)))
  (assert (equal "弐分" (jp-str/f 0.2)))
  (assert (equal "参分" (jp-str/f 0.3)))
  (assert (equal "四分" (jp-str/f 0.4)))
  (assert (equal "五分" (jp-str/f 0.5)))
  (assert (equal "六分" (jp-str/f 0.6)))
  (assert (equal "七分" (jp-str/f 0.7)))
  (assert (equal "八分" (jp-str/f 0.8)))
  (assert (equal "九分" (jp-str/f 0.9)))
  ;; 0.10-0.30
  (assert (equal "壱分" (jp-str/f 0.10)))
  (assert (equal "壱分壱厘" (jp-str/f 0.11)))
  (assert (equal "壱分弐厘" (jp-str/f 0.12)))
  (assert (equal "壱分参厘" (jp-str/f 0.13)))
  (assert (equal "壱分四厘" (jp-str/f 0.14)))
  (assert (equal "壱分五厘" (jp-str/f 0.15)))
  (assert (equal "壱分六厘" (jp-str/f 0.16)))
  (assert (equal "壱分七厘" (jp-str/f 0.17)))
  (assert (equal "壱分八厘" (jp-str/f 0.18)))
  (assert (equal "壱分九厘" (jp-str/f 0.19)))
  (assert (equal "弐分" (jp-str/f 0.20)))
  (assert (equal "弐分壱厘" (jp-str/f 0.21)))
  (assert (equal "弐分弐厘" (jp-str/f 0.22)))
  (assert (equal "弐分参厘" (jp-str/f 0.23)))
  (assert (equal "弐分四厘" (jp-str/f 0.24)))
  (assert (equal "弐分五厘" (jp-str/f 0.25)))
  (assert (equal "弐分六厘" (jp-str/f 0.26)))
  (assert (equal "弐分七厘" (jp-str/f 0.27)))
  (assert (equal "弐分八厘" (jp-str/f 0.28)))
  (assert (equal "弐分九厘" (jp-str/f 0.29)))
  (assert (equal "参分" (jp-str/f 0.30)))
  ;; small nums
  (assert (equal "拾・参分四厘" (jp-str/f 10.34)))
  (assert (equal "壱・参厘四毛" (jp-str/f 1.034)))
  (assert (equal "壱分参毛四糸" (jp-str/f 0.1034)))
  (assert (equal "壱厘参糸四忽" (jp-str/f 0.01034)))
  (assert (equal "壱毛参忽四微" (jp-str/f 0.001034)))
  (assert (equal "壱糸参微四繊" (jp-str/f 0.0001034)))
  (assert (equal "壱忽参繊四沙" (jp-str/f 0.00001034)))
  (assert (equal "壱微参沙四塵" (jp-str/f 0.000001034)))
  (assert (equal "壱繊参塵四埃" (jp-str/f 0.0000001034)))
  (assert (equal "壱沙参埃四渺" (jp-str/f 0.00000001034)))
  (assert (equal "壱塵参渺四漠" (jp-str/f 0.000000001034)))
  (assert (equal "壱埃参漠四模糊" (jp-str/f 0.0000000001034)))
  (assert (equal "壱渺参模糊四逡巡" (jp-str/f 0.00000000001034)))
  (assert (equal "壱漠参逡巡四須臾" (jp-str/f 0.000000000001034)))
  (assert (equal "壱模糊参須臾四瞬息" (jp-str/f 0.0000000000001034)))
  (assert (equal "壱逡巡参瞬息四弾指" (jp-str/f 0.00000000000001034)))
  (assert (equal "壱須臾参弾指四刹那" (jp-str/f 0.000000000000001034)))
  (assert (equal "壱瞬息参刹那四六徳" (jp-str/f 0.0000000000000001034)))
  (assert (equal "壱弾指参六徳四虚空" (jp-str/f 0.00000000000000001034)))
  (assert (equal "壱刹那参虚空四清浄" (jp-str/f 0.000000000000000001034)))
  ;; minus
  (assert (equal "マイナス壱分" (jp-str/f -0.1)))
  (assert (equal "マイナス弐分" (jp-str/f -0.2)))
  (assert (equal "マイナス壱分壱厘" (jp-str/f -0.11)))
  (assert (equal "マイナス弐厘" (jp-str/f -0.02)))
  ;;
  t)

(defun test-jp-formal-fallback ()
  ;; too big num
  (assert (equal "壱無量大数" (jp-str/f (expt 10 68))))
  (assert (equal "一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
		 (jp-str/f (expt 10 72))))
  (assert (equal "マイナス壱無量大数" (jp-str/f (- (expt 10 68)))))
  (assert (equal "−一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
		 (jp-str/f (- (expt 10 72)))))
  ;; too small num
  (assert (equal "壱清浄" (jp-str/f 0.000000000000000000001)))
  (assert (equal (format nil "~A" 0.0000000000000000000001)
  		 (jp-str/f 0.0000000000000000000001)))
  (assert (equal "マイナス壱清浄" (jp-str/f -0.000000000000000000001)))
  (assert (equal (format nil "~A" -0.0000000000000000000001)
  		 (jp-str/f -0.0000000000000000000001)))
  ;; complex
  (assert (equal (format nil "~A" #c(1 1))
  		 (jp-str/f #c(1 1))))
  ;;
  t)

(defun test-jp-formal-parameters ()
  ;; [Integer]
  ;; digits-after-dot -- ignored
  (assert (equal "壱" (jp-str/f 1 :digits-after-dot nil)))
  (assert (equal "壱" (jp-str/f 1 :digits-after-dot 0)))
  (assert (equal "壱" (jp-str/f 1 :digits-after-dot 1)))
  (assert (equal "壱" (jp-str/f 1 :digits-after-dot -1)))
  ;; scale
  (assert (equal "壱" (jp-str/f 1 :scale nil)))
  (assert (equal "壱" (jp-str/f 1 :scale 0)))
  (assert (equal "拾" (jp-str/f 1 :scale 1)))
  (assert (equal "拾分の壱" (jp-str/f 1 :scale -1)))
  ;; radix-point
  (assert (equal "壱" (jp-str/f 1 :radix-point nil)))
  (assert (equal "壱a" (jp-str/f 1 :radix-point #\a)))
  (assert (equal "壱abc" (jp-str/f 1 :radix-point "abc")))

  ;; [Rational]
  ;; digits-after-dot -- ignored
  (assert (equal "弐分の壱" (jp-str/f 1/2 :digits-after-dot nil)))
  (assert (equal "弐分の壱" (jp-str/f 1/2 :digits-after-dot 0)))
  (assert (equal "弐分の壱" (jp-str/f 1/2 :digits-after-dot 1)))
  (assert (equal "弐分の壱" (jp-str/f 1/2 :digits-after-dot -1)))
  ;; scale
  (assert (equal "弐分の壱" (jp-str/f 1/2 :scale nil)))
  (assert (equal "弐分の壱" (jp-str/f 1/2 :scale 0)))
  (assert (equal "五" (jp-str/f 1/2 :scale 1)))
  (assert (equal "弐拾分の壱" (jp-str/f 1/2 :scale -1)))
  ;; radix-point -- ignored
  (assert (equal "弐分の壱" (jp-str/f 1/2 :radix-point nil)))
  (assert (equal "弐分の壱" (jp-str/f 1/2 :radix-point #\a)))
  (assert (equal "弐分の壱" (jp-str/f 1/2 :radix-point "abc")))

  ;; [Float]
  ;; digits-after-dot
  (assert (equal "拾弐・参分四厘" (jp-str/f 12.34 :digits-after-dot nil)))
  (assert (equal "拾弐" (jp-str/f 12.34 :digits-after-dot 0)))
  (assert (equal "拾弐・参分" (jp-str/f 12.34 :digits-after-dot 1)))
  (assert (equal "拾弐・参分四厘" (jp-str/f 12.34 :digits-after-dot 2)))
  (assert (equal "拾弐・参分四厘" (jp-str/f 12.34 :digits-after-dot 3)))
  (assert (equal "拾" (jp-str/f 12.34 :digits-after-dot -1)))
  (assert (equal "〇" (jp-str/f 12.34 :digits-after-dot -2)))
  ;; scale
  (assert (equal "拾弐・参分四厘" (jp-str/f 12.34 :scale nil)))
  (assert (equal "拾弐・参分四厘" (jp-str/f 12.34 :scale 0)))
  (assert (equal "壱百弐拾参・四分" (jp-str/f 12.34 :scale 1)))
  (assert (equal "壱千弐百参拾四" (jp-str/f 12.34 :scale 2)))
  (assert (equal "壱・弐分参厘四毛" (jp-str/f 12.34 :scale -1)))
  (assert (equal "壱分弐厘参毛四糸" (jp-str/f 12.34 :scale -2)))
  ;; radix-point
  (assert (equal "拾弐・参分四厘" (jp-str/f 12.34 :radix-point nil)))
  (assert (equal "拾弐a参分四厘" (jp-str/f 12.34 :radix-point #\a)))
  (assert (equal "拾弐abc参分四厘" (jp-str/f 12.34 :radix-point "abc")))
  (assert (equal "壱千弐百参拾四abc" (jp-str/f 12.34 :radix-point "abc" :scale 2)))
  (assert (equal "〇abc壱分弐厘参毛四糸" (jp-str/f 12.34 :radix-point "abc" :scale -2)))
  ;; 
  t)

(defun test-jp-formal ()
  (and (test-jp-formal-integer-4digits)
       (test-jp-formal-integer-bignums)
       (test-jp-formal-integer-minus)
       (test-jp-formal-rational)
       (test-jp-formal-float)
       (test-jp-formal-fallback)
       (test-jp-formal-parameters)
       t))
