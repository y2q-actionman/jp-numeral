;;; -*- coding: utf-8; -*-

(in-package :jp-numeral.test)

(test test-jp-old-integer-4digits
  ;; 0
  (is (equal "零" (jp-str :old 0)))
  ;; 1-9
  (is (equal "壹" (jp-str :old 1)))
  (is (equal "貳" (jp-str :old 2)))
  (is (equal "參" (jp-str :old 3)))
  (is (equal "肆" (jp-str :old 4)))
  (is (equal "伍" (jp-str :old 5)))
  (is (equal "陸" (jp-str :old 6)))
  (is (equal "柒" (jp-str :old 7)))
  (is (equal "捌" (jp-str :old 8)))
  (is (equal "玖" (jp-str :old 9)))
  ;; 10-19
  (is (equal "拾" (jp-str :old 10)))
  (is (equal "拾壹" (jp-str :old 11)))
  (is (equal "拾貳" (jp-str :old 12)))
  (is (equal "拾參" (jp-str :old 13)))
  (is (equal "拾肆" (jp-str :old 14)))
  (is (equal "拾伍" (jp-str :old 15)))
  (is (equal "拾陸" (jp-str :old 16)))
  (is (equal "拾柒" (jp-str :old 17)))
  (is (equal "拾捌" (jp-str :old 18)))
  (is (equal "拾玖" (jp-str :old 19)))
  ;; 20-99
  (is (equal "貳拾" (jp-str :old 20)))
  (is (equal "貳拾壹" (jp-str :old 21)))
  (is (equal "貳拾玖" (jp-str :old 29)))
  (is (equal "參拾" (jp-str :old 30)))
  (is (equal "參拾壹" (jp-str :old 31)))
  (is (equal "參拾玖" (jp-str :old 39)))
  (is (equal "肆拾" (jp-str :old 40)))
  (is (equal "肆拾壹" (jp-str :old 41)))
  (is (equal "肆拾玖" (jp-str :old 49)))
  (is (equal "伍拾" (jp-str :old 50)))
  (is (equal "伍拾壹" (jp-str :old 51)))
  (is (equal "伍拾玖" (jp-str :old 59)))
  (is (equal "陸拾" (jp-str :old 60)))
  (is (equal "陸拾壹" (jp-str :old 61)))
  (is (equal "陸拾玖" (jp-str :old 69)))
  (is (equal "柒拾" (jp-str :old 70)))
  (is (equal "柒拾壹" (jp-str :old 71)))
  (is (equal "柒拾玖" (jp-str :old 79)))
  (is (equal "捌拾" (jp-str :old 80)))
  (is (equal "捌拾壹" (jp-str :old 81)))
  (is (equal "捌拾玖" (jp-str :old 89)))
  (is (equal "玖拾" (jp-str :old 90)))
  (is (equal "玖拾壹" (jp-str :old 91)))
  (is (equal "玖拾玖" (jp-str :old 99)))
  ;; 100
  (is (equal "壹佰" (jp-str :old 100)))
  ;; 101-109
  (is (equal "壹佰壹" (jp-str :old 101)))
  (is (equal "壹佰貳" (jp-str :old 102)))
  (is (equal "壹佰參" (jp-str :old 103)))
  (is (equal "壹佰肆" (jp-str :old 104)))
  (is (equal "壹佰伍" (jp-str :old 105)))
  (is (equal "壹佰陸" (jp-str :old 106)))
  (is (equal "壹佰柒" (jp-str :old 107)))
  (is (equal "壹佰捌" (jp-str :old 108)))
  (is (equal "壹佰玖" (jp-str :old 109)))
  ;; 110-119
  (is (equal "壹佰拾" (jp-str :old 110)))
  (is (equal "壹佰拾壹" (jp-str :old 111)))
  (is (equal "壹佰拾貳" (jp-str :old 112)))
  (is (equal "壹佰拾參" (jp-str :old 113)))
  (is (equal "壹佰拾肆" (jp-str :old 114)))
  (is (equal "壹佰拾伍" (jp-str :old 115)))
  (is (equal "壹佰拾陸" (jp-str :old 116)))
  (is (equal "壹佰拾柒" (jp-str :old 117)))
  (is (equal "壹佰拾捌" (jp-str :old 118)))
  (is (equal "壹佰拾玖" (jp-str :old 119)))
  ;; 120-199
  (is (equal "壹佰貳拾" (jp-str :old 120)))
  (is (equal "壹佰貳拾壹" (jp-str :old 121)))
  (is (equal "壹佰貳拾玖" (jp-str :old 129)))
  (is (equal "壹佰參拾" (jp-str :old 130)))
  (is (equal "壹佰參拾壹" (jp-str :old 131)))
  (is (equal "壹佰參拾玖" (jp-str :old 139)))
  (is (equal "壹佰肆拾" (jp-str :old 140)))
  (is (equal "壹佰肆拾壹" (jp-str :old 141)))
  (is (equal "壹佰肆拾玖" (jp-str :old 149)))
  (is (equal "壹佰伍拾" (jp-str :old 150)))
  (is (equal "壹佰伍拾壹" (jp-str :old 151)))
  (is (equal "壹佰伍拾玖" (jp-str :old 159)))
  (is (equal "壹佰陸拾" (jp-str :old 160)))
  (is (equal "壹佰陸拾壹" (jp-str :old 161)))
  (is (equal "壹佰陸拾玖" (jp-str :old 169)))
  (is (equal "壹佰柒拾" (jp-str :old 170)))
  (is (equal "壹佰柒拾壹" (jp-str :old 171)))
  (is (equal "壹佰柒拾玖" (jp-str :old 179)))
  (is (equal "壹佰捌拾" (jp-str :old 180)))
  (is (equal "壹佰捌拾壹" (jp-str :old 181)))
  (is (equal "壹佰捌拾玖" (jp-str :old 189)))
  (is (equal "壹佰玖拾" (jp-str :old 190)))
  (is (equal "壹佰玖拾壹" (jp-str :old 191)))
  (is (equal "壹佰玖拾玖" (jp-str :old 199)))
  ;; 200-999
  (is (equal "貳佰" (jp-str :old 200)))
  (is (equal "貳佰壹" (jp-str :old 201)))
  (is (equal "貳佰玖" (jp-str :old 209)))
  (is (equal "貳佰拾" (jp-str :old 210)))
  (is (equal "貳佰拾壹" (jp-str :old 211)))
  (is (equal "貳佰拾玖" (jp-str :old 219)))
  (is (equal "貳佰貳拾" (jp-str :old 220)))
  (is (equal "貳佰貳拾壹" (jp-str :old 221)))
  (is (equal "貳佰玖拾玖" (jp-str :old 299)))
  (is (equal "參佰" (jp-str :old 300)))
  (is (equal "參佰壹" (jp-str :old 301)))
  (is (equal "參佰玖" (jp-str :old 309)))
  (is (equal "參佰拾" (jp-str :old 310)))
  (is (equal "參佰拾壹" (jp-str :old 311)))
  (is (equal "參佰拾玖" (jp-str :old 319)))
  (is (equal "參佰貳拾" (jp-str :old 320)))
  (is (equal "參佰貳拾壹" (jp-str :old 321)))
  (is (equal "參佰玖拾玖" (jp-str :old 399)))
  (is (equal "肆佰" (jp-str :old 400)))
  (is (equal "肆佰壹" (jp-str :old 401)))
  (is (equal "肆佰玖" (jp-str :old 409)))
  (is (equal "肆佰拾" (jp-str :old 410)))
  (is (equal "肆佰拾壹" (jp-str :old 411)))
  (is (equal "肆佰拾玖" (jp-str :old 419)))
  (is (equal "肆佰貳拾" (jp-str :old 420)))
  (is (equal "肆佰貳拾壹" (jp-str :old 421)))
  (is (equal "肆佰玖拾玖" (jp-str :old 499)))
  (is (equal "伍佰" (jp-str :old 500)))
  (is (equal "伍佰壹" (jp-str :old 501)))
  (is (equal "伍佰玖" (jp-str :old 509)))
  (is (equal "伍佰拾" (jp-str :old 510)))
  (is (equal "伍佰拾壹" (jp-str :old 511)))
  (is (equal "伍佰拾玖" (jp-str :old 519)))
  (is (equal "伍佰貳拾" (jp-str :old 520)))
  (is (equal "伍佰貳拾壹" (jp-str :old 521)))
  (is (equal "伍佰玖拾玖" (jp-str :old 599)))
  (is (equal "陸佰" (jp-str :old 600)))
  (is (equal "陸佰壹" (jp-str :old 601)))
  (is (equal "陸佰玖" (jp-str :old 609)))
  (is (equal "陸佰拾" (jp-str :old 610)))
  (is (equal "陸佰拾壹" (jp-str :old 611)))
  (is (equal "陸佰拾玖" (jp-str :old 619)))
  (is (equal "陸佰貳拾" (jp-str :old 620)))
  (is (equal "陸佰貳拾壹" (jp-str :old 621)))
  (is (equal "陸佰玖拾玖" (jp-str :old 699)))
  (is (equal "柒佰" (jp-str :old 700)))
  (is (equal "柒佰壹" (jp-str :old 701)))
  (is (equal "柒佰玖" (jp-str :old 709)))
  (is (equal "柒佰拾" (jp-str :old 710)))
  (is (equal "柒佰拾壹" (jp-str :old 711)))
  (is (equal "柒佰拾玖" (jp-str :old 719)))
  (is (equal "柒佰貳拾" (jp-str :old 720)))
  (is (equal "柒佰貳拾壹" (jp-str :old 721)))
  (is (equal "柒佰玖拾玖" (jp-str :old 799)))
  (is (equal "捌佰" (jp-str :old 800)))
  (is (equal "捌佰壹" (jp-str :old 801)))
  (is (equal "捌佰玖" (jp-str :old 809)))
  (is (equal "捌佰拾" (jp-str :old 810)))
  (is (equal "捌佰拾壹" (jp-str :old 811)))
  (is (equal "捌佰拾玖" (jp-str :old 819)))
  (is (equal "捌佰貳拾" (jp-str :old 820)))
  (is (equal "捌佰貳拾壹" (jp-str :old 821)))
  (is (equal "捌佰玖拾玖" (jp-str :old 899)))
  (is (equal "玖佰" (jp-str :old 900)))
  (is (equal "玖佰壹" (jp-str :old 901)))
  (is (equal "玖佰玖" (jp-str :old 909)))
  (is (equal "玖佰拾" (jp-str :old 910)))
  (is (equal "玖佰拾壹" (jp-str :old 911)))
  (is (equal "玖佰拾玖" (jp-str :old 919)))
  (is (equal "玖佰貳拾" (jp-str :old 920)))
  (is (equal "玖佰貳拾壹" (jp-str :old 921)))
  (is (equal "玖佰玖拾玖" (jp-str :old 999)))
  ;; 1000 - 1099
  (is (equal "壹仟" (jp-str :old 1000)))
  (is (equal "壹仟壹" (jp-str :old 1001)))
  (is (equal "壹仟貳" (jp-str :old 1002)))
  (is (equal "壹仟玖" (jp-str :old 1009)))
  (is (equal "壹仟拾" (jp-str :old 1010)))
  (is (equal "壹仟拾壹" (jp-str :old 1011)))
  (is (equal "壹仟拾玖" (jp-str :old 1019)))
  (is (equal "壹仟貳拾" (jp-str :old 1020)))
  (is (equal "壹仟貳拾壹" (jp-str :old 1021)))
  (is (equal "壹仟貳拾玖" (jp-str :old 1029)))
  (is (equal "壹仟參拾" (jp-str :old 1030)))
  (is (equal "壹仟玖拾玖" (jp-str :old 1099)))
  ;; 1100 - 9999
  (is (equal "壹仟壹佰" (jp-str :old 1100)))
  (is (equal "壹仟壹佰壹" (jp-str :old 1101)))
  (is (equal "壹仟壹佰玖" (jp-str :old 1109)))
  (is (equal "壹仟壹佰拾" (jp-str :old 1110)))
  (is (equal "壹仟壹佰拾壹" (jp-str :old 1111)))
  (is (equal "壹仟壹佰拾玖" (jp-str :old 1119)))
  (is (equal "壹仟壹佰貳拾" (jp-str :old 1120)))
  (is (equal "壹仟壹佰貳拾壹" (jp-str :old 1121)))
  (is (equal "壹仟壹佰貳拾玖" (jp-str :old 1129)))
  (is (equal "壹仟壹佰玖拾玖" (jp-str :old 1199)))
  (is (equal "壹仟貳佰" (jp-str :old 1200)))
  (is (equal "壹仟貳佰壹" (jp-str :old 1201)))
  (is (equal "壹仟貳佰玖" (jp-str :old 1209)))
  (is (equal "壹仟貳佰拾" (jp-str :old 1210)))
  (is (equal "壹仟貳佰拾壹" (jp-str :old 1211)))
  (is (equal "壹仟貳佰拾玖" (jp-str :old 1219)))
  (is (equal "壹仟貳佰貳拾" (jp-str :old 1220)))
  (is (equal "壹仟貳佰貳拾壹" (jp-str :old 1221)))
  (is (equal "壹仟貳佰貳拾玖" (jp-str :old 1229)))
  (is (equal "壹仟貳佰玖拾玖" (jp-str :old 1299)))
  (is (equal "壹仟玖佰" (jp-str :old 1900)))
  (is (equal "壹仟玖佰壹" (jp-str :old 1901)))
  (is (equal "壹仟玖佰玖" (jp-str :old 1909)))
  (is (equal "壹仟玖佰拾" (jp-str :old 1910)))
  (is (equal "壹仟玖佰拾壹" (jp-str :old 1911)))
  (is (equal "壹仟玖佰拾玖" (jp-str :old 1919)))
  (is (equal "壹仟玖佰貳拾" (jp-str :old 1920)))
  (is (equal "壹仟玖佰貳拾壹" (jp-str :old 1921)))
  (is (equal "壹仟玖佰貳拾玖" (jp-str :old 1929)))
  (is (equal "壹仟玖佰玖拾玖" (jp-str :old 1999)))
  ;; 2000 - 9999
  (is (equal "貳仟" (jp-str :old 2000)))
  (is (equal "貳仟壹" (jp-str :old 2001)))
  (is (equal "貳仟拾" (jp-str :old 2010)))
  (is (equal "貳仟拾壹" (jp-str :old 2011)))
  (is (equal "貳仟貳拾" (jp-str :old 2020)))
  (is (equal "貳仟貳拾壹" (jp-str :old 2021)))
  (is (equal "貳仟壹佰" (jp-str :old 2100)))
  (is (equal "貳仟壹佰壹" (jp-str :old 2101)))
  (is (equal "貳仟壹佰拾" (jp-str :old 2110)))
  (is (equal "貳仟壹佰拾壹" (jp-str :old 2111)))
  (is (equal "貳仟壹佰貳拾" (jp-str :old 2120)))
  (is (equal "貳仟壹佰貳拾壹" (jp-str :old 2121)))
  (is (equal "貳仟貳佰" (jp-str :old 2200)))
  (is (equal "貳仟貳佰壹" (jp-str :old 2201)))
  (is (equal "貳仟貳佰拾" (jp-str :old 2210)))
  (is (equal "貳仟貳佰拾壹" (jp-str :old 2211)))
  (is (equal "貳仟貳佰貳拾" (jp-str :old 2220)))
  (is (equal "貳仟貳佰貳拾壹" (jp-str :old 2221)))
  (is (equal "參仟" (jp-str :old 3000)))
  (is (equal "參仟壹" (jp-str :old 3001)))
  (is (equal "參仟拾" (jp-str :old 3010)))
  (is (equal "參仟拾壹" (jp-str :old 3011)))
  (is (equal "參仟貳拾" (jp-str :old 3020)))
  (is (equal "參仟貳拾壹" (jp-str :old 3021)))
  (is (equal "參仟壹佰" (jp-str :old 3100)))
  (is (equal "參仟壹佰壹" (jp-str :old 3101)))
  (is (equal "參仟壹佰拾" (jp-str :old 3110)))
  (is (equal "參仟壹佰拾壹" (jp-str :old 3111)))
  (is (equal "參仟壹佰貳拾" (jp-str :old 3120)))
  (is (equal "參仟壹佰貳拾壹" (jp-str :old 3121)))
  (is (equal "參仟貳佰" (jp-str :old 3200)))
  (is (equal "參仟貳佰壹" (jp-str :old 3201)))
  (is (equal "參仟貳佰拾" (jp-str :old 3210)))
  (is (equal "參仟貳佰拾壹" (jp-str :old 3211)))
  (is (equal "參仟貳佰貳拾" (jp-str :old 3220)))
  (is (equal "參仟貳佰貳拾壹" (jp-str :old 3221)))
  (is (equal "肆仟" (jp-str :old 4000)))
  (is (equal "肆仟壹" (jp-str :old 4001)))
  (is (equal "肆仟拾" (jp-str :old 4010)))
  (is (equal "肆仟拾壹" (jp-str :old 4011)))
  (is (equal "肆仟貳拾" (jp-str :old 4020)))
  (is (equal "肆仟貳拾壹" (jp-str :old 4021)))
  (is (equal "肆仟壹佰" (jp-str :old 4100)))
  (is (equal "肆仟壹佰壹" (jp-str :old 4101)))
  (is (equal "肆仟壹佰拾" (jp-str :old 4110)))
  (is (equal "肆仟壹佰拾壹" (jp-str :old 4111)))
  (is (equal "肆仟壹佰貳拾" (jp-str :old 4120)))
  (is (equal "肆仟壹佰貳拾壹" (jp-str :old 4121)))
  (is (equal "肆仟貳佰" (jp-str :old 4200)))
  (is (equal "肆仟貳佰壹" (jp-str :old 4201)))
  (is (equal "肆仟貳佰拾" (jp-str :old 4210)))
  (is (equal "肆仟貳佰拾壹" (jp-str :old 4211)))
  (is (equal "肆仟貳佰貳拾" (jp-str :old 4220)))
  (is (equal "肆仟貳佰貳拾壹" (jp-str :old 4221)))
  (is (equal "伍仟" (jp-str :old 5000)))
  (is (equal "伍仟壹" (jp-str :old 5001)))
  (is (equal "伍仟拾" (jp-str :old 5010)))
  (is (equal "伍仟拾壹" (jp-str :old 5011)))
  (is (equal "伍仟貳拾" (jp-str :old 5020)))
  (is (equal "伍仟貳拾壹" (jp-str :old 5021)))
  (is (equal "伍仟壹佰" (jp-str :old 5100)))
  (is (equal "伍仟壹佰壹" (jp-str :old 5101)))
  (is (equal "伍仟壹佰拾" (jp-str :old 5110)))
  (is (equal "伍仟壹佰拾壹" (jp-str :old 5111)))
  (is (equal "伍仟壹佰貳拾" (jp-str :old 5120)))
  (is (equal "伍仟壹佰貳拾壹" (jp-str :old 5121)))
  (is (equal "伍仟貳佰" (jp-str :old 5200)))
  (is (equal "伍仟貳佰壹" (jp-str :old 5201)))
  (is (equal "伍仟貳佰拾" (jp-str :old 5210)))
  (is (equal "伍仟貳佰拾壹" (jp-str :old 5211)))
  (is (equal "伍仟貳佰貳拾" (jp-str :old 5220)))
  (is (equal "伍仟貳佰貳拾壹" (jp-str :old 5221)))
  (is (equal "陸仟" (jp-str :old 6000)))
  (is (equal "陸仟壹" (jp-str :old 6001)))
  (is (equal "陸仟拾" (jp-str :old 6010)))
  (is (equal "陸仟拾壹" (jp-str :old 6011)))
  (is (equal "陸仟貳拾" (jp-str :old 6020)))
  (is (equal "陸仟貳拾壹" (jp-str :old 6021)))
  (is (equal "陸仟壹佰" (jp-str :old 6100)))
  (is (equal "陸仟壹佰壹" (jp-str :old 6101)))
  (is (equal "陸仟壹佰拾" (jp-str :old 6110)))
  (is (equal "陸仟壹佰拾壹" (jp-str :old 6111)))
  (is (equal "陸仟壹佰貳拾" (jp-str :old 6120)))
  (is (equal "陸仟壹佰貳拾壹" (jp-str :old 6121)))
  (is (equal "陸仟貳佰" (jp-str :old 6200)))
  (is (equal "陸仟貳佰壹" (jp-str :old 6201)))
  (is (equal "陸仟貳佰拾" (jp-str :old 6210)))
  (is (equal "陸仟貳佰拾壹" (jp-str :old 6211)))
  (is (equal "陸仟貳佰貳拾" (jp-str :old 6220)))
  (is (equal "陸仟貳佰貳拾壹" (jp-str :old 6221)))
  (is (equal "柒仟" (jp-str :old 7000)))
  (is (equal "柒仟壹" (jp-str :old 7001)))
  (is (equal "柒仟拾" (jp-str :old 7010)))
  (is (equal "柒仟拾壹" (jp-str :old 7011)))
  (is (equal "柒仟貳拾" (jp-str :old 7020)))
  (is (equal "柒仟貳拾壹" (jp-str :old 7021)))
  (is (equal "柒仟壹佰" (jp-str :old 7100)))
  (is (equal "柒仟壹佰壹" (jp-str :old 7101)))
  (is (equal "柒仟壹佰拾" (jp-str :old 7110)))
  (is (equal "柒仟壹佰拾壹" (jp-str :old 7111)))
  (is (equal "柒仟壹佰貳拾" (jp-str :old 7120)))
  (is (equal "柒仟壹佰貳拾壹" (jp-str :old 7121)))
  (is (equal "柒仟貳佰" (jp-str :old 7200)))
  (is (equal "柒仟貳佰壹" (jp-str :old 7201)))
  (is (equal "柒仟貳佰拾" (jp-str :old 7210)))
  (is (equal "柒仟貳佰拾壹" (jp-str :old 7211)))
  (is (equal "柒仟貳佰貳拾" (jp-str :old 7220)))
  (is (equal "柒仟貳佰貳拾壹" (jp-str :old 7221)))
  (is (equal "捌仟" (jp-str :old 8000)))
  (is (equal "捌仟壹" (jp-str :old 8001)))
  (is (equal "捌仟拾" (jp-str :old 8010)))
  (is (equal "捌仟拾壹" (jp-str :old 8011)))
  (is (equal "捌仟貳拾" (jp-str :old 8020)))
  (is (equal "捌仟貳拾壹" (jp-str :old 8021)))
  (is (equal "捌仟壹佰" (jp-str :old 8100)))
  (is (equal "捌仟壹佰壹" (jp-str :old 8101)))
  (is (equal "捌仟壹佰拾" (jp-str :old 8110)))
  (is (equal "捌仟壹佰拾壹" (jp-str :old 8111)))
  (is (equal "捌仟壹佰貳拾" (jp-str :old 8120)))
  (is (equal "捌仟壹佰貳拾壹" (jp-str :old 8121)))
  (is (equal "捌仟貳佰" (jp-str :old 8200)))
  (is (equal "捌仟貳佰壹" (jp-str :old 8201)))
  (is (equal "捌仟貳佰拾" (jp-str :old 8210)))
  (is (equal "捌仟貳佰拾壹" (jp-str :old 8211)))
  (is (equal "捌仟貳佰貳拾" (jp-str :old 8220)))
  (is (equal "捌仟貳佰貳拾壹" (jp-str :old 8221)))
  (is (equal "玖仟" (jp-str :old 9000)))
  (is (equal "玖仟壹" (jp-str :old 9001)))
  (is (equal "玖仟拾" (jp-str :old 9010)))
  (is (equal "玖仟拾壹" (jp-str :old 9011)))
  (is (equal "玖仟貳拾" (jp-str :old 9020)))
  (is (equal "玖仟貳拾壹" (jp-str :old 9021)))
  (is (equal "玖仟壹佰" (jp-str :old 9100)))
  (is (equal "玖仟壹佰壹" (jp-str :old 9101)))
  (is (equal "玖仟壹佰拾" (jp-str :old 9110)))
  (is (equal "玖仟壹佰拾壹" (jp-str :old 9111)))
  (is (equal "玖仟壹佰貳拾" (jp-str :old 9120)))
  (is (equal "玖仟壹佰貳拾壹" (jp-str :old 9121)))
  (is (equal "玖仟貳佰" (jp-str :old 9200)))
  (is (equal "玖仟貳佰壹" (jp-str :old 9201)))
  (is (equal "玖仟貳佰拾" (jp-str :old 9210)))
  (is (equal "玖仟貳佰拾壹" (jp-str :old 9211)))
  (is (equal "玖仟貳佰貳拾" (jp-str :old 9220)))
  (is (equal "玖仟貳佰貳拾壹" (jp-str :old 9221)))
  (is (equal "玖仟玖佰玖拾玖" (jp-str :old 9999)))
  ;; 
  t)

(test test-jp-old-integer-bignums
  ;; 10000 - 19999
  (is (equal "壹萬" (jp-str :old 10000)))
  (is (equal "壹萬壹" (jp-str :old 10001)))
  (is (equal "壹萬玖" (jp-str :old 10009)))
  (is (equal "壹萬拾" (jp-str :old 10010)))
  (is (equal "壹萬拾壹" (jp-str :old 10011)))
  (is (equal "壹萬拾玖" (jp-str :old 10019)))
  (is (equal "壹萬貳拾" (jp-str :old 10020)))
  (is (equal "壹萬貳拾壹" (jp-str :old 10021)))
  (is (equal "壹萬貳拾玖" (jp-str :old 10029)))
  (is (equal "壹萬壹佰" (jp-str :old 10100)))
  (is (equal "壹萬壹佰壹" (jp-str :old 10101)))
  (is (equal "壹萬壹佰玖" (jp-str :old 10109)))
  (is (equal "壹萬壹佰拾" (jp-str :old 10110)))
  (is (equal "壹萬壹佰拾壹" (jp-str :old 10111)))
  (is (equal "壹萬壹佰拾玖" (jp-str :old 10119)))
  (is (equal "壹萬壹佰貳拾" (jp-str :old 10120)))
  (is (equal "壹萬壹佰貳拾壹" (jp-str :old 10121)))
  (is (equal "壹萬壹佰貳拾玖" (jp-str :old 10129)))
  (is (equal "壹萬貳佰" (jp-str :old 10200)))
  (is (equal "壹萬貳佰壹" (jp-str :old 10201)))
  (is (equal "壹萬貳佰玖" (jp-str :old 10209)))
  (is (equal "壹萬貳佰拾" (jp-str :old 10210)))
  (is (equal "壹萬貳佰拾壹" (jp-str :old 10211)))
  (is (equal "壹萬貳佰拾玖" (jp-str :old 10219)))
  (is (equal "壹萬貳佰貳拾" (jp-str :old 10220)))
  (is (equal "壹萬貳佰貳拾壹" (jp-str :old 10221)))
  (is (equal "壹萬貳佰貳拾玖" (jp-str :old 10229)))
  (is (equal "壹萬壹仟" (jp-str :old 11000)))
  (is (equal "壹萬壹仟壹" (jp-str :old 11001)))
  (is (equal "壹萬壹仟玖" (jp-str :old 11009)))
  (is (equal "壹萬壹仟拾" (jp-str :old 11010)))
  (is (equal "壹萬壹仟拾壹" (jp-str :old 11011)))
  (is (equal "壹萬壹仟拾玖" (jp-str :old 11019)))
  (is (equal "壹萬壹仟貳拾" (jp-str :old 11020)))
  (is (equal "壹萬壹仟貳拾壹" (jp-str :old 11021)))
  (is (equal "壹萬壹仟貳拾玖" (jp-str :old 11029)))
  (is (equal "壹萬壹仟壹佰" (jp-str :old 11100)))
  (is (equal "壹萬壹仟壹佰壹" (jp-str :old 11101)))
  (is (equal "壹萬壹仟壹佰玖" (jp-str :old 11109)))
  (is (equal "壹萬壹仟壹佰拾" (jp-str :old 11110)))
  (is (equal "壹萬壹仟壹佰拾壹" (jp-str :old 11111)))
  (is (equal "壹萬壹仟壹佰拾玖" (jp-str :old 11119)))
  (is (equal "壹萬壹仟壹佰貳拾" (jp-str :old 11120)))
  (is (equal "壹萬壹仟壹佰貳拾壹" (jp-str :old 11121)))
  (is (equal "壹萬壹仟壹佰貳拾玖" (jp-str :old 11129)))
  (is (equal "壹萬壹仟貳佰" (jp-str :old 11200)))
  (is (equal "壹萬壹仟貳佰壹" (jp-str :old 11201)))
  (is (equal "壹萬壹仟貳佰玖" (jp-str :old 11209)))
  (is (equal "壹萬壹仟貳佰拾" (jp-str :old 11210)))
  (is (equal "壹萬壹仟貳佰拾壹" (jp-str :old 11211)))
  (is (equal "壹萬壹仟貳佰拾玖" (jp-str :old 11219)))
  (is (equal "壹萬壹仟貳佰貳拾" (jp-str :old 11220)))
  (is (equal "壹萬壹仟貳佰貳拾壹" (jp-str :old 11221)))
  (is (equal "壹萬壹仟貳佰貳拾玖" (jp-str :old 11229)))
  (is (equal "壹萬貳仟" (jp-str :old 12000)))
  (is (equal "壹萬貳仟壹" (jp-str :old 12001)))
  (is (equal "壹萬貳仟玖" (jp-str :old 12009)))
  (is (equal "壹萬貳仟拾" (jp-str :old 12010)))
  (is (equal "壹萬貳仟拾壹" (jp-str :old 12011)))
  (is (equal "壹萬貳仟拾玖" (jp-str :old 12019)))
  (is (equal "壹萬貳仟貳拾" (jp-str :old 12020)))
  (is (equal "壹萬貳仟貳拾壹" (jp-str :old 12021)))
  (is (equal "壹萬貳仟貳拾玖" (jp-str :old 12029)))
  (is (equal "壹萬貳仟壹佰" (jp-str :old 12100)))
  (is (equal "壹萬貳仟壹佰壹" (jp-str :old 12101)))
  (is (equal "壹萬貳仟壹佰玖" (jp-str :old 12109)))
  (is (equal "壹萬貳仟壹佰拾" (jp-str :old 12110)))
  (is (equal "壹萬貳仟壹佰拾壹" (jp-str :old 12111)))
  (is (equal "壹萬貳仟壹佰拾玖" (jp-str :old 12119)))
  (is (equal "壹萬貳仟壹佰貳拾" (jp-str :old 12120)))
  (is (equal "壹萬貳仟壹佰貳拾壹" (jp-str :old 12121)))
  (is (equal "壹萬貳仟壹佰貳拾玖" (jp-str :old 12129)))
  (is (equal "壹萬貳仟貳佰" (jp-str :old 12200)))
  (is (equal "壹萬貳仟貳佰壹" (jp-str :old 12201)))
  (is (equal "壹萬貳仟貳佰玖" (jp-str :old 12209)))
  (is (equal "壹萬貳仟貳佰拾" (jp-str :old 12210)))
  (is (equal "壹萬貳仟貳佰拾壹" (jp-str :old 12211)))
  (is (equal "壹萬貳仟貳佰拾玖" (jp-str :old 12219)))
  (is (equal "壹萬貳仟貳佰貳拾" (jp-str :old 12220)))
  (is (equal "壹萬貳仟貳佰貳拾壹" (jp-str :old 12221)))
  (is (equal "壹萬貳仟貳佰貳拾玖" (jp-str :old 12229)))
  (is (equal "壹萬玖仟玖佰玖拾玖" (jp-str :old 19999)))
  ;; 20000 - 99990000
  (is (equal "貳萬" (jp-str :old 20000)))
  (is (equal "玖萬" (jp-str :old 90000)))
  (is (equal "拾萬" (jp-str :old 100000)))
  (is (equal "拾壹萬" (jp-str :old 110000)))
  (is (equal "拾玖萬" (jp-str :old 190000)))
  (is (equal "貳拾萬" (jp-str :old 200000)))
  (is (equal "貳拾壹萬" (jp-str :old 210000)))
  (is (equal "貳拾玖萬" (jp-str :old 290000)))
  (is (equal "壹佰萬" (jp-str :old 1000000)))
  (is (equal "壹佰壹萬" (jp-str :old 1010000)))
  (is (equal "壹佰玖萬" (jp-str :old 1090000)))
  (is (equal "壹佰拾萬" (jp-str :old 1100000)))
  (is (equal "壹佰拾壹萬" (jp-str :old 1110000)))
  (is (equal "壹佰拾玖萬" (jp-str :old 1190000)))
  (is (equal "壹佰貳拾萬" (jp-str :old 1200000)))
  (is (equal "壹佰貳拾壹萬" (jp-str :old 1210000)))
  (is (equal "壹佰貳拾玖萬" (jp-str :old 1290000)))
  (is (equal "貳佰萬" (jp-str :old 2000000)))
  (is (equal "貳佰壹萬" (jp-str :old 2010000)))
  (is (equal "貳佰玖萬" (jp-str :old 2090000)))
  (is (equal "貳佰拾萬" (jp-str :old 2100000)))
  (is (equal "貳佰拾壹萬" (jp-str :old 2110000)))
  (is (equal "貳佰拾玖萬" (jp-str :old 2190000)))
  (is (equal "貳佰貳拾萬" (jp-str :old 2200000)))
  (is (equal "貳佰貳拾壹萬" (jp-str :old 2210000)))
  (is (equal "貳佰貳拾玖萬" (jp-str :old 2290000)))
  (is (equal "壹仟萬" (jp-str :old 10000000)))
  (is (equal "壹仟壹萬" (jp-str :old 10010000)))
  (is (equal "壹仟玖萬" (jp-str :old 10090000)))
  (is (equal "壹仟拾萬" (jp-str :old 10100000)))
  (is (equal "壹仟拾壹萬" (jp-str :old 10110000)))
  (is (equal "壹仟拾玖萬" (jp-str :old 10190000)))
  (is (equal "壹仟貳拾萬" (jp-str :old 10200000)))
  (is (equal "壹仟貳拾壹萬" (jp-str :old 10210000)))
  (is (equal "壹仟貳拾玖萬" (jp-str :old 10290000)))
  (is (equal "壹仟壹佰萬" (jp-str :old 11000000)))
  (is (equal "壹仟壹佰壹萬" (jp-str :old 11010000)))
  (is (equal "壹仟壹佰玖萬" (jp-str :old 11090000)))
  (is (equal "壹仟壹佰拾萬" (jp-str :old 11100000)))
  (is (equal "壹仟壹佰拾壹萬" (jp-str :old 11110000)))
  (is (equal "壹仟壹佰拾玖萬" (jp-str :old 11190000)))
  (is (equal "壹仟壹佰貳拾萬" (jp-str :old 11200000)))
  (is (equal "壹仟壹佰貳拾壹萬" (jp-str :old 11210000)))
  (is (equal "壹仟壹佰貳拾玖萬" (jp-str :old 11290000)))
  (is (equal "壹仟貳佰萬" (jp-str :old 12000000)))
  (is (equal "壹仟貳佰壹萬" (jp-str :old 12010000)))
  (is (equal "壹仟貳佰玖萬" (jp-str :old 12090000)))
  (is (equal "壹仟貳佰拾萬" (jp-str :old 12100000)))
  (is (equal "壹仟貳佰拾壹萬" (jp-str :old 12110000)))
  (is (equal "壹仟貳佰拾玖萬" (jp-str :old 12190000)))
  (is (equal "壹仟貳佰貳拾萬" (jp-str :old 12200000)))
  (is (equal "壹仟貳佰貳拾壹萬" (jp-str :old 12210000)))
  (is (equal "壹仟貳佰貳拾玖萬" (jp-str :old 12290000)))
  (is (equal "貳仟萬" (jp-str :old 20000000)))
  (is (equal "貳仟壹萬" (jp-str :old 20010000)))
  (is (equal "貳仟玖萬" (jp-str :old 20090000)))
  (is (equal "貳仟拾萬" (jp-str :old 20100000)))
  (is (equal "貳仟拾壹萬" (jp-str :old 20110000)))
  (is (equal "貳仟拾玖萬" (jp-str :old 20190000)))
  (is (equal "貳仟貳拾萬" (jp-str :old 20200000)))
  (is (equal "貳仟貳拾壹萬" (jp-str :old 20210000)))
  (is (equal "貳仟貳拾玖萬" (jp-str :old 20290000)))
  (is (equal "貳仟壹佰萬" (jp-str :old 21000000)))
  (is (equal "貳仟壹佰壹萬" (jp-str :old 21010000)))
  (is (equal "貳仟壹佰玖萬" (jp-str :old 21090000)))
  (is (equal "貳仟壹佰拾萬" (jp-str :old 21100000)))
  (is (equal "貳仟壹佰拾壹萬" (jp-str :old 21110000)))
  (is (equal "貳仟壹佰拾玖萬" (jp-str :old 21190000)))
  (is (equal "貳仟壹佰貳拾萬" (jp-str :old 21200000)))
  (is (equal "貳仟壹佰貳拾壹萬" (jp-str :old 21210000)))
  (is (equal "貳仟壹佰貳拾玖萬" (jp-str :old 21290000)))
  (is (equal "貳仟貳佰萬" (jp-str :old 22000000)))
  (is (equal "貳仟貳佰壹萬" (jp-str :old 22010000)))
  (is (equal "貳仟貳佰玖萬" (jp-str :old 22090000)))
  (is (equal "貳仟貳佰拾萬" (jp-str :old 22100000)))
  (is (equal "貳仟貳佰拾壹萬" (jp-str :old 22110000)))
  (is (equal "貳仟貳佰拾玖萬" (jp-str :old 22190000)))
  (is (equal "貳仟貳佰貳拾萬" (jp-str :old 22200000)))
  (is (equal "貳仟貳佰貳拾壹萬" (jp-str :old 22210000)))
  (is (equal "貳仟貳佰貳拾玖萬" (jp-str :old 22290000)))
  (is (equal "玖仟玖佰玖拾玖萬" (jp-str :old 99990000)))
  ;; 100000000 - 100009999
  (is (equal "壹億" (jp-str :old 100000000)))
  (is (equal "壹億壹" (jp-str :old 100000001)))
  (is (equal "壹億玖" (jp-str :old 100000009)))
  (is (equal "壹億拾" (jp-str :old 100000010)))
  (is (equal "壹億拾壹" (jp-str :old 100000011)))
  (is (equal "壹億拾玖" (jp-str :old 100000019)))
  (is (equal "壹億貳拾" (jp-str :old 100000020)))
  (is (equal "壹億貳拾壹" (jp-str :old 100000021)))
  (is (equal "壹億貳拾玖" (jp-str :old 100000029)))
  (is (equal "壹億壹佰" (jp-str :old 100000100)))
  (is (equal "壹億壹佰壹" (jp-str :old 100000101)))
  (is (equal "壹億壹佰玖" (jp-str :old 100000109)))
  (is (equal "壹億壹佰拾" (jp-str :old 100000110)))
  (is (equal "壹億壹佰拾壹" (jp-str :old 100000111)))
  (is (equal "壹億壹佰拾玖" (jp-str :old 100000119)))
  (is (equal "壹億壹佰貳拾" (jp-str :old 100000120)))
  (is (equal "壹億壹佰貳拾壹" (jp-str :old 100000121)))
  (is (equal "壹億壹佰貳拾玖" (jp-str :old 100000129)))
  (is (equal "壹億貳佰" (jp-str :old 100000200)))
  (is (equal "壹億貳佰壹" (jp-str :old 100000201)))
  (is (equal "壹億貳佰玖" (jp-str :old 100000209)))
  (is (equal "壹億貳佰拾" (jp-str :old 100000210)))
  (is (equal "壹億貳佰拾壹" (jp-str :old 100000211)))
  (is (equal "壹億貳佰拾玖" (jp-str :old 100000219)))
  (is (equal "壹億貳佰貳拾" (jp-str :old 100000220)))
  (is (equal "壹億貳佰貳拾壹" (jp-str :old 100000221)))
  (is (equal "壹億貳佰貳拾玖" (jp-str :old 100000229)))
  (is (equal "壹億壹仟" (jp-str :old 100001000)))
  (is (equal "壹億壹仟壹" (jp-str :old 100001001)))
  (is (equal "壹億壹仟玖" (jp-str :old 100001009)))
  (is (equal "壹億壹仟拾" (jp-str :old 100001010)))
  (is (equal "壹億壹仟拾壹" (jp-str :old 100001011)))
  (is (equal "壹億壹仟拾玖" (jp-str :old 100001019)))
  (is (equal "壹億壹仟貳拾" (jp-str :old 100001020)))
  (is (equal "壹億壹仟貳拾壹" (jp-str :old 100001021)))
  (is (equal "壹億壹仟貳拾玖" (jp-str :old 100001029)))
  (is (equal "壹億壹仟壹佰" (jp-str :old 100001100)))
  (is (equal "壹億壹仟壹佰壹" (jp-str :old 100001101)))
  (is (equal "壹億壹仟壹佰玖" (jp-str :old 100001109)))
  (is (equal "壹億壹仟壹佰拾" (jp-str :old 100001110)))
  (is (equal "壹億壹仟壹佰拾壹" (jp-str :old 100001111)))
  (is (equal "壹億壹仟壹佰拾玖" (jp-str :old 100001119)))
  (is (equal "壹億壹仟壹佰貳拾" (jp-str :old 100001120)))
  (is (equal "壹億壹仟壹佰貳拾壹" (jp-str :old 100001121)))
  (is (equal "壹億壹仟壹佰貳拾玖" (jp-str :old 100001129)))
  (is (equal "壹億壹仟貳佰" (jp-str :old 100001200)))
  (is (equal "壹億壹仟貳佰壹" (jp-str :old 100001201)))
  (is (equal "壹億壹仟貳佰玖" (jp-str :old 100001209)))
  (is (equal "壹億壹仟貳佰拾" (jp-str :old 100001210)))
  (is (equal "壹億壹仟貳佰拾壹" (jp-str :old 100001211)))
  (is (equal "壹億壹仟貳佰拾玖" (jp-str :old 100001219)))
  (is (equal "壹億壹仟貳佰貳拾" (jp-str :old 100001220)))
  (is (equal "壹億壹仟貳佰貳拾壹" (jp-str :old 100001221)))
  (is (equal "壹億壹仟貳佰貳拾玖" (jp-str :old 100001229)))
  (is (equal "壹億貳仟" (jp-str :old 100002000)))
  (is (equal "壹億貳仟壹" (jp-str :old 100002001)))
  (is (equal "壹億貳仟玖" (jp-str :old 100002009)))
  (is (equal "壹億貳仟拾" (jp-str :old 100002010)))
  (is (equal "壹億貳仟拾壹" (jp-str :old 100002011)))
  (is (equal "壹億貳仟拾玖" (jp-str :old 100002019)))
  (is (equal "壹億貳仟貳拾" (jp-str :old 100002020)))
  (is (equal "壹億貳仟貳拾壹" (jp-str :old 100002021)))
  (is (equal "壹億貳仟貳拾玖" (jp-str :old 100002029)))
  (is (equal "壹億貳仟壹佰" (jp-str :old 100002100)))
  (is (equal "壹億貳仟壹佰壹" (jp-str :old 100002101)))
  (is (equal "壹億貳仟壹佰玖" (jp-str :old 100002109)))
  (is (equal "壹億貳仟壹佰拾" (jp-str :old 100002110)))
  (is (equal "壹億貳仟壹佰拾壹" (jp-str :old 100002111)))
  (is (equal "壹億貳仟壹佰拾玖" (jp-str :old 100002119)))
  (is (equal "壹億貳仟壹佰貳拾" (jp-str :old 100002120)))
  (is (equal "壹億貳仟壹佰貳拾壹" (jp-str :old 100002121)))
  (is (equal "壹億貳仟壹佰貳拾玖" (jp-str :old 100002129)))
  (is (equal "壹億貳仟貳佰" (jp-str :old 100002200)))
  (is (equal "壹億貳仟貳佰壹" (jp-str :old 100002201)))
  (is (equal "壹億貳仟貳佰玖" (jp-str :old 100002209)))
  (is (equal "壹億貳仟貳佰拾" (jp-str :old 100002210)))
  (is (equal "壹億貳仟貳佰拾壹" (jp-str :old 100002211)))
  (is (equal "壹億貳仟貳佰拾玖" (jp-str :old 100002219)))
  (is (equal "壹億貳仟貳佰貳拾" (jp-str :old 100002220)))
  (is (equal "壹億貳仟貳佰貳拾壹" (jp-str :old 100002221)))
  (is (equal "壹億貳仟貳佰貳拾玖" (jp-str :old 100002229)))
  (is (equal "壹億玖仟玖佰玖拾玖" (jp-str :old 100009999)))
  ;; 100010000 - 100019999
  (is (equal "壹億壹萬" (jp-str :old 100010000)))
  (is (equal "壹億壹萬壹" (jp-str :old 100010001)))
  (is (equal "壹億壹萬玖" (jp-str :old 100010009)))
  (is (equal "壹億壹萬拾" (jp-str :old 100010010)))
  (is (equal "壹億壹萬拾壹" (jp-str :old 100010011)))
  (is (equal "壹億壹萬拾玖" (jp-str :old 100010019)))
  (is (equal "壹億壹萬貳拾" (jp-str :old 100010020)))
  (is (equal "壹億壹萬貳拾壹" (jp-str :old 100010021)))
  (is (equal "壹億壹萬貳拾玖" (jp-str :old 100010029)))
  (is (equal "壹億壹萬壹佰" (jp-str :old 100010100)))
  (is (equal "壹億壹萬壹佰壹" (jp-str :old 100010101)))
  (is (equal "壹億壹萬壹佰玖" (jp-str :old 100010109)))
  (is (equal "壹億壹萬壹佰拾" (jp-str :old 100010110)))
  (is (equal "壹億壹萬壹佰拾壹" (jp-str :old 100010111)))
  (is (equal "壹億壹萬壹佰拾玖" (jp-str :old 100010119)))
  (is (equal "壹億壹萬壹佰貳拾" (jp-str :old 100010120)))
  (is (equal "壹億壹萬壹佰貳拾壹" (jp-str :old 100010121)))
  (is (equal "壹億壹萬壹佰貳拾玖" (jp-str :old 100010129)))
  (is (equal "壹億壹萬貳佰" (jp-str :old 100010200)))
  (is (equal "壹億壹萬貳佰壹" (jp-str :old 100010201)))
  (is (equal "壹億壹萬貳佰玖" (jp-str :old 100010209)))
  (is (equal "壹億壹萬貳佰拾" (jp-str :old 100010210)))
  (is (equal "壹億壹萬貳佰拾壹" (jp-str :old 100010211)))
  (is (equal "壹億壹萬貳佰拾玖" (jp-str :old 100010219)))
  (is (equal "壹億壹萬貳佰貳拾" (jp-str :old 100010220)))
  (is (equal "壹億壹萬貳佰貳拾壹" (jp-str :old 100010221)))
  (is (equal "壹億壹萬貳佰貳拾玖" (jp-str :old 100010229)))
  (is (equal "壹億壹萬壹仟" (jp-str :old 100011000)))
  (is (equal "壹億壹萬壹仟壹" (jp-str :old 100011001)))
  (is (equal "壹億壹萬壹仟玖" (jp-str :old 100011009)))
  (is (equal "壹億壹萬壹仟拾" (jp-str :old 100011010)))
  (is (equal "壹億壹萬壹仟拾壹" (jp-str :old 100011011)))
  (is (equal "壹億壹萬壹仟拾玖" (jp-str :old 100011019)))
  (is (equal "壹億壹萬壹仟貳拾" (jp-str :old 100011020)))
  (is (equal "壹億壹萬壹仟貳拾壹" (jp-str :old 100011021)))
  (is (equal "壹億壹萬壹仟貳拾玖" (jp-str :old 100011029)))
  (is (equal "壹億壹萬壹仟壹佰" (jp-str :old 100011100)))
  (is (equal "壹億壹萬壹仟壹佰壹" (jp-str :old 100011101)))
  (is (equal "壹億壹萬壹仟壹佰玖" (jp-str :old 100011109)))
  (is (equal "壹億壹萬壹仟壹佰拾" (jp-str :old 100011110)))
  (is (equal "壹億壹萬壹仟壹佰拾壹" (jp-str :old 100011111)))
  (is (equal "壹億壹萬壹仟壹佰拾玖" (jp-str :old 100011119)))
  (is (equal "壹億壹萬壹仟壹佰貳拾" (jp-str :old 100011120)))
  (is (equal "壹億壹萬壹仟壹佰貳拾壹" (jp-str :old 100011121)))
  (is (equal "壹億壹萬壹仟壹佰貳拾玖" (jp-str :old 100011129)))
  (is (equal "壹億壹萬壹仟貳佰" (jp-str :old 100011200)))
  (is (equal "壹億壹萬壹仟貳佰壹" (jp-str :old 100011201)))
  (is (equal "壹億壹萬壹仟貳佰玖" (jp-str :old 100011209)))
  (is (equal "壹億壹萬壹仟貳佰拾" (jp-str :old 100011210)))
  (is (equal "壹億壹萬壹仟貳佰拾壹" (jp-str :old 100011211)))
  (is (equal "壹億壹萬壹仟貳佰拾玖" (jp-str :old 100011219)))
  (is (equal "壹億壹萬壹仟貳佰貳拾" (jp-str :old 100011220)))
  (is (equal "壹億壹萬壹仟貳佰貳拾壹" (jp-str :old 100011221)))
  (is (equal "壹億壹萬壹仟貳佰貳拾玖" (jp-str :old 100011229)))
  (is (equal "壹億壹萬貳仟" (jp-str :old 100012000)))
  (is (equal "壹億壹萬貳仟壹" (jp-str :old 100012001)))
  (is (equal "壹億壹萬貳仟玖" (jp-str :old 100012009)))
  (is (equal "壹億壹萬貳仟拾" (jp-str :old 100012010)))
  (is (equal "壹億壹萬貳仟拾壹" (jp-str :old 100012011)))
  (is (equal "壹億壹萬貳仟拾玖" (jp-str :old 100012019)))
  (is (equal "壹億壹萬貳仟貳拾" (jp-str :old 100012020)))
  (is (equal "壹億壹萬貳仟貳拾壹" (jp-str :old 100012021)))
  (is (equal "壹億壹萬貳仟貳拾玖" (jp-str :old 100012029)))
  (is (equal "壹億壹萬貳仟壹佰" (jp-str :old 100012100)))
  (is (equal "壹億壹萬貳仟壹佰壹" (jp-str :old 100012101)))
  (is (equal "壹億壹萬貳仟壹佰玖" (jp-str :old 100012109)))
  (is (equal "壹億壹萬貳仟壹佰拾" (jp-str :old 100012110)))
  (is (equal "壹億壹萬貳仟壹佰拾壹" (jp-str :old 100012111)))
  (is (equal "壹億壹萬貳仟壹佰拾玖" (jp-str :old 100012119)))
  (is (equal "壹億壹萬貳仟壹佰貳拾" (jp-str :old 100012120)))
  (is (equal "壹億壹萬貳仟壹佰貳拾壹" (jp-str :old 100012121)))
  (is (equal "壹億壹萬貳仟壹佰貳拾玖" (jp-str :old 100012129)))
  (is (equal "壹億壹萬貳仟貳佰" (jp-str :old 100012200)))
  (is (equal "壹億壹萬貳仟貳佰壹" (jp-str :old 100012201)))
  (is (equal "壹億壹萬貳仟貳佰玖" (jp-str :old 100012209)))
  (is (equal "壹億壹萬貳仟貳佰拾" (jp-str :old 100012210)))
  (is (equal "壹億壹萬貳仟貳佰拾壹" (jp-str :old 100012211)))
  (is (equal "壹億壹萬貳仟貳佰拾玖" (jp-str :old 100012219)))
  (is (equal "壹億壹萬貳仟貳佰貳拾" (jp-str :old 100012220)))
  (is (equal "壹億壹萬貳仟貳佰貳拾壹" (jp-str :old 100012221)))
  (is (equal "壹億壹萬貳仟貳佰貳拾玖" (jp-str :old 100012229)))
  (is (equal "壹億壹萬玖仟玖佰玖拾玖" (jp-str :old 100019999)))
  ;; 100020000 - 199990000
  (is (equal "壹億貳萬" (jp-str :old 100020000)))
  (is (equal "壹億玖萬" (jp-str :old 100090000)))
  (is (equal "壹億拾萬" (jp-str :old 100100000)))
  (is (equal "壹億拾壹萬" (jp-str :old 100110000)))
  (is (equal "壹億拾玖萬" (jp-str :old 100190000)))
  (is (equal "壹億貳拾萬" (jp-str :old 100200000)))
  (is (equal "壹億貳拾壹萬" (jp-str :old 100210000)))
  (is (equal "壹億貳拾玖萬" (jp-str :old 100290000)))
  (is (equal "壹億壹佰萬" (jp-str :old 101000000)))
  (is (equal "壹億壹佰壹萬" (jp-str :old 101010000)))
  (is (equal "壹億壹佰玖萬" (jp-str :old 101090000)))
  (is (equal "壹億壹佰拾萬" (jp-str :old 101100000)))
  (is (equal "壹億壹佰拾壹萬" (jp-str :old 101110000)))
  (is (equal "壹億壹佰拾玖萬" (jp-str :old 101190000)))
  (is (equal "壹億壹佰貳拾萬" (jp-str :old 101200000)))
  (is (equal "壹億壹佰貳拾壹萬" (jp-str :old 101210000)))
  (is (equal "壹億壹佰貳拾玖萬" (jp-str :old 101290000)))
  (is (equal "壹億貳佰萬" (jp-str :old 102000000)))
  (is (equal "壹億貳佰壹萬" (jp-str :old 102010000)))
  (is (equal "壹億貳佰玖萬" (jp-str :old 102090000)))
  (is (equal "壹億貳佰拾萬" (jp-str :old 102100000)))
  (is (equal "壹億貳佰拾壹萬" (jp-str :old 102110000)))
  (is (equal "壹億貳佰拾玖萬" (jp-str :old 102190000)))
  (is (equal "壹億貳佰貳拾萬" (jp-str :old 102200000)))
  (is (equal "壹億貳佰貳拾壹萬" (jp-str :old 102210000)))
  (is (equal "壹億貳佰貳拾玖萬" (jp-str :old 102290000)))
  (is (equal "壹億壹仟萬" (jp-str :old 110000000)))
  (is (equal "壹億壹仟壹萬" (jp-str :old 110010000)))
  (is (equal "壹億壹仟玖萬" (jp-str :old 110090000)))
  (is (equal "壹億壹仟拾萬" (jp-str :old 110100000)))
  (is (equal "壹億壹仟拾壹萬" (jp-str :old 110110000)))
  (is (equal "壹億壹仟拾玖萬" (jp-str :old 110190000)))
  (is (equal "壹億壹仟貳拾萬" (jp-str :old 110200000)))
  (is (equal "壹億壹仟貳拾壹萬" (jp-str :old 110210000)))
  (is (equal "壹億壹仟貳拾玖萬" (jp-str :old 110290000)))
  (is (equal "壹億壹仟壹佰萬" (jp-str :old 111000000)))
  (is (equal "壹億壹仟壹佰壹萬" (jp-str :old 111010000)))
  (is (equal "壹億壹仟壹佰玖萬" (jp-str :old 111090000)))
  (is (equal "壹億壹仟壹佰拾萬" (jp-str :old 111100000)))
  (is (equal "壹億壹仟壹佰拾壹萬" (jp-str :old 111110000)))
  (is (equal "壹億壹仟壹佰拾玖萬" (jp-str :old 111190000)))
  (is (equal "壹億壹仟壹佰貳拾萬" (jp-str :old 111200000)))
  (is (equal "壹億壹仟壹佰貳拾壹萬" (jp-str :old 111210000)))
  (is (equal "壹億壹仟壹佰貳拾玖萬" (jp-str :old 111290000)))
  (is (equal "壹億壹仟貳佰萬" (jp-str :old 112000000)))
  (is (equal "壹億壹仟貳佰壹萬" (jp-str :old 112010000)))
  (is (equal "壹億壹仟貳佰玖萬" (jp-str :old 112090000)))
  (is (equal "壹億壹仟貳佰拾萬" (jp-str :old 112100000)))
  (is (equal "壹億壹仟貳佰拾壹萬" (jp-str :old 112110000)))
  (is (equal "壹億壹仟貳佰拾玖萬" (jp-str :old 112190000)))
  (is (equal "壹億壹仟貳佰貳拾萬" (jp-str :old 112200000)))
  (is (equal "壹億壹仟貳佰貳拾壹萬" (jp-str :old 112210000)))
  (is (equal "壹億壹仟貳佰貳拾玖萬" (jp-str :old 112290000)))
  (is (equal "壹億貳仟萬" (jp-str :old 120000000)))
  (is (equal "壹億貳仟壹萬" (jp-str :old 120010000)))
  (is (equal "壹億貳仟玖萬" (jp-str :old 120090000)))
  (is (equal "壹億貳仟拾萬" (jp-str :old 120100000)))
  (is (equal "壹億貳仟拾壹萬" (jp-str :old 120110000)))
  (is (equal "壹億貳仟拾玖萬" (jp-str :old 120190000)))
  (is (equal "壹億貳仟貳拾萬" (jp-str :old 120200000)))
  (is (equal "壹億貳仟貳拾壹萬" (jp-str :old 120210000)))
  (is (equal "壹億貳仟貳拾玖萬" (jp-str :old 120290000)))
  (is (equal "壹億貳仟壹佰萬" (jp-str :old 121000000)))
  (is (equal "壹億貳仟壹佰壹萬" (jp-str :old 121010000)))
  (is (equal "壹億貳仟壹佰玖萬" (jp-str :old 121090000)))
  (is (equal "壹億貳仟壹佰拾萬" (jp-str :old 121100000)))
  (is (equal "壹億貳仟壹佰拾壹萬" (jp-str :old 121110000)))
  (is (equal "壹億貳仟壹佰拾玖萬" (jp-str :old 121190000)))
  (is (equal "壹億貳仟壹佰貳拾萬" (jp-str :old 121200000)))
  (is (equal "壹億貳仟壹佰貳拾壹萬" (jp-str :old 121210000)))
  (is (equal "壹億貳仟壹佰貳拾玖萬" (jp-str :old 121290000)))
  (is (equal "壹億貳仟貳佰萬" (jp-str :old 122000000)))
  (is (equal "壹億貳仟貳佰壹萬" (jp-str :old 122010000)))
  (is (equal "壹億貳仟貳佰玖萬" (jp-str :old 122090000)))
  (is (equal "壹億貳仟貳佰拾萬" (jp-str :old 122100000)))
  (is (equal "壹億貳仟貳佰拾壹萬" (jp-str :old 122110000)))
  (is (equal "壹億貳仟貳佰拾玖萬" (jp-str :old 122190000)))
  (is (equal "壹億貳仟貳佰貳拾萬" (jp-str :old 122200000)))
  (is (equal "壹億貳仟貳佰貳拾壹萬" (jp-str :old 122210000)))
  (is (equal "壹億貳仟貳佰貳拾玖萬" (jp-str :old 122290000)))
  (is (equal "壹億玖仟玖佰玖拾玖萬" (jp-str :old 199990000)))

  ;; more big nums
  (let ((num 12300001001))
    (is (equal "壹佰貳拾參億壹仟壹" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參兆壹仟壹萬" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參京壹仟壹億" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參垓壹仟壹兆" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參秭壹仟壹京" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參穣壹仟壹垓" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參溝壹仟壹秭" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參澗壹仟壹穣" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參正壹仟壹溝" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參載壹仟壹澗" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參極壹仟壹正" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參恒河沙壹仟壹載" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參阿僧祇壹仟壹極" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參那由他壹仟壹恒河沙" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參不可思議壹仟壹阿僧祇" (jp-str :old num)))
    (mulf num 10000)
    (is (equal "壹佰貳拾參無量大数壹仟壹那由他" (jp-str :old num))))
  ;; 
  t)

(test test-jp-old-integer-minus
  (is (equal "負之壹" (jp-str :old -1)))
  (is (equal "負之貳" (jp-str :old -2)))
  (is (equal "負之參" (jp-str :old -3)))
  (is (equal "負之肆" (jp-str :old -4)))
  (is (equal "負之伍" (jp-str :old -5)))
  (is (equal "負之陸" (jp-str :old -6)))
  (is (equal "負之柒" (jp-str :old -7)))
  (is (equal "負之捌" (jp-str :old -8)))
  (is (equal "負之玖" (jp-str :old -9)))
  (is (equal "負之拾" (jp-str :old -10)))
  (is (equal "負之貳拾" (jp-str :old -20)))
  (is (equal "負之壹佰" (jp-str :old -100)))
  (is (equal "負之伍佰" (jp-str :old -500)))
  (is (equal "負之壹仟" (jp-str :old -1000)))
  (is (equal "負之壹萬" (jp-str :old -10000)))
  (is (equal "負之壹萬貳仟參佰肆拾伍" (jp-str :old -12345)))
  ;; 
  t)
  
(test test-jp-old-rational
  (is (equal "貳分之壹" (jp-str :old 1/2)))
  (is (equal "拾分之壹" (jp-str :old 1/10)))
  (is (equal "貳拾分之壹" (jp-str :old 1/20)))
  (is (equal "壹佰分之壹" (jp-str :old 1/100)))
  (is (equal "壹佰拾分之壹" (jp-str :old 1/110)))
  (is (equal "壹佰拾壹分之壹" (jp-str :old 1/111)))
  (is (equal "壹佰貳拾分之壹" (jp-str :old 1/120)))
  (is (equal "壹佰貳拾壹分之壹" (jp-str :old 1/121)))
  (is (equal "貳佰分之壹" (jp-str :old 1/200)))
  (is (equal "貳佰拾分之壹" (jp-str :old 1/210)))
  (is (equal "貳佰拾壹分之壹" (jp-str :old 1/211)))
  (is (equal "貳佰貳拾分之壹" (jp-str :old 1/220)))
  (is (equal "貳佰貳拾壹分之壹" (jp-str :old 1/221)))
  (is (equal "壹仟分之壹" (jp-str :old 1/1000)))
  (is (equal "壹仟拾分之壹" (jp-str :old 1/1010)))
  (is (equal "壹仟拾壹分之壹" (jp-str :old 1/1011)))
  (is (equal "壹仟貳拾分之壹" (jp-str :old 1/1020)))
  (is (equal "壹仟貳拾壹分之壹" (jp-str :old 1/1021)))
  (is (equal "壹仟壹佰分之壹" (jp-str :old 1/1100)))
  (is (equal "壹仟壹佰拾分之壹" (jp-str :old 1/1110)))
  (is (equal "壹仟壹佰拾壹分之壹" (jp-str :old 1/1111)))
  (is (equal "壹仟壹佰貳拾分之壹" (jp-str :old 1/1120)))
  (is (equal "壹仟壹佰貳拾壹分之壹" (jp-str :old 1/1121)))
  (is (equal "貳仟貳佰壹分之壹" (jp-str :old 1/2201)))
  (is (equal "壹萬分之壹" (jp-str :old 1/10000)))
  (is (equal "壹萬壹仟壹佰拾壹分之壹" (jp-str :old 1/11111)))
  (is (equal "貳萬貳仟貳佰貳拾貳分之壹" (jp-str :old 1/22222)))
  (is (equal "壹億分之壹" (jp-str :old 1/100000000)))

  (is (equal "壹萬玖仟玖佰玖拾柒分之壹" (jp-str :old 1/19997))) ; 19997 is a prime.
  (is (equal "壹萬玖仟玖佰玖拾柒分之貳" (jp-str :old 2/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之拾" (jp-str :old 10/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之拾壹" (jp-str :old 11/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之貳拾壹" (jp-str :old 21/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之玖拾玖" (jp-str :old 99/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹佰" (jp-str :old 100/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹佰壹" (jp-str :old 101/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹佰拾壹" (jp-str :old 111/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之貳佰拾壹" (jp-str :old 211/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹仟壹" (jp-str :old 1001/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹仟壹佰拾壹" (jp-str :old 1111/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之貳仟貳佰貳拾貳" (jp-str :old 2222/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹萬" (jp-str :old 10000/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹萬壹" (jp-str :old 10001/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹萬壹仟壹佰拾" (jp-str :old 11110/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹萬伍仟貳" (jp-str :old 15002/19997)))
  (is (equal "壹萬玖仟玖佰玖拾柒分之壹萬玖仟玖佰玖拾陸" (jp-str :old 19996/19997)))

  (is (equal "負之貳分之壹" (jp-str :old -1/2)))
  ;; 
  t)
  
(test test-jp-old-float
  ;; int
  (is (equal "零" (jp-str :old 0.0)))
  (is (equal "壹" (jp-str :old 1.0)))
  (is (equal "拾" (jp-str :old 10.0)))
  ;; 0.1-0.9
  (is (equal "壹分" (jp-str :old 0.1)))
  (is (equal "貳分" (jp-str :old 0.2)))
  (is (equal "參分" (jp-str :old 0.3)))
  (is (equal "肆分" (jp-str :old 0.4)))
  (is (equal "伍分" (jp-str :old 0.5)))
  (is (equal "陸分" (jp-str :old 0.6)))
  (is (equal "柒分" (jp-str :old 0.7)))
  (is (equal "捌分" (jp-str :old 0.8)))
  (is (equal "玖分" (jp-str :old 0.9)))
  ;; 0.10-0.30
  (is (equal "壹分" (jp-str :old 0.10)))
  (is (equal "壹分壹釐" (jp-str :old 0.11)))
  (is (equal "壹分貳釐" (jp-str :old 0.12)))
  (is (equal "壹分參釐" (jp-str :old 0.13)))
  (is (equal "壹分肆釐" (jp-str :old 0.14)))
  (is (equal "壹分伍釐" (jp-str :old 0.15)))
  (is (equal "壹分陸釐" (jp-str :old 0.16)))
  (is (equal "壹分柒釐" (jp-str :old 0.17)))
  (is (equal "壹分捌釐" (jp-str :old 0.18)))
  (is (equal "壹分玖釐" (jp-str :old 0.19)))
  (is (equal "貳分" (jp-str :old 0.20)))
  (is (equal "貳分壹釐" (jp-str :old 0.21)))
  (is (equal "貳分貳釐" (jp-str :old 0.22)))
  (is (equal "貳分參釐" (jp-str :old 0.23)))
  (is (equal "貳分肆釐" (jp-str :old 0.24)))
  (is (equal "貳分伍釐" (jp-str :old 0.25)))
  (is (equal "貳分陸釐" (jp-str :old 0.26)))
  (is (equal "貳分柒釐" (jp-str :old 0.27)))
  (is (equal "貳分捌釐" (jp-str :old 0.28)))
  (is (equal "貳分玖釐" (jp-str :old 0.29)))
  (is (equal "參分" (jp-str :old 0.30)))
  ;; small nums
  (is (equal "拾・參分肆釐" (jp-str :old 10.34)))
  (is (equal "壹・參釐肆毫" (jp-str :old 1.034)))
  (is (equal "壹分參毫肆絲" (jp-str :old 0.1034)))
  (is (equal "壹釐參絲肆忽" (jp-str :old 0.01034)))
  (is (equal "壹毫參忽肆微" (jp-str :old 0.001034)))
  (is (equal "壹絲參微肆繊" (jp-str :old 0.0001034)))
  (is (equal "壹忽參繊肆沙" (jp-str :old 0.00001034)))
  (is (equal "壹微參沙肆塵" (jp-str :old 0.000001034)))
  (is (equal "壹繊參塵肆埃" (jp-str :old 0.0000001034)))
  (is (equal "壹沙參埃肆渺" (jp-str :old 0.00000001034)))
  (is (equal "壹塵參渺肆漠" (jp-str :old 0.000000001034)))
  (is (equal "壹埃參漠肆模糊" (jp-str :old 0.0000000001034)))
  (is (equal "壹渺參模糊肆逡巡" (jp-str :old 0.00000000001034)))
  (is (equal "壹漠參逡巡肆須臾" (jp-str :old 0.000000000001034)))
  (is (equal "壹模糊參須臾肆瞬息" (jp-str :old 0.0000000000001034)))
  (is (equal "壹逡巡參瞬息肆弾指" (jp-str :old 0.00000000000001034)))
  (is (equal "壹須臾參弾指肆刹那" (jp-str :old 0.000000000000001034)))
  (is (equal "壹瞬息參刹那肆六徳" (jp-str :old 0.0000000000000001034)))
  (is (equal "壹弾指參六徳肆虚空" (jp-str :old 0.00000000000000001034)))
  (is (equal "壹刹那參虚空肆清浄" (jp-str :old 0.000000000000000001034)))
  ;; minus
  (is (equal "負之壹分" (jp-str :old -0.1)))
  (is (equal "負之貳分" (jp-str :old -0.2)))
  (is (equal "負之壹分壹釐" (jp-str :old -0.11)))
  (is (equal "負之貳釐" (jp-str :old -0.02)))
  (is (equal "負之壹・壹分" (jp-str :old -1.1)))
  (is (equal "負之壹・壹釐" (jp-str :old -1.01)))
  ;;
  t)

(test test-jp-old-fallback
  ;; too big num
  (is (equal "壹無量大数" (jp-str :old (expt 10 68))))
  (is (equal "一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
	     (jp-str :old (expt 10 72))))
  (is (equal "負之壹無量大数" (jp-str :old (- (expt 10 68)))))
  (is (equal "−一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
	     (jp-str :old (- (expt 10 72)))))
  ;; too small num
  (is (equal "壹清浄" (jp-str :old (float (expt 10 -21)))))
  (is (equal "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
	     (jp-str :old (float (expt 10 -22)))))
  (is (equal "負之壹清浄" (jp-str :old (- (float (expt 10 -21))))))
  (is (equal "−〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
	     (jp-str :old (- (float (expt 10 -22))))))
  ;; complex
  (is (equal (format nil "~A" #c(1 1))
	     (jp-str :old #c(1 1))))
  ;;
  t)

(test test-jp-old-parameters
  ;; [Integer]
  ;; digits-after-dot -- ignored
  (is (equal "壹" (jp-str :old 1 :digits-after-dot nil)))
  (is (equal "壹" (jp-str :old 1 :digits-after-dot 0)))
  (is (equal "壹" (jp-str :old 1 :digits-after-dot 1)))
  #+allegro(is (equal "壹" (jp-str :old 1 :digits-after-dot -1)))
  ;; scale
  (is (equal "壹" (jp-str :old 1 :scale nil)))
  (is (equal "壹" (jp-str :old 1 :scale 0)))
  (is (equal "拾" (jp-str :old 1 :scale 1)))
  (is (equal "拾分之壹" (jp-str :old 1 :scale -1)))
  ;; radix-point
  (is (equal "壹" (jp-str :old 1 :radix-point nil)))
  (is (equal "壹a" (jp-str :old 1 :radix-point #\a)))
  (is (equal "壹abc" (jp-str :old 1 :radix-point "abc")))

  ;; [Rational]
  ;; digits-after-dot -- ignored
  (is (equal "貳分之壹" (jp-str :old 1/2 :digits-after-dot nil)))
  (is (equal "貳分之壹" (jp-str :old 1/2 :digits-after-dot 0)))
  (is (equal "貳分之壹" (jp-str :old 1/2 :digits-after-dot 1)))
  #+allegro(is (equal "貳分之壹" (jp-str :old 1/2 :digits-after-dot -1)))
  ;; scale
  (is (equal "貳分之壹" (jp-str :old 1/2 :scale nil)))
  (is (equal "貳分之壹" (jp-str :old 1/2 :scale 0)))
  (is (equal "伍" (jp-str :old 1/2 :scale 1)))
  (is (equal "貳拾分之壹" (jp-str :old 1/2 :scale -1)))
  ;; radix-point
  (is (equal "貳分之壹" (jp-str :old 1/2 :radix-point nil)))
  (is (equal "貳分之壹a" (jp-str :old 1/2 :radix-point #\a)))
  (is (equal "貳分之壹abc" (jp-str :old 1/2 :radix-point "abc")))

  ;; [Float]
  ;; digits-after-dot
  (is (equal "拾貳・參分肆釐" (jp-str :old 12.34 :digits-after-dot nil)))
  (is (equal "拾貳" (jp-str :old 12.34 :digits-after-dot 0)))
  (is (equal "拾貳・參分" (jp-str :old 12.34 :digits-after-dot 1)))
  (is (equal "拾貳・參分肆釐" (jp-str :old 12.34 :digits-after-dot 2)))
  (is (equal "拾貳・參分肆釐" (jp-str :old 12.34 :digits-after-dot 3)))
  #+allegro(is (equal "拾" (jp-str :old 12.34 :digits-after-dot -1)))
  #+allegro(is (equal "零" (jp-str :old 12.34 :digits-after-dot -2)))
  ;; scale
  (is (equal "拾貳・參分肆釐" (jp-str :old 12.34 :scale nil)))
  (is (equal "拾貳・參分肆釐" (jp-str :old 12.34 :scale 0)))
  (is (equal "壹佰貳拾參・肆分" (jp-str :old 12.34 :scale 1)))
  (is (equal "壹仟貳佰參拾肆" (jp-str :old 12.34 :scale 2)))
  (is (equal "壹・貳分參釐肆毫" (jp-str :old 12.34 :scale -1)))
  (is (equal "壹分貳釐參毫肆絲" (jp-str :old 12.34 :scale -2)))
  ;; radix-point
  (is (equal "拾貳・參分肆釐" (jp-str :old 12.34 :radix-point nil)))
  (is (equal "拾貳a參分肆釐" (jp-str :old 12.34 :radix-point #\a)))
  (is (equal "拾貳abc參分肆釐" (jp-str :old 12.34 :radix-point "abc")))
  (is (equal "壹仟貳佰參拾肆abc" (jp-str :old 12.34 :radix-point "abc" :scale 2)))
  (is (equal "零abc壹分貳釐參毫肆絲" (jp-str :old 12.34 :radix-point "abc" :scale -2)))
  ;; 
  t)
