;;; -*- coding: utf-8; -*-

(in-package :jp-numeral.test)

(defun jp-str/o (num &key digits-after-dot
		 scale radix-point)
  (with-output-to-string (stream)
    (jp-numeral:jp stream num nil t
		   digits-after-dot scale radix-point)))

(defun test-jp-old-integer-4digits ()
  ;; 0
  (assert (equal "零" (jp-str/o 0)))
  ;; 1-9
  (assert (equal "壹" (jp-str/o 1)))
  (assert (equal "貳" (jp-str/o 2)))
  (assert (equal "參" (jp-str/o 3)))
  (assert (equal "肆" (jp-str/o 4)))
  (assert (equal "伍" (jp-str/o 5)))
  (assert (equal "陸" (jp-str/o 6)))
  (assert (equal "柒" (jp-str/o 7)))
  (assert (equal "捌" (jp-str/o 8)))
  (assert (equal "玖" (jp-str/o 9)))
  ;; 10-19
  (assert (equal "拾" (jp-str/o 10)))
  (assert (equal "拾壹" (jp-str/o 11)))
  (assert (equal "拾貳" (jp-str/o 12)))
  (assert (equal "拾參" (jp-str/o 13)))
  (assert (equal "拾肆" (jp-str/o 14)))
  (assert (equal "拾伍" (jp-str/o 15)))
  (assert (equal "拾陸" (jp-str/o 16)))
  (assert (equal "拾柒" (jp-str/o 17)))
  (assert (equal "拾捌" (jp-str/o 18)))
  (assert (equal "拾玖" (jp-str/o 19)))
  ;; 20-99
  (assert (equal "貳拾" (jp-str/o 20)))
  (assert (equal "貳拾壹" (jp-str/o 21)))
  (assert (equal "貳拾玖" (jp-str/o 29)))
  (assert (equal "參拾" (jp-str/o 30)))
  (assert (equal "參拾壹" (jp-str/o 31)))
  (assert (equal "參拾玖" (jp-str/o 39)))
  (assert (equal "肆拾" (jp-str/o 40)))
  (assert (equal "肆拾壹" (jp-str/o 41)))
  (assert (equal "肆拾玖" (jp-str/o 49)))
  (assert (equal "伍拾" (jp-str/o 50)))
  (assert (equal "伍拾壹" (jp-str/o 51)))
  (assert (equal "伍拾玖" (jp-str/o 59)))
  (assert (equal "陸拾" (jp-str/o 60)))
  (assert (equal "陸拾壹" (jp-str/o 61)))
  (assert (equal "陸拾玖" (jp-str/o 69)))
  (assert (equal "柒拾" (jp-str/o 70)))
  (assert (equal "柒拾壹" (jp-str/o 71)))
  (assert (equal "柒拾玖" (jp-str/o 79)))
  (assert (equal "捌拾" (jp-str/o 80)))
  (assert (equal "捌拾壹" (jp-str/o 81)))
  (assert (equal "捌拾玖" (jp-str/o 89)))
  (assert (equal "玖拾" (jp-str/o 90)))
  (assert (equal "玖拾壹" (jp-str/o 91)))
  (assert (equal "玖拾玖" (jp-str/o 99)))
  ;; 100
  (assert (equal "壹佰" (jp-str/o 100)))
  ;; 101-109
  (assert (equal "壹佰壹" (jp-str/o 101)))
  (assert (equal "壹佰貳" (jp-str/o 102)))
  (assert (equal "壹佰參" (jp-str/o 103)))
  (assert (equal "壹佰肆" (jp-str/o 104)))
  (assert (equal "壹佰伍" (jp-str/o 105)))
  (assert (equal "壹佰陸" (jp-str/o 106)))
  (assert (equal "壹佰柒" (jp-str/o 107)))
  (assert (equal "壹佰捌" (jp-str/o 108)))
  (assert (equal "壹佰玖" (jp-str/o 109)))
  ;; 110-119
  (assert (equal "壹佰拾" (jp-str/o 110)))
  (assert (equal "壹佰拾壹" (jp-str/o 111)))
  (assert (equal "壹佰拾貳" (jp-str/o 112)))
  (assert (equal "壹佰拾參" (jp-str/o 113)))
  (assert (equal "壹佰拾肆" (jp-str/o 114)))
  (assert (equal "壹佰拾伍" (jp-str/o 115)))
  (assert (equal "壹佰拾陸" (jp-str/o 116)))
  (assert (equal "壹佰拾柒" (jp-str/o 117)))
  (assert (equal "壹佰拾捌" (jp-str/o 118)))
  (assert (equal "壹佰拾玖" (jp-str/o 119)))
  ;; 120-199
  (assert (equal "壹佰貳拾" (jp-str/o 120)))
  (assert (equal "壹佰貳拾壹" (jp-str/o 121)))
  (assert (equal "壹佰貳拾玖" (jp-str/o 129)))
  (assert (equal "壹佰參拾" (jp-str/o 130)))
  (assert (equal "壹佰參拾壹" (jp-str/o 131)))
  (assert (equal "壹佰參拾玖" (jp-str/o 139)))
  (assert (equal "壹佰肆拾" (jp-str/o 140)))
  (assert (equal "壹佰肆拾壹" (jp-str/o 141)))
  (assert (equal "壹佰肆拾玖" (jp-str/o 149)))
  (assert (equal "壹佰伍拾" (jp-str/o 150)))
  (assert (equal "壹佰伍拾壹" (jp-str/o 151)))
  (assert (equal "壹佰伍拾玖" (jp-str/o 159)))
  (assert (equal "壹佰陸拾" (jp-str/o 160)))
  (assert (equal "壹佰陸拾壹" (jp-str/o 161)))
  (assert (equal "壹佰陸拾玖" (jp-str/o 169)))
  (assert (equal "壹佰柒拾" (jp-str/o 170)))
  (assert (equal "壹佰柒拾壹" (jp-str/o 171)))
  (assert (equal "壹佰柒拾玖" (jp-str/o 179)))
  (assert (equal "壹佰捌拾" (jp-str/o 180)))
  (assert (equal "壹佰捌拾壹" (jp-str/o 181)))
  (assert (equal "壹佰捌拾玖" (jp-str/o 189)))
  (assert (equal "壹佰玖拾" (jp-str/o 190)))
  (assert (equal "壹佰玖拾壹" (jp-str/o 191)))
  (assert (equal "壹佰玖拾玖" (jp-str/o 199)))
  ;; 200-999
  (assert (equal "貳佰" (jp-str/o 200)))
  (assert (equal "貳佰壹" (jp-str/o 201)))
  (assert (equal "貳佰玖" (jp-str/o 209)))
  (assert (equal "貳佰拾" (jp-str/o 210)))
  (assert (equal "貳佰拾壹" (jp-str/o 211)))
  (assert (equal "貳佰拾玖" (jp-str/o 219)))
  (assert (equal "貳佰貳拾" (jp-str/o 220)))
  (assert (equal "貳佰貳拾壹" (jp-str/o 221)))
  (assert (equal "貳佰玖拾玖" (jp-str/o 299)))
  (assert (equal "參佰" (jp-str/o 300)))
  (assert (equal "參佰壹" (jp-str/o 301)))
  (assert (equal "參佰玖" (jp-str/o 309)))
  (assert (equal "參佰拾" (jp-str/o 310)))
  (assert (equal "參佰拾壹" (jp-str/o 311)))
  (assert (equal "參佰拾玖" (jp-str/o 319)))
  (assert (equal "參佰貳拾" (jp-str/o 320)))
  (assert (equal "參佰貳拾壹" (jp-str/o 321)))
  (assert (equal "參佰玖拾玖" (jp-str/o 399)))
  (assert (equal "肆佰" (jp-str/o 400)))
  (assert (equal "肆佰壹" (jp-str/o 401)))
  (assert (equal "肆佰玖" (jp-str/o 409)))
  (assert (equal "肆佰拾" (jp-str/o 410)))
  (assert (equal "肆佰拾壹" (jp-str/o 411)))
  (assert (equal "肆佰拾玖" (jp-str/o 419)))
  (assert (equal "肆佰貳拾" (jp-str/o 420)))
  (assert (equal "肆佰貳拾壹" (jp-str/o 421)))
  (assert (equal "肆佰玖拾玖" (jp-str/o 499)))
  (assert (equal "伍佰" (jp-str/o 500)))
  (assert (equal "伍佰壹" (jp-str/o 501)))
  (assert (equal "伍佰玖" (jp-str/o 509)))
  (assert (equal "伍佰拾" (jp-str/o 510)))
  (assert (equal "伍佰拾壹" (jp-str/o 511)))
  (assert (equal "伍佰拾玖" (jp-str/o 519)))
  (assert (equal "伍佰貳拾" (jp-str/o 520)))
  (assert (equal "伍佰貳拾壹" (jp-str/o 521)))
  (assert (equal "伍佰玖拾玖" (jp-str/o 599)))
  (assert (equal "陸佰" (jp-str/o 600)))
  (assert (equal "陸佰壹" (jp-str/o 601)))
  (assert (equal "陸佰玖" (jp-str/o 609)))
  (assert (equal "陸佰拾" (jp-str/o 610)))
  (assert (equal "陸佰拾壹" (jp-str/o 611)))
  (assert (equal "陸佰拾玖" (jp-str/o 619)))
  (assert (equal "陸佰貳拾" (jp-str/o 620)))
  (assert (equal "陸佰貳拾壹" (jp-str/o 621)))
  (assert (equal "陸佰玖拾玖" (jp-str/o 699)))
  (assert (equal "柒佰" (jp-str/o 700)))
  (assert (equal "柒佰壹" (jp-str/o 701)))
  (assert (equal "柒佰玖" (jp-str/o 709)))
  (assert (equal "柒佰拾" (jp-str/o 710)))
  (assert (equal "柒佰拾壹" (jp-str/o 711)))
  (assert (equal "柒佰拾玖" (jp-str/o 719)))
  (assert (equal "柒佰貳拾" (jp-str/o 720)))
  (assert (equal "柒佰貳拾壹" (jp-str/o 721)))
  (assert (equal "柒佰玖拾玖" (jp-str/o 799)))
  (assert (equal "捌佰" (jp-str/o 800)))
  (assert (equal "捌佰壹" (jp-str/o 801)))
  (assert (equal "捌佰玖" (jp-str/o 809)))
  (assert (equal "捌佰拾" (jp-str/o 810)))
  (assert (equal "捌佰拾壹" (jp-str/o 811)))
  (assert (equal "捌佰拾玖" (jp-str/o 819)))
  (assert (equal "捌佰貳拾" (jp-str/o 820)))
  (assert (equal "捌佰貳拾壹" (jp-str/o 821)))
  (assert (equal "捌佰玖拾玖" (jp-str/o 899)))
  (assert (equal "玖佰" (jp-str/o 900)))
  (assert (equal "玖佰壹" (jp-str/o 901)))
  (assert (equal "玖佰玖" (jp-str/o 909)))
  (assert (equal "玖佰拾" (jp-str/o 910)))
  (assert (equal "玖佰拾壹" (jp-str/o 911)))
  (assert (equal "玖佰拾玖" (jp-str/o 919)))
  (assert (equal "玖佰貳拾" (jp-str/o 920)))
  (assert (equal "玖佰貳拾壹" (jp-str/o 921)))
  (assert (equal "玖佰玖拾玖" (jp-str/o 999)))
  ;; 1000 - 1099
  (assert (equal "壹仟" (jp-str/o 1000)))
  (assert (equal "壹仟壹" (jp-str/o 1001)))
  (assert (equal "壹仟貳" (jp-str/o 1002)))
  (assert (equal "壹仟玖" (jp-str/o 1009)))
  (assert (equal "壹仟拾" (jp-str/o 1010)))
  (assert (equal "壹仟拾壹" (jp-str/o 1011)))
  (assert (equal "壹仟拾玖" (jp-str/o 1019)))
  (assert (equal "壹仟貳拾" (jp-str/o 1020)))
  (assert (equal "壹仟貳拾壹" (jp-str/o 1021)))
  (assert (equal "壹仟貳拾玖" (jp-str/o 1029)))
  (assert (equal "壹仟參拾" (jp-str/o 1030)))
  (assert (equal "壹仟玖拾玖" (jp-str/o 1099)))
  ;; 1100 - 9999
  (assert (equal "壹仟壹佰" (jp-str/o 1100)))
  (assert (equal "壹仟壹佰壹" (jp-str/o 1101)))
  (assert (equal "壹仟壹佰玖" (jp-str/o 1109)))
  (assert (equal "壹仟壹佰拾" (jp-str/o 1110)))
  (assert (equal "壹仟壹佰拾壹" (jp-str/o 1111)))
  (assert (equal "壹仟壹佰拾玖" (jp-str/o 1119)))
  (assert (equal "壹仟壹佰貳拾" (jp-str/o 1120)))
  (assert (equal "壹仟壹佰貳拾壹" (jp-str/o 1121)))
  (assert (equal "壹仟壹佰貳拾玖" (jp-str/o 1129)))
  (assert (equal "壹仟壹佰玖拾玖" (jp-str/o 1199)))
  (assert (equal "壹仟貳佰" (jp-str/o 1200)))
  (assert (equal "壹仟貳佰壹" (jp-str/o 1201)))
  (assert (equal "壹仟貳佰玖" (jp-str/o 1209)))
  (assert (equal "壹仟貳佰拾" (jp-str/o 1210)))
  (assert (equal "壹仟貳佰拾壹" (jp-str/o 1211)))
  (assert (equal "壹仟貳佰拾玖" (jp-str/o 1219)))
  (assert (equal "壹仟貳佰貳拾" (jp-str/o 1220)))
  (assert (equal "壹仟貳佰貳拾壹" (jp-str/o 1221)))
  (assert (equal "壹仟貳佰貳拾玖" (jp-str/o 1229)))
  (assert (equal "壹仟貳佰玖拾玖" (jp-str/o 1299)))
  (assert (equal "壹仟玖佰" (jp-str/o 1900)))
  (assert (equal "壹仟玖佰壹" (jp-str/o 1901)))
  (assert (equal "壹仟玖佰玖" (jp-str/o 1909)))
  (assert (equal "壹仟玖佰拾" (jp-str/o 1910)))
  (assert (equal "壹仟玖佰拾壹" (jp-str/o 1911)))
  (assert (equal "壹仟玖佰拾玖" (jp-str/o 1919)))
  (assert (equal "壹仟玖佰貳拾" (jp-str/o 1920)))
  (assert (equal "壹仟玖佰貳拾壹" (jp-str/o 1921)))
  (assert (equal "壹仟玖佰貳拾玖" (jp-str/o 1929)))
  (assert (equal "壹仟玖佰玖拾玖" (jp-str/o 1999)))
  ;; 2000 - 9999
  (assert (equal "貳仟" (jp-str/o 2000)))
  (assert (equal "貳仟壹" (jp-str/o 2001)))
  (assert (equal "貳仟拾" (jp-str/o 2010)))
  (assert (equal "貳仟拾壹" (jp-str/o 2011)))
  (assert (equal "貳仟貳拾" (jp-str/o 2020)))
  (assert (equal "貳仟貳拾壹" (jp-str/o 2021)))
  (assert (equal "貳仟壹佰" (jp-str/o 2100)))
  (assert (equal "貳仟壹佰壹" (jp-str/o 2101)))
  (assert (equal "貳仟壹佰拾" (jp-str/o 2110)))
  (assert (equal "貳仟壹佰拾壹" (jp-str/o 2111)))
  (assert (equal "貳仟壹佰貳拾" (jp-str/o 2120)))
  (assert (equal "貳仟壹佰貳拾壹" (jp-str/o 2121)))
  (assert (equal "貳仟貳佰" (jp-str/o 2200)))
  (assert (equal "貳仟貳佰壹" (jp-str/o 2201)))
  (assert (equal "貳仟貳佰拾" (jp-str/o 2210)))
  (assert (equal "貳仟貳佰拾壹" (jp-str/o 2211)))
  (assert (equal "貳仟貳佰貳拾" (jp-str/o 2220)))
  (assert (equal "貳仟貳佰貳拾壹" (jp-str/o 2221)))
  (assert (equal "參仟" (jp-str/o 3000)))
  (assert (equal "參仟壹" (jp-str/o 3001)))
  (assert (equal "參仟拾" (jp-str/o 3010)))
  (assert (equal "參仟拾壹" (jp-str/o 3011)))
  (assert (equal "參仟貳拾" (jp-str/o 3020)))
  (assert (equal "參仟貳拾壹" (jp-str/o 3021)))
  (assert (equal "參仟壹佰" (jp-str/o 3100)))
  (assert (equal "參仟壹佰壹" (jp-str/o 3101)))
  (assert (equal "參仟壹佰拾" (jp-str/o 3110)))
  (assert (equal "參仟壹佰拾壹" (jp-str/o 3111)))
  (assert (equal "參仟壹佰貳拾" (jp-str/o 3120)))
  (assert (equal "參仟壹佰貳拾壹" (jp-str/o 3121)))
  (assert (equal "參仟貳佰" (jp-str/o 3200)))
  (assert (equal "參仟貳佰壹" (jp-str/o 3201)))
  (assert (equal "參仟貳佰拾" (jp-str/o 3210)))
  (assert (equal "參仟貳佰拾壹" (jp-str/o 3211)))
  (assert (equal "參仟貳佰貳拾" (jp-str/o 3220)))
  (assert (equal "參仟貳佰貳拾壹" (jp-str/o 3221)))
  (assert (equal "肆仟" (jp-str/o 4000)))
  (assert (equal "肆仟壹" (jp-str/o 4001)))
  (assert (equal "肆仟拾" (jp-str/o 4010)))
  (assert (equal "肆仟拾壹" (jp-str/o 4011)))
  (assert (equal "肆仟貳拾" (jp-str/o 4020)))
  (assert (equal "肆仟貳拾壹" (jp-str/o 4021)))
  (assert (equal "肆仟壹佰" (jp-str/o 4100)))
  (assert (equal "肆仟壹佰壹" (jp-str/o 4101)))
  (assert (equal "肆仟壹佰拾" (jp-str/o 4110)))
  (assert (equal "肆仟壹佰拾壹" (jp-str/o 4111)))
  (assert (equal "肆仟壹佰貳拾" (jp-str/o 4120)))
  (assert (equal "肆仟壹佰貳拾壹" (jp-str/o 4121)))
  (assert (equal "肆仟貳佰" (jp-str/o 4200)))
  (assert (equal "肆仟貳佰壹" (jp-str/o 4201)))
  (assert (equal "肆仟貳佰拾" (jp-str/o 4210)))
  (assert (equal "肆仟貳佰拾壹" (jp-str/o 4211)))
  (assert (equal "肆仟貳佰貳拾" (jp-str/o 4220)))
  (assert (equal "肆仟貳佰貳拾壹" (jp-str/o 4221)))
  (assert (equal "伍仟" (jp-str/o 5000)))
  (assert (equal "伍仟壹" (jp-str/o 5001)))
  (assert (equal "伍仟拾" (jp-str/o 5010)))
  (assert (equal "伍仟拾壹" (jp-str/o 5011)))
  (assert (equal "伍仟貳拾" (jp-str/o 5020)))
  (assert (equal "伍仟貳拾壹" (jp-str/o 5021)))
  (assert (equal "伍仟壹佰" (jp-str/o 5100)))
  (assert (equal "伍仟壹佰壹" (jp-str/o 5101)))
  (assert (equal "伍仟壹佰拾" (jp-str/o 5110)))
  (assert (equal "伍仟壹佰拾壹" (jp-str/o 5111)))
  (assert (equal "伍仟壹佰貳拾" (jp-str/o 5120)))
  (assert (equal "伍仟壹佰貳拾壹" (jp-str/o 5121)))
  (assert (equal "伍仟貳佰" (jp-str/o 5200)))
  (assert (equal "伍仟貳佰壹" (jp-str/o 5201)))
  (assert (equal "伍仟貳佰拾" (jp-str/o 5210)))
  (assert (equal "伍仟貳佰拾壹" (jp-str/o 5211)))
  (assert (equal "伍仟貳佰貳拾" (jp-str/o 5220)))
  (assert (equal "伍仟貳佰貳拾壹" (jp-str/o 5221)))
  (assert (equal "陸仟" (jp-str/o 6000)))
  (assert (equal "陸仟壹" (jp-str/o 6001)))
  (assert (equal "陸仟拾" (jp-str/o 6010)))
  (assert (equal "陸仟拾壹" (jp-str/o 6011)))
  (assert (equal "陸仟貳拾" (jp-str/o 6020)))
  (assert (equal "陸仟貳拾壹" (jp-str/o 6021)))
  (assert (equal "陸仟壹佰" (jp-str/o 6100)))
  (assert (equal "陸仟壹佰壹" (jp-str/o 6101)))
  (assert (equal "陸仟壹佰拾" (jp-str/o 6110)))
  (assert (equal "陸仟壹佰拾壹" (jp-str/o 6111)))
  (assert (equal "陸仟壹佰貳拾" (jp-str/o 6120)))
  (assert (equal "陸仟壹佰貳拾壹" (jp-str/o 6121)))
  (assert (equal "陸仟貳佰" (jp-str/o 6200)))
  (assert (equal "陸仟貳佰壹" (jp-str/o 6201)))
  (assert (equal "陸仟貳佰拾" (jp-str/o 6210)))
  (assert (equal "陸仟貳佰拾壹" (jp-str/o 6211)))
  (assert (equal "陸仟貳佰貳拾" (jp-str/o 6220)))
  (assert (equal "陸仟貳佰貳拾壹" (jp-str/o 6221)))
  (assert (equal "柒仟" (jp-str/o 7000)))
  (assert (equal "柒仟壹" (jp-str/o 7001)))
  (assert (equal "柒仟拾" (jp-str/o 7010)))
  (assert (equal "柒仟拾壹" (jp-str/o 7011)))
  (assert (equal "柒仟貳拾" (jp-str/o 7020)))
  (assert (equal "柒仟貳拾壹" (jp-str/o 7021)))
  (assert (equal "柒仟壹佰" (jp-str/o 7100)))
  (assert (equal "柒仟壹佰壹" (jp-str/o 7101)))
  (assert (equal "柒仟壹佰拾" (jp-str/o 7110)))
  (assert (equal "柒仟壹佰拾壹" (jp-str/o 7111)))
  (assert (equal "柒仟壹佰貳拾" (jp-str/o 7120)))
  (assert (equal "柒仟壹佰貳拾壹" (jp-str/o 7121)))
  (assert (equal "柒仟貳佰" (jp-str/o 7200)))
  (assert (equal "柒仟貳佰壹" (jp-str/o 7201)))
  (assert (equal "柒仟貳佰拾" (jp-str/o 7210)))
  (assert (equal "柒仟貳佰拾壹" (jp-str/o 7211)))
  (assert (equal "柒仟貳佰貳拾" (jp-str/o 7220)))
  (assert (equal "柒仟貳佰貳拾壹" (jp-str/o 7221)))
  (assert (equal "捌仟" (jp-str/o 8000)))
  (assert (equal "捌仟壹" (jp-str/o 8001)))
  (assert (equal "捌仟拾" (jp-str/o 8010)))
  (assert (equal "捌仟拾壹" (jp-str/o 8011)))
  (assert (equal "捌仟貳拾" (jp-str/o 8020)))
  (assert (equal "捌仟貳拾壹" (jp-str/o 8021)))
  (assert (equal "捌仟壹佰" (jp-str/o 8100)))
  (assert (equal "捌仟壹佰壹" (jp-str/o 8101)))
  (assert (equal "捌仟壹佰拾" (jp-str/o 8110)))
  (assert (equal "捌仟壹佰拾壹" (jp-str/o 8111)))
  (assert (equal "捌仟壹佰貳拾" (jp-str/o 8120)))
  (assert (equal "捌仟壹佰貳拾壹" (jp-str/o 8121)))
  (assert (equal "捌仟貳佰" (jp-str/o 8200)))
  (assert (equal "捌仟貳佰壹" (jp-str/o 8201)))
  (assert (equal "捌仟貳佰拾" (jp-str/o 8210)))
  (assert (equal "捌仟貳佰拾壹" (jp-str/o 8211)))
  (assert (equal "捌仟貳佰貳拾" (jp-str/o 8220)))
  (assert (equal "捌仟貳佰貳拾壹" (jp-str/o 8221)))
  (assert (equal "玖仟" (jp-str/o 9000)))
  (assert (equal "玖仟壹" (jp-str/o 9001)))
  (assert (equal "玖仟拾" (jp-str/o 9010)))
  (assert (equal "玖仟拾壹" (jp-str/o 9011)))
  (assert (equal "玖仟貳拾" (jp-str/o 9020)))
  (assert (equal "玖仟貳拾壹" (jp-str/o 9021)))
  (assert (equal "玖仟壹佰" (jp-str/o 9100)))
  (assert (equal "玖仟壹佰壹" (jp-str/o 9101)))
  (assert (equal "玖仟壹佰拾" (jp-str/o 9110)))
  (assert (equal "玖仟壹佰拾壹" (jp-str/o 9111)))
  (assert (equal "玖仟壹佰貳拾" (jp-str/o 9120)))
  (assert (equal "玖仟壹佰貳拾壹" (jp-str/o 9121)))
  (assert (equal "玖仟貳佰" (jp-str/o 9200)))
  (assert (equal "玖仟貳佰壹" (jp-str/o 9201)))
  (assert (equal "玖仟貳佰拾" (jp-str/o 9210)))
  (assert (equal "玖仟貳佰拾壹" (jp-str/o 9211)))
  (assert (equal "玖仟貳佰貳拾" (jp-str/o 9220)))
  (assert (equal "玖仟貳佰貳拾壹" (jp-str/o 9221)))
  (assert (equal "玖仟玖佰玖拾玖" (jp-str/o 9999)))
  ;; 
  t)

(defun test-jp-old-integer-bignums ()
  ;; 10000 - 19999
  (assert (equal "壹萬" (jp-str/o 10000)))
  (assert (equal "壹萬壹" (jp-str/o 10001)))
  (assert (equal "壹萬玖" (jp-str/o 10009)))
  (assert (equal "壹萬拾" (jp-str/o 10010)))
  (assert (equal "壹萬拾壹" (jp-str/o 10011)))
  (assert (equal "壹萬拾玖" (jp-str/o 10019)))
  (assert (equal "壹萬貳拾" (jp-str/o 10020)))
  (assert (equal "壹萬貳拾壹" (jp-str/o 10021)))
  (assert (equal "壹萬貳拾玖" (jp-str/o 10029)))
  (assert (equal "壹萬壹佰" (jp-str/o 10100)))
  (assert (equal "壹萬壹佰壹" (jp-str/o 10101)))
  (assert (equal "壹萬壹佰玖" (jp-str/o 10109)))
  (assert (equal "壹萬壹佰拾" (jp-str/o 10110)))
  (assert (equal "壹萬壹佰拾壹" (jp-str/o 10111)))
  (assert (equal "壹萬壹佰拾玖" (jp-str/o 10119)))
  (assert (equal "壹萬壹佰貳拾" (jp-str/o 10120)))
  (assert (equal "壹萬壹佰貳拾壹" (jp-str/o 10121)))
  (assert (equal "壹萬壹佰貳拾玖" (jp-str/o 10129)))
  (assert (equal "壹萬貳佰" (jp-str/o 10200)))
  (assert (equal "壹萬貳佰壹" (jp-str/o 10201)))
  (assert (equal "壹萬貳佰玖" (jp-str/o 10209)))
  (assert (equal "壹萬貳佰拾" (jp-str/o 10210)))
  (assert (equal "壹萬貳佰拾壹" (jp-str/o 10211)))
  (assert (equal "壹萬貳佰拾玖" (jp-str/o 10219)))
  (assert (equal "壹萬貳佰貳拾" (jp-str/o 10220)))
  (assert (equal "壹萬貳佰貳拾壹" (jp-str/o 10221)))
  (assert (equal "壹萬貳佰貳拾玖" (jp-str/o 10229)))
  (assert (equal "壹萬壹仟" (jp-str/o 11000)))
  (assert (equal "壹萬壹仟壹" (jp-str/o 11001)))
  (assert (equal "壹萬壹仟玖" (jp-str/o 11009)))
  (assert (equal "壹萬壹仟拾" (jp-str/o 11010)))
  (assert (equal "壹萬壹仟拾壹" (jp-str/o 11011)))
  (assert (equal "壹萬壹仟拾玖" (jp-str/o 11019)))
  (assert (equal "壹萬壹仟貳拾" (jp-str/o 11020)))
  (assert (equal "壹萬壹仟貳拾壹" (jp-str/o 11021)))
  (assert (equal "壹萬壹仟貳拾玖" (jp-str/o 11029)))
  (assert (equal "壹萬壹仟壹佰" (jp-str/o 11100)))
  (assert (equal "壹萬壹仟壹佰壹" (jp-str/o 11101)))
  (assert (equal "壹萬壹仟壹佰玖" (jp-str/o 11109)))
  (assert (equal "壹萬壹仟壹佰拾" (jp-str/o 11110)))
  (assert (equal "壹萬壹仟壹佰拾壹" (jp-str/o 11111)))
  (assert (equal "壹萬壹仟壹佰拾玖" (jp-str/o 11119)))
  (assert (equal "壹萬壹仟壹佰貳拾" (jp-str/o 11120)))
  (assert (equal "壹萬壹仟壹佰貳拾壹" (jp-str/o 11121)))
  (assert (equal "壹萬壹仟壹佰貳拾玖" (jp-str/o 11129)))
  (assert (equal "壹萬壹仟貳佰" (jp-str/o 11200)))
  (assert (equal "壹萬壹仟貳佰壹" (jp-str/o 11201)))
  (assert (equal "壹萬壹仟貳佰玖" (jp-str/o 11209)))
  (assert (equal "壹萬壹仟貳佰拾" (jp-str/o 11210)))
  (assert (equal "壹萬壹仟貳佰拾壹" (jp-str/o 11211)))
  (assert (equal "壹萬壹仟貳佰拾玖" (jp-str/o 11219)))
  (assert (equal "壹萬壹仟貳佰貳拾" (jp-str/o 11220)))
  (assert (equal "壹萬壹仟貳佰貳拾壹" (jp-str/o 11221)))
  (assert (equal "壹萬壹仟貳佰貳拾玖" (jp-str/o 11229)))
  (assert (equal "壹萬貳仟" (jp-str/o 12000)))
  (assert (equal "壹萬貳仟壹" (jp-str/o 12001)))
  (assert (equal "壹萬貳仟玖" (jp-str/o 12009)))
  (assert (equal "壹萬貳仟拾" (jp-str/o 12010)))
  (assert (equal "壹萬貳仟拾壹" (jp-str/o 12011)))
  (assert (equal "壹萬貳仟拾玖" (jp-str/o 12019)))
  (assert (equal "壹萬貳仟貳拾" (jp-str/o 12020)))
  (assert (equal "壹萬貳仟貳拾壹" (jp-str/o 12021)))
  (assert (equal "壹萬貳仟貳拾玖" (jp-str/o 12029)))
  (assert (equal "壹萬貳仟壹佰" (jp-str/o 12100)))
  (assert (equal "壹萬貳仟壹佰壹" (jp-str/o 12101)))
  (assert (equal "壹萬貳仟壹佰玖" (jp-str/o 12109)))
  (assert (equal "壹萬貳仟壹佰拾" (jp-str/o 12110)))
  (assert (equal "壹萬貳仟壹佰拾壹" (jp-str/o 12111)))
  (assert (equal "壹萬貳仟壹佰拾玖" (jp-str/o 12119)))
  (assert (equal "壹萬貳仟壹佰貳拾" (jp-str/o 12120)))
  (assert (equal "壹萬貳仟壹佰貳拾壹" (jp-str/o 12121)))
  (assert (equal "壹萬貳仟壹佰貳拾玖" (jp-str/o 12129)))
  (assert (equal "壹萬貳仟貳佰" (jp-str/o 12200)))
  (assert (equal "壹萬貳仟貳佰壹" (jp-str/o 12201)))
  (assert (equal "壹萬貳仟貳佰玖" (jp-str/o 12209)))
  (assert (equal "壹萬貳仟貳佰拾" (jp-str/o 12210)))
  (assert (equal "壹萬貳仟貳佰拾壹" (jp-str/o 12211)))
  (assert (equal "壹萬貳仟貳佰拾玖" (jp-str/o 12219)))
  (assert (equal "壹萬貳仟貳佰貳拾" (jp-str/o 12220)))
  (assert (equal "壹萬貳仟貳佰貳拾壹" (jp-str/o 12221)))
  (assert (equal "壹萬貳仟貳佰貳拾玖" (jp-str/o 12229)))
  (assert (equal "壹萬玖仟玖佰玖拾玖" (jp-str/o 19999)))
  ;; 20000 - 99990000
  (assert (equal "貳萬" (jp-str/o 20000)))
  (assert (equal "玖萬" (jp-str/o 90000)))
  (assert (equal "拾萬" (jp-str/o 100000)))
  (assert (equal "拾壹萬" (jp-str/o 110000)))
  (assert (equal "拾玖萬" (jp-str/o 190000)))
  (assert (equal "貳拾萬" (jp-str/o 200000)))
  (assert (equal "貳拾壹萬" (jp-str/o 210000)))
  (assert (equal "貳拾玖萬" (jp-str/o 290000)))
  (assert (equal "壹佰萬" (jp-str/o 1000000)))
  (assert (equal "壹佰壹萬" (jp-str/o 1010000)))
  (assert (equal "壹佰玖萬" (jp-str/o 1090000)))
  (assert (equal "壹佰拾萬" (jp-str/o 1100000)))
  (assert (equal "壹佰拾壹萬" (jp-str/o 1110000)))
  (assert (equal "壹佰拾玖萬" (jp-str/o 1190000)))
  (assert (equal "壹佰貳拾萬" (jp-str/o 1200000)))
  (assert (equal "壹佰貳拾壹萬" (jp-str/o 1210000)))
  (assert (equal "壹佰貳拾玖萬" (jp-str/o 1290000)))
  (assert (equal "貳佰萬" (jp-str/o 2000000)))
  (assert (equal "貳佰壹萬" (jp-str/o 2010000)))
  (assert (equal "貳佰玖萬" (jp-str/o 2090000)))
  (assert (equal "貳佰拾萬" (jp-str/o 2100000)))
  (assert (equal "貳佰拾壹萬" (jp-str/o 2110000)))
  (assert (equal "貳佰拾玖萬" (jp-str/o 2190000)))
  (assert (equal "貳佰貳拾萬" (jp-str/o 2200000)))
  (assert (equal "貳佰貳拾壹萬" (jp-str/o 2210000)))
  (assert (equal "貳佰貳拾玖萬" (jp-str/o 2290000)))
  (assert (equal "壹仟萬" (jp-str/o 10000000)))
  (assert (equal "壹仟壹萬" (jp-str/o 10010000)))
  (assert (equal "壹仟玖萬" (jp-str/o 10090000)))
  (assert (equal "壹仟拾萬" (jp-str/o 10100000)))
  (assert (equal "壹仟拾壹萬" (jp-str/o 10110000)))
  (assert (equal "壹仟拾玖萬" (jp-str/o 10190000)))
  (assert (equal "壹仟貳拾萬" (jp-str/o 10200000)))
  (assert (equal "壹仟貳拾壹萬" (jp-str/o 10210000)))
  (assert (equal "壹仟貳拾玖萬" (jp-str/o 10290000)))
  (assert (equal "壹仟壹佰萬" (jp-str/o 11000000)))
  (assert (equal "壹仟壹佰壹萬" (jp-str/o 11010000)))
  (assert (equal "壹仟壹佰玖萬" (jp-str/o 11090000)))
  (assert (equal "壹仟壹佰拾萬" (jp-str/o 11100000)))
  (assert (equal "壹仟壹佰拾壹萬" (jp-str/o 11110000)))
  (assert (equal "壹仟壹佰拾玖萬" (jp-str/o 11190000)))
  (assert (equal "壹仟壹佰貳拾萬" (jp-str/o 11200000)))
  (assert (equal "壹仟壹佰貳拾壹萬" (jp-str/o 11210000)))
  (assert (equal "壹仟壹佰貳拾玖萬" (jp-str/o 11290000)))
  (assert (equal "壹仟貳佰萬" (jp-str/o 12000000)))
  (assert (equal "壹仟貳佰壹萬" (jp-str/o 12010000)))
  (assert (equal "壹仟貳佰玖萬" (jp-str/o 12090000)))
  (assert (equal "壹仟貳佰拾萬" (jp-str/o 12100000)))
  (assert (equal "壹仟貳佰拾壹萬" (jp-str/o 12110000)))
  (assert (equal "壹仟貳佰拾玖萬" (jp-str/o 12190000)))
  (assert (equal "壹仟貳佰貳拾萬" (jp-str/o 12200000)))
  (assert (equal "壹仟貳佰貳拾壹萬" (jp-str/o 12210000)))
  (assert (equal "壹仟貳佰貳拾玖萬" (jp-str/o 12290000)))
  (assert (equal "貳仟萬" (jp-str/o 20000000)))
  (assert (equal "貳仟壹萬" (jp-str/o 20010000)))
  (assert (equal "貳仟玖萬" (jp-str/o 20090000)))
  (assert (equal "貳仟拾萬" (jp-str/o 20100000)))
  (assert (equal "貳仟拾壹萬" (jp-str/o 20110000)))
  (assert (equal "貳仟拾玖萬" (jp-str/o 20190000)))
  (assert (equal "貳仟貳拾萬" (jp-str/o 20200000)))
  (assert (equal "貳仟貳拾壹萬" (jp-str/o 20210000)))
  (assert (equal "貳仟貳拾玖萬" (jp-str/o 20290000)))
  (assert (equal "貳仟壹佰萬" (jp-str/o 21000000)))
  (assert (equal "貳仟壹佰壹萬" (jp-str/o 21010000)))
  (assert (equal "貳仟壹佰玖萬" (jp-str/o 21090000)))
  (assert (equal "貳仟壹佰拾萬" (jp-str/o 21100000)))
  (assert (equal "貳仟壹佰拾壹萬" (jp-str/o 21110000)))
  (assert (equal "貳仟壹佰拾玖萬" (jp-str/o 21190000)))
  (assert (equal "貳仟壹佰貳拾萬" (jp-str/o 21200000)))
  (assert (equal "貳仟壹佰貳拾壹萬" (jp-str/o 21210000)))
  (assert (equal "貳仟壹佰貳拾玖萬" (jp-str/o 21290000)))
  (assert (equal "貳仟貳佰萬" (jp-str/o 22000000)))
  (assert (equal "貳仟貳佰壹萬" (jp-str/o 22010000)))
  (assert (equal "貳仟貳佰玖萬" (jp-str/o 22090000)))
  (assert (equal "貳仟貳佰拾萬" (jp-str/o 22100000)))
  (assert (equal "貳仟貳佰拾壹萬" (jp-str/o 22110000)))
  (assert (equal "貳仟貳佰拾玖萬" (jp-str/o 22190000)))
  (assert (equal "貳仟貳佰貳拾萬" (jp-str/o 22200000)))
  (assert (equal "貳仟貳佰貳拾壹萬" (jp-str/o 22210000)))
  (assert (equal "貳仟貳佰貳拾玖萬" (jp-str/o 22290000)))
  (assert (equal "玖仟玖佰玖拾玖萬" (jp-str/o 99990000)))
  ;; 100000000 - 100009999
  (assert (equal "壹億" (jp-str/o 100000000)))
  (assert (equal "壹億壹" (jp-str/o 100000001)))
  (assert (equal "壹億玖" (jp-str/o 100000009)))
  (assert (equal "壹億拾" (jp-str/o 100000010)))
  (assert (equal "壹億拾壹" (jp-str/o 100000011)))
  (assert (equal "壹億拾玖" (jp-str/o 100000019)))
  (assert (equal "壹億貳拾" (jp-str/o 100000020)))
  (assert (equal "壹億貳拾壹" (jp-str/o 100000021)))
  (assert (equal "壹億貳拾玖" (jp-str/o 100000029)))
  (assert (equal "壹億壹佰" (jp-str/o 100000100)))
  (assert (equal "壹億壹佰壹" (jp-str/o 100000101)))
  (assert (equal "壹億壹佰玖" (jp-str/o 100000109)))
  (assert (equal "壹億壹佰拾" (jp-str/o 100000110)))
  (assert (equal "壹億壹佰拾壹" (jp-str/o 100000111)))
  (assert (equal "壹億壹佰拾玖" (jp-str/o 100000119)))
  (assert (equal "壹億壹佰貳拾" (jp-str/o 100000120)))
  (assert (equal "壹億壹佰貳拾壹" (jp-str/o 100000121)))
  (assert (equal "壹億壹佰貳拾玖" (jp-str/o 100000129)))
  (assert (equal "壹億貳佰" (jp-str/o 100000200)))
  (assert (equal "壹億貳佰壹" (jp-str/o 100000201)))
  (assert (equal "壹億貳佰玖" (jp-str/o 100000209)))
  (assert (equal "壹億貳佰拾" (jp-str/o 100000210)))
  (assert (equal "壹億貳佰拾壹" (jp-str/o 100000211)))
  (assert (equal "壹億貳佰拾玖" (jp-str/o 100000219)))
  (assert (equal "壹億貳佰貳拾" (jp-str/o 100000220)))
  (assert (equal "壹億貳佰貳拾壹" (jp-str/o 100000221)))
  (assert (equal "壹億貳佰貳拾玖" (jp-str/o 100000229)))
  (assert (equal "壹億壹仟" (jp-str/o 100001000)))
  (assert (equal "壹億壹仟壹" (jp-str/o 100001001)))
  (assert (equal "壹億壹仟玖" (jp-str/o 100001009)))
  (assert (equal "壹億壹仟拾" (jp-str/o 100001010)))
  (assert (equal "壹億壹仟拾壹" (jp-str/o 100001011)))
  (assert (equal "壹億壹仟拾玖" (jp-str/o 100001019)))
  (assert (equal "壹億壹仟貳拾" (jp-str/o 100001020)))
  (assert (equal "壹億壹仟貳拾壹" (jp-str/o 100001021)))
  (assert (equal "壹億壹仟貳拾玖" (jp-str/o 100001029)))
  (assert (equal "壹億壹仟壹佰" (jp-str/o 100001100)))
  (assert (equal "壹億壹仟壹佰壹" (jp-str/o 100001101)))
  (assert (equal "壹億壹仟壹佰玖" (jp-str/o 100001109)))
  (assert (equal "壹億壹仟壹佰拾" (jp-str/o 100001110)))
  (assert (equal "壹億壹仟壹佰拾壹" (jp-str/o 100001111)))
  (assert (equal "壹億壹仟壹佰拾玖" (jp-str/o 100001119)))
  (assert (equal "壹億壹仟壹佰貳拾" (jp-str/o 100001120)))
  (assert (equal "壹億壹仟壹佰貳拾壹" (jp-str/o 100001121)))
  (assert (equal "壹億壹仟壹佰貳拾玖" (jp-str/o 100001129)))
  (assert (equal "壹億壹仟貳佰" (jp-str/o 100001200)))
  (assert (equal "壹億壹仟貳佰壹" (jp-str/o 100001201)))
  (assert (equal "壹億壹仟貳佰玖" (jp-str/o 100001209)))
  (assert (equal "壹億壹仟貳佰拾" (jp-str/o 100001210)))
  (assert (equal "壹億壹仟貳佰拾壹" (jp-str/o 100001211)))
  (assert (equal "壹億壹仟貳佰拾玖" (jp-str/o 100001219)))
  (assert (equal "壹億壹仟貳佰貳拾" (jp-str/o 100001220)))
  (assert (equal "壹億壹仟貳佰貳拾壹" (jp-str/o 100001221)))
  (assert (equal "壹億壹仟貳佰貳拾玖" (jp-str/o 100001229)))
  (assert (equal "壹億貳仟" (jp-str/o 100002000)))
  (assert (equal "壹億貳仟壹" (jp-str/o 100002001)))
  (assert (equal "壹億貳仟玖" (jp-str/o 100002009)))
  (assert (equal "壹億貳仟拾" (jp-str/o 100002010)))
  (assert (equal "壹億貳仟拾壹" (jp-str/o 100002011)))
  (assert (equal "壹億貳仟拾玖" (jp-str/o 100002019)))
  (assert (equal "壹億貳仟貳拾" (jp-str/o 100002020)))
  (assert (equal "壹億貳仟貳拾壹" (jp-str/o 100002021)))
  (assert (equal "壹億貳仟貳拾玖" (jp-str/o 100002029)))
  (assert (equal "壹億貳仟壹佰" (jp-str/o 100002100)))
  (assert (equal "壹億貳仟壹佰壹" (jp-str/o 100002101)))
  (assert (equal "壹億貳仟壹佰玖" (jp-str/o 100002109)))
  (assert (equal "壹億貳仟壹佰拾" (jp-str/o 100002110)))
  (assert (equal "壹億貳仟壹佰拾壹" (jp-str/o 100002111)))
  (assert (equal "壹億貳仟壹佰拾玖" (jp-str/o 100002119)))
  (assert (equal "壹億貳仟壹佰貳拾" (jp-str/o 100002120)))
  (assert (equal "壹億貳仟壹佰貳拾壹" (jp-str/o 100002121)))
  (assert (equal "壹億貳仟壹佰貳拾玖" (jp-str/o 100002129)))
  (assert (equal "壹億貳仟貳佰" (jp-str/o 100002200)))
  (assert (equal "壹億貳仟貳佰壹" (jp-str/o 100002201)))
  (assert (equal "壹億貳仟貳佰玖" (jp-str/o 100002209)))
  (assert (equal "壹億貳仟貳佰拾" (jp-str/o 100002210)))
  (assert (equal "壹億貳仟貳佰拾壹" (jp-str/o 100002211)))
  (assert (equal "壹億貳仟貳佰拾玖" (jp-str/o 100002219)))
  (assert (equal "壹億貳仟貳佰貳拾" (jp-str/o 100002220)))
  (assert (equal "壹億貳仟貳佰貳拾壹" (jp-str/o 100002221)))
  (assert (equal "壹億貳仟貳佰貳拾玖" (jp-str/o 100002229)))
  (assert (equal "壹億玖仟玖佰玖拾玖" (jp-str/o 100009999)))
  ;; 100010000 - 100019999
  (assert (equal "壹億壹萬" (jp-str/o 100010000)))
  (assert (equal "壹億壹萬壹" (jp-str/o 100010001)))
  (assert (equal "壹億壹萬玖" (jp-str/o 100010009)))
  (assert (equal "壹億壹萬拾" (jp-str/o 100010010)))
  (assert (equal "壹億壹萬拾壹" (jp-str/o 100010011)))
  (assert (equal "壹億壹萬拾玖" (jp-str/o 100010019)))
  (assert (equal "壹億壹萬貳拾" (jp-str/o 100010020)))
  (assert (equal "壹億壹萬貳拾壹" (jp-str/o 100010021)))
  (assert (equal "壹億壹萬貳拾玖" (jp-str/o 100010029)))
  (assert (equal "壹億壹萬壹佰" (jp-str/o 100010100)))
  (assert (equal "壹億壹萬壹佰壹" (jp-str/o 100010101)))
  (assert (equal "壹億壹萬壹佰玖" (jp-str/o 100010109)))
  (assert (equal "壹億壹萬壹佰拾" (jp-str/o 100010110)))
  (assert (equal "壹億壹萬壹佰拾壹" (jp-str/o 100010111)))
  (assert (equal "壹億壹萬壹佰拾玖" (jp-str/o 100010119)))
  (assert (equal "壹億壹萬壹佰貳拾" (jp-str/o 100010120)))
  (assert (equal "壹億壹萬壹佰貳拾壹" (jp-str/o 100010121)))
  (assert (equal "壹億壹萬壹佰貳拾玖" (jp-str/o 100010129)))
  (assert (equal "壹億壹萬貳佰" (jp-str/o 100010200)))
  (assert (equal "壹億壹萬貳佰壹" (jp-str/o 100010201)))
  (assert (equal "壹億壹萬貳佰玖" (jp-str/o 100010209)))
  (assert (equal "壹億壹萬貳佰拾" (jp-str/o 100010210)))
  (assert (equal "壹億壹萬貳佰拾壹" (jp-str/o 100010211)))
  (assert (equal "壹億壹萬貳佰拾玖" (jp-str/o 100010219)))
  (assert (equal "壹億壹萬貳佰貳拾" (jp-str/o 100010220)))
  (assert (equal "壹億壹萬貳佰貳拾壹" (jp-str/o 100010221)))
  (assert (equal "壹億壹萬貳佰貳拾玖" (jp-str/o 100010229)))
  (assert (equal "壹億壹萬壹仟" (jp-str/o 100011000)))
  (assert (equal "壹億壹萬壹仟壹" (jp-str/o 100011001)))
  (assert (equal "壹億壹萬壹仟玖" (jp-str/o 100011009)))
  (assert (equal "壹億壹萬壹仟拾" (jp-str/o 100011010)))
  (assert (equal "壹億壹萬壹仟拾壹" (jp-str/o 100011011)))
  (assert (equal "壹億壹萬壹仟拾玖" (jp-str/o 100011019)))
  (assert (equal "壹億壹萬壹仟貳拾" (jp-str/o 100011020)))
  (assert (equal "壹億壹萬壹仟貳拾壹" (jp-str/o 100011021)))
  (assert (equal "壹億壹萬壹仟貳拾玖" (jp-str/o 100011029)))
  (assert (equal "壹億壹萬壹仟壹佰" (jp-str/o 100011100)))
  (assert (equal "壹億壹萬壹仟壹佰壹" (jp-str/o 100011101)))
  (assert (equal "壹億壹萬壹仟壹佰玖" (jp-str/o 100011109)))
  (assert (equal "壹億壹萬壹仟壹佰拾" (jp-str/o 100011110)))
  (assert (equal "壹億壹萬壹仟壹佰拾壹" (jp-str/o 100011111)))
  (assert (equal "壹億壹萬壹仟壹佰拾玖" (jp-str/o 100011119)))
  (assert (equal "壹億壹萬壹仟壹佰貳拾" (jp-str/o 100011120)))
  (assert (equal "壹億壹萬壹仟壹佰貳拾壹" (jp-str/o 100011121)))
  (assert (equal "壹億壹萬壹仟壹佰貳拾玖" (jp-str/o 100011129)))
  (assert (equal "壹億壹萬壹仟貳佰" (jp-str/o 100011200)))
  (assert (equal "壹億壹萬壹仟貳佰壹" (jp-str/o 100011201)))
  (assert (equal "壹億壹萬壹仟貳佰玖" (jp-str/o 100011209)))
  (assert (equal "壹億壹萬壹仟貳佰拾" (jp-str/o 100011210)))
  (assert (equal "壹億壹萬壹仟貳佰拾壹" (jp-str/o 100011211)))
  (assert (equal "壹億壹萬壹仟貳佰拾玖" (jp-str/o 100011219)))
  (assert (equal "壹億壹萬壹仟貳佰貳拾" (jp-str/o 100011220)))
  (assert (equal "壹億壹萬壹仟貳佰貳拾壹" (jp-str/o 100011221)))
  (assert (equal "壹億壹萬壹仟貳佰貳拾玖" (jp-str/o 100011229)))
  (assert (equal "壹億壹萬貳仟" (jp-str/o 100012000)))
  (assert (equal "壹億壹萬貳仟壹" (jp-str/o 100012001)))
  (assert (equal "壹億壹萬貳仟玖" (jp-str/o 100012009)))
  (assert (equal "壹億壹萬貳仟拾" (jp-str/o 100012010)))
  (assert (equal "壹億壹萬貳仟拾壹" (jp-str/o 100012011)))
  (assert (equal "壹億壹萬貳仟拾玖" (jp-str/o 100012019)))
  (assert (equal "壹億壹萬貳仟貳拾" (jp-str/o 100012020)))
  (assert (equal "壹億壹萬貳仟貳拾壹" (jp-str/o 100012021)))
  (assert (equal "壹億壹萬貳仟貳拾玖" (jp-str/o 100012029)))
  (assert (equal "壹億壹萬貳仟壹佰" (jp-str/o 100012100)))
  (assert (equal "壹億壹萬貳仟壹佰壹" (jp-str/o 100012101)))
  (assert (equal "壹億壹萬貳仟壹佰玖" (jp-str/o 100012109)))
  (assert (equal "壹億壹萬貳仟壹佰拾" (jp-str/o 100012110)))
  (assert (equal "壹億壹萬貳仟壹佰拾壹" (jp-str/o 100012111)))
  (assert (equal "壹億壹萬貳仟壹佰拾玖" (jp-str/o 100012119)))
  (assert (equal "壹億壹萬貳仟壹佰貳拾" (jp-str/o 100012120)))
  (assert (equal "壹億壹萬貳仟壹佰貳拾壹" (jp-str/o 100012121)))
  (assert (equal "壹億壹萬貳仟壹佰貳拾玖" (jp-str/o 100012129)))
  (assert (equal "壹億壹萬貳仟貳佰" (jp-str/o 100012200)))
  (assert (equal "壹億壹萬貳仟貳佰壹" (jp-str/o 100012201)))
  (assert (equal "壹億壹萬貳仟貳佰玖" (jp-str/o 100012209)))
  (assert (equal "壹億壹萬貳仟貳佰拾" (jp-str/o 100012210)))
  (assert (equal "壹億壹萬貳仟貳佰拾壹" (jp-str/o 100012211)))
  (assert (equal "壹億壹萬貳仟貳佰拾玖" (jp-str/o 100012219)))
  (assert (equal "壹億壹萬貳仟貳佰貳拾" (jp-str/o 100012220)))
  (assert (equal "壹億壹萬貳仟貳佰貳拾壹" (jp-str/o 100012221)))
  (assert (equal "壹億壹萬貳仟貳佰貳拾玖" (jp-str/o 100012229)))
  (assert (equal "壹億壹萬玖仟玖佰玖拾玖" (jp-str/o 100019999)))
  ;; 100020000 - 199990000
  (assert (equal "壹億貳萬" (jp-str/o 100020000)))
  (assert (equal "壹億玖萬" (jp-str/o 100090000)))
  (assert (equal "壹億拾萬" (jp-str/o 100100000)))
  (assert (equal "壹億拾壹萬" (jp-str/o 100110000)))
  (assert (equal "壹億拾玖萬" (jp-str/o 100190000)))
  (assert (equal "壹億貳拾萬" (jp-str/o 100200000)))
  (assert (equal "壹億貳拾壹萬" (jp-str/o 100210000)))
  (assert (equal "壹億貳拾玖萬" (jp-str/o 100290000)))
  (assert (equal "壹億壹佰萬" (jp-str/o 101000000)))
  (assert (equal "壹億壹佰壹萬" (jp-str/o 101010000)))
  (assert (equal "壹億壹佰玖萬" (jp-str/o 101090000)))
  (assert (equal "壹億壹佰拾萬" (jp-str/o 101100000)))
  (assert (equal "壹億壹佰拾壹萬" (jp-str/o 101110000)))
  (assert (equal "壹億壹佰拾玖萬" (jp-str/o 101190000)))
  (assert (equal "壹億壹佰貳拾萬" (jp-str/o 101200000)))
  (assert (equal "壹億壹佰貳拾壹萬" (jp-str/o 101210000)))
  (assert (equal "壹億壹佰貳拾玖萬" (jp-str/o 101290000)))
  (assert (equal "壹億貳佰萬" (jp-str/o 102000000)))
  (assert (equal "壹億貳佰壹萬" (jp-str/o 102010000)))
  (assert (equal "壹億貳佰玖萬" (jp-str/o 102090000)))
  (assert (equal "壹億貳佰拾萬" (jp-str/o 102100000)))
  (assert (equal "壹億貳佰拾壹萬" (jp-str/o 102110000)))
  (assert (equal "壹億貳佰拾玖萬" (jp-str/o 102190000)))
  (assert (equal "壹億貳佰貳拾萬" (jp-str/o 102200000)))
  (assert (equal "壹億貳佰貳拾壹萬" (jp-str/o 102210000)))
  (assert (equal "壹億貳佰貳拾玖萬" (jp-str/o 102290000)))
  (assert (equal "壹億壹仟萬" (jp-str/o 110000000)))
  (assert (equal "壹億壹仟壹萬" (jp-str/o 110010000)))
  (assert (equal "壹億壹仟玖萬" (jp-str/o 110090000)))
  (assert (equal "壹億壹仟拾萬" (jp-str/o 110100000)))
  (assert (equal "壹億壹仟拾壹萬" (jp-str/o 110110000)))
  (assert (equal "壹億壹仟拾玖萬" (jp-str/o 110190000)))
  (assert (equal "壹億壹仟貳拾萬" (jp-str/o 110200000)))
  (assert (equal "壹億壹仟貳拾壹萬" (jp-str/o 110210000)))
  (assert (equal "壹億壹仟貳拾玖萬" (jp-str/o 110290000)))
  (assert (equal "壹億壹仟壹佰萬" (jp-str/o 111000000)))
  (assert (equal "壹億壹仟壹佰壹萬" (jp-str/o 111010000)))
  (assert (equal "壹億壹仟壹佰玖萬" (jp-str/o 111090000)))
  (assert (equal "壹億壹仟壹佰拾萬" (jp-str/o 111100000)))
  (assert (equal "壹億壹仟壹佰拾壹萬" (jp-str/o 111110000)))
  (assert (equal "壹億壹仟壹佰拾玖萬" (jp-str/o 111190000)))
  (assert (equal "壹億壹仟壹佰貳拾萬" (jp-str/o 111200000)))
  (assert (equal "壹億壹仟壹佰貳拾壹萬" (jp-str/o 111210000)))
  (assert (equal "壹億壹仟壹佰貳拾玖萬" (jp-str/o 111290000)))
  (assert (equal "壹億壹仟貳佰萬" (jp-str/o 112000000)))
  (assert (equal "壹億壹仟貳佰壹萬" (jp-str/o 112010000)))
  (assert (equal "壹億壹仟貳佰玖萬" (jp-str/o 112090000)))
  (assert (equal "壹億壹仟貳佰拾萬" (jp-str/o 112100000)))
  (assert (equal "壹億壹仟貳佰拾壹萬" (jp-str/o 112110000)))
  (assert (equal "壹億壹仟貳佰拾玖萬" (jp-str/o 112190000)))
  (assert (equal "壹億壹仟貳佰貳拾萬" (jp-str/o 112200000)))
  (assert (equal "壹億壹仟貳佰貳拾壹萬" (jp-str/o 112210000)))
  (assert (equal "壹億壹仟貳佰貳拾玖萬" (jp-str/o 112290000)))
  (assert (equal "壹億貳仟萬" (jp-str/o 120000000)))
  (assert (equal "壹億貳仟壹萬" (jp-str/o 120010000)))
  (assert (equal "壹億貳仟玖萬" (jp-str/o 120090000)))
  (assert (equal "壹億貳仟拾萬" (jp-str/o 120100000)))
  (assert (equal "壹億貳仟拾壹萬" (jp-str/o 120110000)))
  (assert (equal "壹億貳仟拾玖萬" (jp-str/o 120190000)))
  (assert (equal "壹億貳仟貳拾萬" (jp-str/o 120200000)))
  (assert (equal "壹億貳仟貳拾壹萬" (jp-str/o 120210000)))
  (assert (equal "壹億貳仟貳拾玖萬" (jp-str/o 120290000)))
  (assert (equal "壹億貳仟壹佰萬" (jp-str/o 121000000)))
  (assert (equal "壹億貳仟壹佰壹萬" (jp-str/o 121010000)))
  (assert (equal "壹億貳仟壹佰玖萬" (jp-str/o 121090000)))
  (assert (equal "壹億貳仟壹佰拾萬" (jp-str/o 121100000)))
  (assert (equal "壹億貳仟壹佰拾壹萬" (jp-str/o 121110000)))
  (assert (equal "壹億貳仟壹佰拾玖萬" (jp-str/o 121190000)))
  (assert (equal "壹億貳仟壹佰貳拾萬" (jp-str/o 121200000)))
  (assert (equal "壹億貳仟壹佰貳拾壹萬" (jp-str/o 121210000)))
  (assert (equal "壹億貳仟壹佰貳拾玖萬" (jp-str/o 121290000)))
  (assert (equal "壹億貳仟貳佰萬" (jp-str/o 122000000)))
  (assert (equal "壹億貳仟貳佰壹萬" (jp-str/o 122010000)))
  (assert (equal "壹億貳仟貳佰玖萬" (jp-str/o 122090000)))
  (assert (equal "壹億貳仟貳佰拾萬" (jp-str/o 122100000)))
  (assert (equal "壹億貳仟貳佰拾壹萬" (jp-str/o 122110000)))
  (assert (equal "壹億貳仟貳佰拾玖萬" (jp-str/o 122190000)))
  (assert (equal "壹億貳仟貳佰貳拾萬" (jp-str/o 122200000)))
  (assert (equal "壹億貳仟貳佰貳拾壹萬" (jp-str/o 122210000)))
  (assert (equal "壹億貳仟貳佰貳拾玖萬" (jp-str/o 122290000)))
  (assert (equal "壹億玖仟玖佰玖拾玖萬" (jp-str/o 199990000)))

  ;; more big nums
  (let ((num 12300001001))
    (assert (equal "壹佰貳拾參億壹仟壹" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參兆壹仟壹萬" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參京壹仟壹億" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參垓壹仟壹兆" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參秭壹仟壹京" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參穣壹仟壹垓" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參溝壹仟壹秭" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參澗壹仟壹穣" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參正壹仟壹溝" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參載壹仟壹澗" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參極壹仟壹正" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參恒河沙壹仟壹載" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參阿僧祇壹仟壹極" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參那由他壹仟壹恒河沙" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參不可思議壹仟壹阿僧祇" (jp-str/o num)))
    (mulf num 10000)
    (assert (equal "壹佰貳拾參無量大数壹仟壹那由他" (jp-str/o num))))
  ;; 
  t)

(defun test-jp-old-integer-minus ()
  (assert (equal "負之壹" (jp-str/o -1)))
  (assert (equal "負之貳" (jp-str/o -2)))
  (assert (equal "負之參" (jp-str/o -3)))
  (assert (equal "負之肆" (jp-str/o -4)))
  (assert (equal "負之伍" (jp-str/o -5)))
  (assert (equal "負之陸" (jp-str/o -6)))
  (assert (equal "負之柒" (jp-str/o -7)))
  (assert (equal "負之捌" (jp-str/o -8)))
  (assert (equal "負之玖" (jp-str/o -9)))
  (assert (equal "負之拾" (jp-str/o -10)))
  (assert (equal "負之貳拾" (jp-str/o -20)))
  (assert (equal "負之壹佰" (jp-str/o -100)))
  (assert (equal "負之伍佰" (jp-str/o -500)))
  (assert (equal "負之壹仟" (jp-str/o -1000)))
  (assert (equal "負之壹萬" (jp-str/o -10000)))
  (assert (equal "負之壹萬貳仟參佰肆拾伍" (jp-str/o -12345)))
  ;; 
  t)
  
(defun test-jp-old-rational ()
  (assert (equal "貳分之壹" (jp-str/o 1/2)))
  (assert (equal "拾分之壹" (jp-str/o 1/10)))
  (assert (equal "貳拾分之壹" (jp-str/o 1/20)))
  (assert (equal "壹佰分之壹" (jp-str/o 1/100)))
  (assert (equal "壹佰拾分之壹" (jp-str/o 1/110)))
  (assert (equal "壹佰拾壹分之壹" (jp-str/o 1/111)))
  (assert (equal "壹佰貳拾分之壹" (jp-str/o 1/120)))
  (assert (equal "壹佰貳拾壹分之壹" (jp-str/o 1/121)))
  (assert (equal "貳佰分之壹" (jp-str/o 1/200)))
  (assert (equal "貳佰拾分之壹" (jp-str/o 1/210)))
  (assert (equal "貳佰拾壹分之壹" (jp-str/o 1/211)))
  (assert (equal "貳佰貳拾分之壹" (jp-str/o 1/220)))
  (assert (equal "貳佰貳拾壹分之壹" (jp-str/o 1/221)))
  (assert (equal "壹仟分之壹" (jp-str/o 1/1000)))
  (assert (equal "壹仟拾分之壹" (jp-str/o 1/1010)))
  (assert (equal "壹仟拾壹分之壹" (jp-str/o 1/1011)))
  (assert (equal "壹仟貳拾分之壹" (jp-str/o 1/1020)))
  (assert (equal "壹仟貳拾壹分之壹" (jp-str/o 1/1021)))
  (assert (equal "壹仟壹佰分之壹" (jp-str/o 1/1100)))
  (assert (equal "壹仟壹佰拾分之壹" (jp-str/o 1/1110)))
  (assert (equal "壹仟壹佰拾壹分之壹" (jp-str/o 1/1111)))
  (assert (equal "壹仟壹佰貳拾分之壹" (jp-str/o 1/1120)))
  (assert (equal "壹仟壹佰貳拾壹分之壹" (jp-str/o 1/1121)))
  (assert (equal "貳仟貳佰壹分之壹" (jp-str/o 1/2201)))
  (assert (equal "壹萬分之壹" (jp-str/o 1/10000)))
  (assert (equal "壹萬壹仟壹佰拾壹分之壹" (jp-str/o 1/11111)))
  (assert (equal "貳萬貳仟貳佰貳拾貳分之壹" (jp-str/o 1/22222)))
  (assert (equal "壹億分之壹" (jp-str/o 1/100000000)))

  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹" (jp-str/o 1/19997))) ; 19997 is a prime.
  (assert (equal "壹萬玖仟玖佰玖拾柒分之貳" (jp-str/o 2/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之拾" (jp-str/o 10/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之拾壹" (jp-str/o 11/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之貳拾壹" (jp-str/o 21/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之玖拾玖" (jp-str/o 99/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹佰" (jp-str/o 100/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹佰壹" (jp-str/o 101/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹佰拾壹" (jp-str/o 111/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之貳佰拾壹" (jp-str/o 211/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹仟壹" (jp-str/o 1001/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹仟壹佰拾壹" (jp-str/o 1111/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之貳仟貳佰貳拾貳" (jp-str/o 2222/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹萬" (jp-str/o 10000/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹萬壹" (jp-str/o 10001/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹萬壹仟壹佰拾" (jp-str/o 11110/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹萬伍仟貳" (jp-str/o 15002/19997)))
  (assert (equal "壹萬玖仟玖佰玖拾柒分之壹萬玖仟玖佰玖拾陸" (jp-str/o 19996/19997)))

  (assert (equal "負之貳分之壹" (jp-str/o -1/2)))
  ;; 
  t)
  
(defun test-jp-old-float ()
  ;; 0.1-0.9
  (assert (equal "壹分" (jp-str/o 0.1)))
  (assert (equal "貳分" (jp-str/o 0.2)))
  (assert (equal "參分" (jp-str/o 0.3)))
  (assert (equal "肆分" (jp-str/o 0.4)))
  (assert (equal "伍分" (jp-str/o 0.5)))
  (assert (equal "陸分" (jp-str/o 0.6)))
  (assert (equal "柒分" (jp-str/o 0.7)))
  (assert (equal "捌分" (jp-str/o 0.8)))
  (assert (equal "玖分" (jp-str/o 0.9)))
  ;; 0.10-0.30
  (assert (equal "壹分" (jp-str/o 0.10)))
  (assert (equal "壹分壹釐" (jp-str/o 0.11)))
  (assert (equal "壹分貳釐" (jp-str/o 0.12)))
  (assert (equal "壹分參釐" (jp-str/o 0.13)))
  (assert (equal "壹分肆釐" (jp-str/o 0.14)))
  (assert (equal "壹分伍釐" (jp-str/o 0.15)))
  (assert (equal "壹分陸釐" (jp-str/o 0.16)))
  (assert (equal "壹分柒釐" (jp-str/o 0.17)))
  (assert (equal "壹分捌釐" (jp-str/o 0.18)))
  (assert (equal "壹分玖釐" (jp-str/o 0.19)))
  (assert (equal "貳分" (jp-str/o 0.20)))
  (assert (equal "貳分壹釐" (jp-str/o 0.21)))
  (assert (equal "貳分貳釐" (jp-str/o 0.22)))
  (assert (equal "貳分參釐" (jp-str/o 0.23)))
  (assert (equal "貳分肆釐" (jp-str/o 0.24)))
  (assert (equal "貳分伍釐" (jp-str/o 0.25)))
  (assert (equal "貳分陸釐" (jp-str/o 0.26)))
  (assert (equal "貳分柒釐" (jp-str/o 0.27)))
  (assert (equal "貳分捌釐" (jp-str/o 0.28)))
  (assert (equal "貳分玖釐" (jp-str/o 0.29)))
  (assert (equal "參分" (jp-str/o 0.30)))
  ;; small nums
  (assert (equal "拾・參分肆釐" (jp-str/o 10.34)))
  (assert (equal "壹・參釐肆毫" (jp-str/o 1.034)))
  (assert (equal "壹分參毫肆絲" (jp-str/o 0.1034)))
  (assert (equal "壹釐參絲肆忽" (jp-str/o 0.01034)))
  (assert (equal "壹毫參忽肆微" (jp-str/o 0.001034)))
  (assert (equal "壹絲參微肆繊" (jp-str/o 0.0001034)))
  (assert (equal "壹忽參繊肆沙" (jp-str/o 0.00001034)))
  (assert (equal "壹微參沙肆塵" (jp-str/o 0.000001034)))
  (assert (equal "壹繊參塵肆埃" (jp-str/o 0.0000001034)))
  (assert (equal "壹沙參埃肆渺" (jp-str/o 0.00000001034)))
  (assert (equal "壹塵參渺肆漠" (jp-str/o 0.000000001034)))
  (assert (equal "壹埃參漠肆模糊" (jp-str/o 0.0000000001034)))
  (assert (equal "壹渺參模糊肆逡巡" (jp-str/o 0.00000000001034)))
  (assert (equal "壹漠參逡巡肆須臾" (jp-str/o 0.000000000001034)))
  (assert (equal "壹模糊參須臾肆瞬息" (jp-str/o 0.0000000000001034)))
  (assert (equal "壹逡巡參瞬息肆弾指" (jp-str/o 0.00000000000001034)))
  (assert (equal "壹須臾參弾指肆刹那" (jp-str/o 0.000000000000001034)))
  (assert (equal "壹瞬息參刹那肆六徳" (jp-str/o 0.0000000000000001034)))
  (assert (equal "壹弾指參六徳肆虚空" (jp-str/o 0.00000000000000001034)))
  (assert (equal "壹刹那參虚空肆清浄" (jp-str/o 0.000000000000000001034)))
  ;; minus
  (assert (equal "負之壹分" (jp-str/o -0.1)))
  (assert (equal "負之貳分" (jp-str/o -0.2)))
  (assert (equal "負之壹分壹釐" (jp-str/o -0.11)))
  (assert (equal "負之貳釐" (jp-str/o -0.02)))
  (assert (equal "負之壹・壹分" (jp-str/o -1.1)))
  (assert (equal "負之壹・壹釐" (jp-str/o -1.01)))
  ;;
  t)

(defun test-jp-old-fallback ()
  ;; too big num
  (assert (equal "壹無量大数" (jp-str/o (expt 10 68))))
  (assert (equal "一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
		 (jp-str/o (expt 10 72))))
  (assert (equal "負之壹無量大数" (jp-str/o (- (expt 10 68)))))
  (assert (equal "−一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
		 (jp-str/o (- (expt 10 72)))))
  ;; too small num
  (assert (equal "壹清浄" (jp-str/o 0.000000000000000000001)))
  (assert (equal (format nil "~A" 0.0000000000000000000001)
  		 (jp-str/o 0.0000000000000000000001)))
  (assert (equal "負之壹清浄" (jp-str/o -0.000000000000000000001)))
  (assert (equal (format nil "~A" -0.0000000000000000000001)
  		 (jp-str/o -0.0000000000000000000001)))
  ;; complex
  (assert (equal (format nil "~A" #c(1 1))
  		 (jp-str/o #c(1 1))))
  ;;
  t)

(defun test-jp-old-parameters ()
  ;; [Integer]
  ;; digits-after-dot -- ignored
  (assert (equal "壹" (jp-str/o 1 :digits-after-dot nil)))
  (assert (equal "壹" (jp-str/o 1 :digits-after-dot 0)))
  (assert (equal "壹" (jp-str/o 1 :digits-after-dot 1)))
  (assert (equal "壹" (jp-str/o 1 :digits-after-dot -1)))
  ;; scale
  (assert (equal "壹" (jp-str/o 1 :scale nil)))
  (assert (equal "壹" (jp-str/o 1 :scale 0)))
  (assert (equal "拾" (jp-str/o 1 :scale 1)))
  (assert (equal "拾分之壹" (jp-str/o 1 :scale -1)))
  ;; radix-point
  (assert (equal "壹" (jp-str/o 1 :radix-point nil)))
  (assert (equal "壹a" (jp-str/o 1 :radix-point #\a)))
  (assert (equal "壹abc" (jp-str/o 1 :radix-point "abc")))

  ;; [Rational]
  ;; digits-after-dot -- ignored
  (assert (equal "貳分之壹" (jp-str/o 1/2 :digits-after-dot nil)))
  (assert (equal "貳分之壹" (jp-str/o 1/2 :digits-after-dot 0)))
  (assert (equal "貳分之壹" (jp-str/o 1/2 :digits-after-dot 1)))
  (assert (equal "貳分之壹" (jp-str/o 1/2 :digits-after-dot -1)))
  ;; scale
  (assert (equal "貳分之壹" (jp-str/o 1/2 :scale nil)))
  (assert (equal "貳分之壹" (jp-str/o 1/2 :scale 0)))
  (assert (equal "伍" (jp-str/o 1/2 :scale 1)))
  (assert (equal "貳拾分之壹" (jp-str/o 1/2 :scale -1)))
  ;; radix-point
  (assert (equal "貳分之壹" (jp-str/o 1/2 :radix-point nil)))
  (assert (equal "貳分之壹a" (jp-str/o 1/2 :radix-point #\a)))
  (assert (equal "貳分之壹abc" (jp-str/o 1/2 :radix-point "abc")))

  ;; [Float]
  ;; digits-after-dot
  (assert (equal "拾貳・參分肆釐" (jp-str/o 12.34 :digits-after-dot nil)))
  (assert (equal "拾貳" (jp-str/o 12.34 :digits-after-dot 0)))
  (assert (equal "拾貳・參分" (jp-str/o 12.34 :digits-after-dot 1)))
  (assert (equal "拾貳・參分肆釐" (jp-str/o 12.34 :digits-after-dot 2)))
  (assert (equal "拾貳・參分肆釐" (jp-str/o 12.34 :digits-after-dot 3)))
  (assert (equal "拾" (jp-str/o 12.34 :digits-after-dot -1)))
  (assert (equal "零" (jp-str/o 12.34 :digits-after-dot -2)))
  ;; scale
  (assert (equal "拾貳・參分肆釐" (jp-str/o 12.34 :scale nil)))
  (assert (equal "拾貳・參分肆釐" (jp-str/o 12.34 :scale 0)))
  (assert (equal "壹佰貳拾參・肆分" (jp-str/o 12.34 :scale 1)))
  (assert (equal "壹仟貳佰參拾肆" (jp-str/o 12.34 :scale 2)))
  (assert (equal "壹・貳分參釐肆毫" (jp-str/o 12.34 :scale -1)))
  (assert (equal "壹分貳釐參毫肆絲" (jp-str/o 12.34 :scale -2)))
  ;; radix-point
  (assert (equal "拾貳・參分肆釐" (jp-str/o 12.34 :radix-point nil)))
  (assert (equal "拾貳a參分肆釐" (jp-str/o 12.34 :radix-point #\a)))
  (assert (equal "拾貳abc參分肆釐" (jp-str/o 12.34 :radix-point "abc")))
  (assert (equal "壹仟貳佰參拾肆abc" (jp-str/o 12.34 :radix-point "abc" :scale 2)))
  (assert (equal "零abc壹分貳釐參毫肆絲" (jp-str/o 12.34 :radix-point "abc" :scale -2)))
  ;; 
  t)

(defun test-jp-old ()
  (and (test-jp-old-integer-4digits)
       (test-jp-old-integer-bignums)
       (test-jp-old-integer-minus)
       (test-jp-old-rational)
       (test-jp-old-float)
       (test-jp-old-fallback)
       (test-jp-old-parameters)
       t))
