;;; -*- coding: utf-8; -*-

(in-package :jp-numeral.test)

(test test-jp-positional-integer-4digits
  ;; 0
  (is (equal "〇" (jp-str :positional 0)))
  ;; 1-9
  (is (equal "一" (jp-str :positional 1)))
  (is (equal "二" (jp-str :positional 2)))
  (is (equal "三" (jp-str :positional 3)))
  (is (equal "四" (jp-str :positional 4)))
  (is (equal "五" (jp-str :positional 5)))
  (is (equal "六" (jp-str :positional 6)))
  (is (equal "七" (jp-str :positional 7)))
  (is (equal "八" (jp-str :positional 8)))
  (is (equal "九" (jp-str :positional 9)))
  ;; 10-19
  (is (equal "一〇" (jp-str :positional 10)))
  (is (equal "一一" (jp-str :positional 11)))
  (is (equal "一二" (jp-str :positional 12)))
  (is (equal "一三" (jp-str :positional 13)))
  (is (equal "一四" (jp-str :positional 14)))
  (is (equal "一五" (jp-str :positional 15)))
  (is (equal "一六" (jp-str :positional 16)))
  (is (equal "一七" (jp-str :positional 17)))
  (is (equal "一八" (jp-str :positional 18)))
  (is (equal "一九" (jp-str :positional 19)))
  ;; 20-99
  (is (equal "二〇" (jp-str :positional 20)))
  (is (equal "二一" (jp-str :positional 21)))
  (is (equal "二九" (jp-str :positional 29)))
  (is (equal "三〇" (jp-str :positional 30)))
  (is (equal "三一" (jp-str :positional 31)))
  (is (equal "三九" (jp-str :positional 39)))
  (is (equal "四〇" (jp-str :positional 40)))
  (is (equal "四一" (jp-str :positional 41)))
  (is (equal "四九" (jp-str :positional 49)))
  (is (equal "五〇" (jp-str :positional 50)))
  (is (equal "五一" (jp-str :positional 51)))
  (is (equal "五九" (jp-str :positional 59)))
  (is (equal "六〇" (jp-str :positional 60)))
  (is (equal "六一" (jp-str :positional 61)))
  (is (equal "六九" (jp-str :positional 69)))
  (is (equal "七〇" (jp-str :positional 70)))
  (is (equal "七一" (jp-str :positional 71)))
  (is (equal "七九" (jp-str :positional 79)))
  (is (equal "八〇" (jp-str :positional 80)))
  (is (equal "八一" (jp-str :positional 81)))
  (is (equal "八九" (jp-str :positional 89)))
  (is (equal "九〇" (jp-str :positional 90)))
  (is (equal "九一" (jp-str :positional 91)))
  (is (equal "九九" (jp-str :positional 99)))
  ;; 100
  (is (equal "一〇〇" (jp-str :positional 100)))
  ;; 101-109
  (is (equal "一〇一" (jp-str :positional 101)))
  (is (equal "一〇二" (jp-str :positional 102)))
  (is (equal "一〇三" (jp-str :positional 103)))
  (is (equal "一〇四" (jp-str :positional 104)))
  (is (equal "一〇五" (jp-str :positional 105)))
  (is (equal "一〇六" (jp-str :positional 106)))
  (is (equal "一〇七" (jp-str :positional 107)))
  (is (equal "一〇八" (jp-str :positional 108)))
  (is (equal "一〇九" (jp-str :positional 109)))
  ;; 110-119
  (is (equal "一一〇" (jp-str :positional 110)))
  (is (equal "一一一" (jp-str :positional 111)))
  (is (equal "一一二" (jp-str :positional 112)))
  (is (equal "一一三" (jp-str :positional 113)))
  (is (equal "一一四" (jp-str :positional 114)))
  (is (equal "一一五" (jp-str :positional 115)))
  (is (equal "一一六" (jp-str :positional 116)))
  (is (equal "一一七" (jp-str :positional 117)))
  (is (equal "一一八" (jp-str :positional 118)))
  (is (equal "一一九" (jp-str :positional 119)))
  ;; 120-199
  (is (equal "一二〇" (jp-str :positional 120)))
  (is (equal "一二一" (jp-str :positional 121)))
  (is (equal "一二九" (jp-str :positional 129)))
  (is (equal "一三〇" (jp-str :positional 130)))
  (is (equal "一三一" (jp-str :positional 131)))
  (is (equal "一三九" (jp-str :positional 139)))
  (is (equal "一四〇" (jp-str :positional 140)))
  (is (equal "一四一" (jp-str :positional 141)))
  (is (equal "一四九" (jp-str :positional 149)))
  (is (equal "一五〇" (jp-str :positional 150)))
  (is (equal "一五一" (jp-str :positional 151)))
  (is (equal "一五九" (jp-str :positional 159)))
  (is (equal "一六〇" (jp-str :positional 160)))
  (is (equal "一六一" (jp-str :positional 161)))
  (is (equal "一六九" (jp-str :positional 169)))
  (is (equal "一七〇" (jp-str :positional 170)))
  (is (equal "一七一" (jp-str :positional 171)))
  (is (equal "一七九" (jp-str :positional 179)))
  (is (equal "一八〇" (jp-str :positional 180)))
  (is (equal "一八一" (jp-str :positional 181)))
  (is (equal "一八九" (jp-str :positional 189)))
  (is (equal "一九〇" (jp-str :positional 190)))
  (is (equal "一九一" (jp-str :positional 191)))
  (is (equal "一九九" (jp-str :positional 199)))
  ;; 200-999
  (is (equal "二〇〇" (jp-str :positional 200)))
  (is (equal "二〇一" (jp-str :positional 201)))
  (is (equal "二〇九" (jp-str :positional 209)))
  (is (equal "二一〇" (jp-str :positional 210)))
  (is (equal "二一一" (jp-str :positional 211)))
  (is (equal "二一九" (jp-str :positional 219)))
  (is (equal "二二〇" (jp-str :positional 220)))
  (is (equal "二二一" (jp-str :positional 221)))
  (is (equal "二九九" (jp-str :positional 299)))
  (is (equal "三〇〇" (jp-str :positional 300)))
  (is (equal "三〇一" (jp-str :positional 301)))
  (is (equal "三〇九" (jp-str :positional 309)))
  (is (equal "三一〇" (jp-str :positional 310)))
  (is (equal "三一一" (jp-str :positional 311)))
  (is (equal "三一九" (jp-str :positional 319)))
  (is (equal "三二〇" (jp-str :positional 320)))
  (is (equal "三二一" (jp-str :positional 321)))
  (is (equal "三九九" (jp-str :positional 399)))
  (is (equal "四〇〇" (jp-str :positional 400)))
  (is (equal "四〇一" (jp-str :positional 401)))
  (is (equal "四〇九" (jp-str :positional 409)))
  (is (equal "四一〇" (jp-str :positional 410)))
  (is (equal "四一一" (jp-str :positional 411)))
  (is (equal "四一九" (jp-str :positional 419)))
  (is (equal "四二〇" (jp-str :positional 420)))
  (is (equal "四二一" (jp-str :positional 421)))
  (is (equal "四九九" (jp-str :positional 499)))
  (is (equal "五〇〇" (jp-str :positional 500)))
  (is (equal "五〇一" (jp-str :positional 501)))
  (is (equal "五〇九" (jp-str :positional 509)))
  (is (equal "五一〇" (jp-str :positional 510)))
  (is (equal "五一一" (jp-str :positional 511)))
  (is (equal "五一九" (jp-str :positional 519)))
  (is (equal "五二〇" (jp-str :positional 520)))
  (is (equal "五二一" (jp-str :positional 521)))
  (is (equal "五九九" (jp-str :positional 599)))
  (is (equal "六〇〇" (jp-str :positional 600)))
  (is (equal "六〇一" (jp-str :positional 601)))
  (is (equal "六〇九" (jp-str :positional 609)))
  (is (equal "六一〇" (jp-str :positional 610)))
  (is (equal "六一一" (jp-str :positional 611)))
  (is (equal "六一九" (jp-str :positional 619)))
  (is (equal "六二〇" (jp-str :positional 620)))
  (is (equal "六二一" (jp-str :positional 621)))
  (is (equal "六九九" (jp-str :positional 699)))
  (is (equal "七〇〇" (jp-str :positional 700)))
  (is (equal "七〇一" (jp-str :positional 701)))
  (is (equal "七〇九" (jp-str :positional 709)))
  (is (equal "七一〇" (jp-str :positional 710)))
  (is (equal "七一一" (jp-str :positional 711)))
  (is (equal "七一九" (jp-str :positional 719)))
  (is (equal "七二〇" (jp-str :positional 720)))
  (is (equal "七二一" (jp-str :positional 721)))
  (is (equal "七九九" (jp-str :positional 799)))
  (is (equal "八〇〇" (jp-str :positional 800)))
  (is (equal "八〇一" (jp-str :positional 801)))
  (is (equal "八〇九" (jp-str :positional 809)))
  (is (equal "八一〇" (jp-str :positional 810)))
  (is (equal "八一一" (jp-str :positional 811)))
  (is (equal "八一九" (jp-str :positional 819)))
  (is (equal "八二〇" (jp-str :positional 820)))
  (is (equal "八二一" (jp-str :positional 821)))
  (is (equal "八九九" (jp-str :positional 899)))
  (is (equal "九〇〇" (jp-str :positional 900)))
  (is (equal "九〇一" (jp-str :positional 901)))
  (is (equal "九〇九" (jp-str :positional 909)))
  (is (equal "九一〇" (jp-str :positional 910)))
  (is (equal "九一一" (jp-str :positional 911)))
  (is (equal "九一九" (jp-str :positional 919)))
  (is (equal "九二〇" (jp-str :positional 920)))
  (is (equal "九二一" (jp-str :positional 921)))
  (is (equal "九九九" (jp-str :positional 999)))
  ;; 1000 - 1099
  (is (equal "一〇〇〇" (jp-str :positional 1000)))
  (is (equal "一〇〇一" (jp-str :positional 1001)))
  (is (equal "一〇〇二" (jp-str :positional 1002)))
  (is (equal "一〇〇九" (jp-str :positional 1009)))
  (is (equal "一〇一〇" (jp-str :positional 1010)))
  (is (equal "一〇一一" (jp-str :positional 1011)))
  (is (equal "一〇一九" (jp-str :positional 1019)))
  (is (equal "一〇二〇" (jp-str :positional 1020)))
  (is (equal "一〇二一" (jp-str :positional 1021)))
  (is (equal "一〇二九" (jp-str :positional 1029)))
  (is (equal "一〇三〇" (jp-str :positional 1030)))
  (is (equal "一〇九九" (jp-str :positional 1099)))
  ;; 1100 - 9999
  (is (equal "一一〇〇" (jp-str :positional 1100)))
  (is (equal "一一〇一" (jp-str :positional 1101)))
  (is (equal "一一〇九" (jp-str :positional 1109)))
  (is (equal "一一一〇" (jp-str :positional 1110)))
  (is (equal "一一一一" (jp-str :positional 1111)))
  (is (equal "一一一九" (jp-str :positional 1119)))
  (is (equal "一一二〇" (jp-str :positional 1120)))
  (is (equal "一一二一" (jp-str :positional 1121)))
  (is (equal "一一二九" (jp-str :positional 1129)))
  (is (equal "一一九九" (jp-str :positional 1199)))
  (is (equal "一二〇〇" (jp-str :positional 1200)))
  (is (equal "一二〇一" (jp-str :positional 1201)))
  (is (equal "一二〇九" (jp-str :positional 1209)))
  (is (equal "一二一〇" (jp-str :positional 1210)))
  (is (equal "一二一一" (jp-str :positional 1211)))
  (is (equal "一二一九" (jp-str :positional 1219)))
  (is (equal "一二二〇" (jp-str :positional 1220)))
  (is (equal "一二二一" (jp-str :positional 1221)))
  (is (equal "一二二九" (jp-str :positional 1229)))
  (is (equal "一二九九" (jp-str :positional 1299)))
  (is (equal "一九〇〇" (jp-str :positional 1900)))
  (is (equal "一九〇一" (jp-str :positional 1901)))
  (is (equal "一九〇九" (jp-str :positional 1909)))
  (is (equal "一九一〇" (jp-str :positional 1910)))
  (is (equal "一九一一" (jp-str :positional 1911)))
  (is (equal "一九一九" (jp-str :positional 1919)))
  (is (equal "一九二〇" (jp-str :positional 1920)))
  (is (equal "一九二一" (jp-str :positional 1921)))
  (is (equal "一九二九" (jp-str :positional 1929)))
  (is (equal "一九九九" (jp-str :positional 1999)))
  ;; 2000 - 9999
  (is (equal "二〇〇〇" (jp-str :positional 2000)))
  (is (equal "二〇〇一" (jp-str :positional 2001)))
  (is (equal "二〇一〇" (jp-str :positional 2010)))
  (is (equal "二〇一一" (jp-str :positional 2011)))
  (is (equal "二〇二〇" (jp-str :positional 2020)))
  (is (equal "二〇二一" (jp-str :positional 2021)))
  (is (equal "二一〇〇" (jp-str :positional 2100)))
  (is (equal "二一〇一" (jp-str :positional 2101)))
  (is (equal "二一一〇" (jp-str :positional 2110)))
  (is (equal "二一一一" (jp-str :positional 2111)))
  (is (equal "二一二〇" (jp-str :positional 2120)))
  (is (equal "二一二一" (jp-str :positional 2121)))
  (is (equal "二二〇〇" (jp-str :positional 2200)))
  (is (equal "二二〇一" (jp-str :positional 2201)))
  (is (equal "二二一〇" (jp-str :positional 2210)))
  (is (equal "二二一一" (jp-str :positional 2211)))
  (is (equal "二二二〇" (jp-str :positional 2220)))
  (is (equal "二二二一" (jp-str :positional 2221)))
  (is (equal "三〇〇〇" (jp-str :positional 3000)))
  (is (equal "三〇〇一" (jp-str :positional 3001)))
  (is (equal "三〇一〇" (jp-str :positional 3010)))
  (is (equal "三〇一一" (jp-str :positional 3011)))
  (is (equal "三〇二〇" (jp-str :positional 3020)))
  (is (equal "三〇二一" (jp-str :positional 3021)))
  (is (equal "三一〇〇" (jp-str :positional 3100)))
  (is (equal "三一〇一" (jp-str :positional 3101)))
  (is (equal "三一一〇" (jp-str :positional 3110)))
  (is (equal "三一一一" (jp-str :positional 3111)))
  (is (equal "三一二〇" (jp-str :positional 3120)))
  (is (equal "三一二一" (jp-str :positional 3121)))
  (is (equal "三二〇〇" (jp-str :positional 3200)))
  (is (equal "三二〇一" (jp-str :positional 3201)))
  (is (equal "三二一〇" (jp-str :positional 3210)))
  (is (equal "三二一一" (jp-str :positional 3211)))
  (is (equal "三二二〇" (jp-str :positional 3220)))
  (is (equal "三二二一" (jp-str :positional 3221)))
  (is (equal "四〇〇〇" (jp-str :positional 4000)))
  (is (equal "四〇〇一" (jp-str :positional 4001)))
  (is (equal "四〇一〇" (jp-str :positional 4010)))
  (is (equal "四〇一一" (jp-str :positional 4011)))
  (is (equal "四〇二〇" (jp-str :positional 4020)))
  (is (equal "四〇二一" (jp-str :positional 4021)))
  (is (equal "四一〇〇" (jp-str :positional 4100)))
  (is (equal "四一〇一" (jp-str :positional 4101)))
  (is (equal "四一一〇" (jp-str :positional 4110)))
  (is (equal "四一一一" (jp-str :positional 4111)))
  (is (equal "四一二〇" (jp-str :positional 4120)))
  (is (equal "四一二一" (jp-str :positional 4121)))
  (is (equal "四二〇〇" (jp-str :positional 4200)))
  (is (equal "四二〇一" (jp-str :positional 4201)))
  (is (equal "四二一〇" (jp-str :positional 4210)))
  (is (equal "四二一一" (jp-str :positional 4211)))
  (is (equal "四二二〇" (jp-str :positional 4220)))
  (is (equal "四二二一" (jp-str :positional 4221)))
  (is (equal "五〇〇〇" (jp-str :positional 5000)))
  (is (equal "五〇〇一" (jp-str :positional 5001)))
  (is (equal "五〇一〇" (jp-str :positional 5010)))
  (is (equal "五〇一一" (jp-str :positional 5011)))
  (is (equal "五〇二〇" (jp-str :positional 5020)))
  (is (equal "五〇二一" (jp-str :positional 5021)))
  (is (equal "五一〇〇" (jp-str :positional 5100)))
  (is (equal "五一〇一" (jp-str :positional 5101)))
  (is (equal "五一一〇" (jp-str :positional 5110)))
  (is (equal "五一一一" (jp-str :positional 5111)))
  (is (equal "五一二〇" (jp-str :positional 5120)))
  (is (equal "五一二一" (jp-str :positional 5121)))
  (is (equal "五二〇〇" (jp-str :positional 5200)))
  (is (equal "五二〇一" (jp-str :positional 5201)))
  (is (equal "五二一〇" (jp-str :positional 5210)))
  (is (equal "五二一一" (jp-str :positional 5211)))
  (is (equal "五二二〇" (jp-str :positional 5220)))
  (is (equal "五二二一" (jp-str :positional 5221)))
  (is (equal "六〇〇〇" (jp-str :positional 6000)))
  (is (equal "六〇〇一" (jp-str :positional 6001)))
  (is (equal "六〇一〇" (jp-str :positional 6010)))
  (is (equal "六〇一一" (jp-str :positional 6011)))
  (is (equal "六〇二〇" (jp-str :positional 6020)))
  (is (equal "六〇二一" (jp-str :positional 6021)))
  (is (equal "六一〇〇" (jp-str :positional 6100)))
  (is (equal "六一〇一" (jp-str :positional 6101)))
  (is (equal "六一一〇" (jp-str :positional 6110)))
  (is (equal "六一一一" (jp-str :positional 6111)))
  (is (equal "六一二〇" (jp-str :positional 6120)))
  (is (equal "六一二一" (jp-str :positional 6121)))
  (is (equal "六二〇〇" (jp-str :positional 6200)))
  (is (equal "六二〇一" (jp-str :positional 6201)))
  (is (equal "六二一〇" (jp-str :positional 6210)))
  (is (equal "六二一一" (jp-str :positional 6211)))
  (is (equal "六二二〇" (jp-str :positional 6220)))
  (is (equal "六二二一" (jp-str :positional 6221)))
  (is (equal "七〇〇〇" (jp-str :positional 7000)))
  (is (equal "七〇〇一" (jp-str :positional 7001)))
  (is (equal "七〇一〇" (jp-str :positional 7010)))
  (is (equal "七〇一一" (jp-str :positional 7011)))
  (is (equal "七〇二〇" (jp-str :positional 7020)))
  (is (equal "七〇二一" (jp-str :positional 7021)))
  (is (equal "七一〇〇" (jp-str :positional 7100)))
  (is (equal "七一〇一" (jp-str :positional 7101)))
  (is (equal "七一一〇" (jp-str :positional 7110)))
  (is (equal "七一一一" (jp-str :positional 7111)))
  (is (equal "七一二〇" (jp-str :positional 7120)))
  (is (equal "七一二一" (jp-str :positional 7121)))
  (is (equal "七二〇〇" (jp-str :positional 7200)))
  (is (equal "七二〇一" (jp-str :positional 7201)))
  (is (equal "七二一〇" (jp-str :positional 7210)))
  (is (equal "七二一一" (jp-str :positional 7211)))
  (is (equal "七二二〇" (jp-str :positional 7220)))
  (is (equal "七二二一" (jp-str :positional 7221)))
  (is (equal "八〇〇〇" (jp-str :positional 8000)))
  (is (equal "八〇〇一" (jp-str :positional 8001)))
  (is (equal "八〇一〇" (jp-str :positional 8010)))
  (is (equal "八〇一一" (jp-str :positional 8011)))
  (is (equal "八〇二〇" (jp-str :positional 8020)))
  (is (equal "八〇二一" (jp-str :positional 8021)))
  (is (equal "八一〇〇" (jp-str :positional 8100)))
  (is (equal "八一〇一" (jp-str :positional 8101)))
  (is (equal "八一一〇" (jp-str :positional 8110)))
  (is (equal "八一一一" (jp-str :positional 8111)))
  (is (equal "八一二〇" (jp-str :positional 8120)))
  (is (equal "八一二一" (jp-str :positional 8121)))
  (is (equal "八二〇〇" (jp-str :positional 8200)))
  (is (equal "八二〇一" (jp-str :positional 8201)))
  (is (equal "八二一〇" (jp-str :positional 8210)))
  (is (equal "八二一一" (jp-str :positional 8211)))
  (is (equal "八二二〇" (jp-str :positional 8220)))
  (is (equal "八二二一" (jp-str :positional 8221)))
  (is (equal "九〇〇〇" (jp-str :positional 9000)))
  (is (equal "九〇〇一" (jp-str :positional 9001)))
  (is (equal "九〇一〇" (jp-str :positional 9010)))
  (is (equal "九〇一一" (jp-str :positional 9011)))
  (is (equal "九〇二〇" (jp-str :positional 9020)))
  (is (equal "九〇二一" (jp-str :positional 9021)))
  (is (equal "九一〇〇" (jp-str :positional 9100)))
  (is (equal "九一〇一" (jp-str :positional 9101)))
  (is (equal "九一一〇" (jp-str :positional 9110)))
  (is (equal "九一一一" (jp-str :positional 9111)))
  (is (equal "九一二〇" (jp-str :positional 9120)))
  (is (equal "九一二一" (jp-str :positional 9121)))
  (is (equal "九二〇〇" (jp-str :positional 9200)))
  (is (equal "九二〇一" (jp-str :positional 9201)))
  (is (equal "九二一〇" (jp-str :positional 9210)))
  (is (equal "九二一一" (jp-str :positional 9211)))
  (is (equal "九二二〇" (jp-str :positional 9220)))
  (is (equal "九二二一" (jp-str :positional 9221)))
  (is (equal "九九九九" (jp-str :positional 9999)))
  ;; 
  t)

(test test-jp-positional-integer-bignums
  ;; 10000 - 19999
  (is (equal "一〇〇〇〇" (jp-str :positional 10000)))
  (is (equal "一〇〇〇一" (jp-str :positional 10001)))
  (is (equal "一〇〇〇九" (jp-str :positional 10009)))
  (is (equal "一〇〇一〇" (jp-str :positional 10010)))
  (is (equal "一〇〇一一" (jp-str :positional 10011)))
  (is (equal "一〇〇一九" (jp-str :positional 10019)))
  (is (equal "一〇〇二〇" (jp-str :positional 10020)))
  (is (equal "一〇〇二一" (jp-str :positional 10021)))
  (is (equal "一〇〇二九" (jp-str :positional 10029)))
  (is (equal "一〇一〇〇" (jp-str :positional 10100)))
  (is (equal "一〇一〇一" (jp-str :positional 10101)))
  (is (equal "一〇一〇九" (jp-str :positional 10109)))
  (is (equal "一〇一一〇" (jp-str :positional 10110)))
  (is (equal "一〇一一一" (jp-str :positional 10111)))
  (is (equal "一〇一一九" (jp-str :positional 10119)))
  (is (equal "一〇一二〇" (jp-str :positional 10120)))
  (is (equal "一〇一二一" (jp-str :positional 10121)))
  (is (equal "一〇一二九" (jp-str :positional 10129)))
  (is (equal "一〇二〇〇" (jp-str :positional 10200)))
  (is (equal "一〇二〇一" (jp-str :positional 10201)))
  (is (equal "一〇二〇九" (jp-str :positional 10209)))
  (is (equal "一〇二一〇" (jp-str :positional 10210)))
  (is (equal "一〇二一一" (jp-str :positional 10211)))
  (is (equal "一〇二一九" (jp-str :positional 10219)))
  (is (equal "一〇二二〇" (jp-str :positional 10220)))
  (is (equal "一〇二二一" (jp-str :positional 10221)))
  (is (equal "一〇二二九" (jp-str :positional 10229)))
  (is (equal "一一〇〇〇" (jp-str :positional 11000)))
  (is (equal "一一〇〇一" (jp-str :positional 11001)))
  (is (equal "一一〇〇九" (jp-str :positional 11009)))
  (is (equal "一一〇一〇" (jp-str :positional 11010)))
  (is (equal "一一〇一一" (jp-str :positional 11011)))
  (is (equal "一一〇一九" (jp-str :positional 11019)))
  (is (equal "一一〇二〇" (jp-str :positional 11020)))
  (is (equal "一一〇二一" (jp-str :positional 11021)))
  (is (equal "一一〇二九" (jp-str :positional 11029)))
  (is (equal "一一一〇〇" (jp-str :positional 11100)))
  (is (equal "一一一〇一" (jp-str :positional 11101)))
  (is (equal "一一一〇九" (jp-str :positional 11109)))
  (is (equal "一一一一〇" (jp-str :positional 11110)))
  (is (equal "一一一一一" (jp-str :positional 11111)))
  (is (equal "一一一一九" (jp-str :positional 11119)))
  (is (equal "一一一二〇" (jp-str :positional 11120)))
  (is (equal "一一一二一" (jp-str :positional 11121)))
  (is (equal "一一一二九" (jp-str :positional 11129)))
  (is (equal "一一二〇〇" (jp-str :positional 11200)))
  (is (equal "一一二〇一" (jp-str :positional 11201)))
  (is (equal "一一二〇九" (jp-str :positional 11209)))
  (is (equal "一一二一〇" (jp-str :positional 11210)))
  (is (equal "一一二一一" (jp-str :positional 11211)))
  (is (equal "一一二一九" (jp-str :positional 11219)))
  (is (equal "一一二二〇" (jp-str :positional 11220)))
  (is (equal "一一二二一" (jp-str :positional 11221)))
  (is (equal "一一二二九" (jp-str :positional 11229)))
  (is (equal "一二〇〇〇" (jp-str :positional 12000)))
  (is (equal "一二〇〇一" (jp-str :positional 12001)))
  (is (equal "一二〇〇九" (jp-str :positional 12009)))
  (is (equal "一二〇一〇" (jp-str :positional 12010)))
  (is (equal "一二〇一一" (jp-str :positional 12011)))
  (is (equal "一二〇一九" (jp-str :positional 12019)))
  (is (equal "一二〇二〇" (jp-str :positional 12020)))
  (is (equal "一二〇二一" (jp-str :positional 12021)))
  (is (equal "一二〇二九" (jp-str :positional 12029)))
  (is (equal "一二一〇〇" (jp-str :positional 12100)))
  (is (equal "一二一〇一" (jp-str :positional 12101)))
  (is (equal "一二一〇九" (jp-str :positional 12109)))
  (is (equal "一二一一〇" (jp-str :positional 12110)))
  (is (equal "一二一一一" (jp-str :positional 12111)))
  (is (equal "一二一一九" (jp-str :positional 12119)))
  (is (equal "一二一二〇" (jp-str :positional 12120)))
  (is (equal "一二一二一" (jp-str :positional 12121)))
  (is (equal "一二一二九" (jp-str :positional 12129)))
  (is (equal "一二二〇〇" (jp-str :positional 12200)))
  (is (equal "一二二〇一" (jp-str :positional 12201)))
  (is (equal "一二二〇九" (jp-str :positional 12209)))
  (is (equal "一二二一〇" (jp-str :positional 12210)))
  (is (equal "一二二一一" (jp-str :positional 12211)))
  (is (equal "一二二一九" (jp-str :positional 12219)))
  (is (equal "一二二二〇" (jp-str :positional 12220)))
  (is (equal "一二二二一" (jp-str :positional 12221)))
  (is (equal "一二二二九" (jp-str :positional 12229)))
  (is (equal "一九九九九" (jp-str :positional 19999)))
  ;; 20000 - 99990000
  (is (equal "二〇〇〇〇" (jp-str :positional 20000)))
  (is (equal "九〇〇〇〇" (jp-str :positional 90000)))
  (is (equal "一〇〇〇〇〇" (jp-str :positional 100000)))
  (is (equal "一一〇〇〇〇" (jp-str :positional 110000)))
  (is (equal "一九〇〇〇〇" (jp-str :positional 190000)))
  (is (equal "二〇〇〇〇〇" (jp-str :positional 200000)))
  (is (equal "二一〇〇〇〇" (jp-str :positional 210000)))
  (is (equal "二九〇〇〇〇" (jp-str :positional 290000)))
  (is (equal "一〇〇〇〇〇〇" (jp-str :positional 1000000)))
  (is (equal "一〇一〇〇〇〇" (jp-str :positional 1010000)))
  (is (equal "一〇九〇〇〇〇" (jp-str :positional 1090000)))
  (is (equal "一一〇〇〇〇〇" (jp-str :positional 1100000)))
  (is (equal "一一一〇〇〇〇" (jp-str :positional 1110000)))
  (is (equal "一一九〇〇〇〇" (jp-str :positional 1190000)))
  (is (equal "一二〇〇〇〇〇" (jp-str :positional 1200000)))
  (is (equal "一二一〇〇〇〇" (jp-str :positional 1210000)))
  (is (equal "一二九〇〇〇〇" (jp-str :positional 1290000)))
  (is (equal "二〇〇〇〇〇〇" (jp-str :positional 2000000)))
  (is (equal "二〇一〇〇〇〇" (jp-str :positional 2010000)))
  (is (equal "二〇九〇〇〇〇" (jp-str :positional 2090000)))
  (is (equal "二一〇〇〇〇〇" (jp-str :positional 2100000)))
  (is (equal "二一一〇〇〇〇" (jp-str :positional 2110000)))
  (is (equal "二一九〇〇〇〇" (jp-str :positional 2190000)))
  (is (equal "二二〇〇〇〇〇" (jp-str :positional 2200000)))
  (is (equal "二二一〇〇〇〇" (jp-str :positional 2210000)))
  (is (equal "二二九〇〇〇〇" (jp-str :positional 2290000)))
  (is (equal "一〇〇〇〇〇〇〇" (jp-str :positional 10000000)))
  (is (equal "一〇〇一〇〇〇〇" (jp-str :positional 10010000)))
  (is (equal "一〇〇九〇〇〇〇" (jp-str :positional 10090000)))
  (is (equal "一〇一〇〇〇〇〇" (jp-str :positional 10100000)))
  (is (equal "一〇一一〇〇〇〇" (jp-str :positional 10110000)))
  (is (equal "一〇一九〇〇〇〇" (jp-str :positional 10190000)))
  (is (equal "一〇二〇〇〇〇〇" (jp-str :positional 10200000)))
  (is (equal "一〇二一〇〇〇〇" (jp-str :positional 10210000)))
  (is (equal "一〇二九〇〇〇〇" (jp-str :positional 10290000)))
  (is (equal "一一〇〇〇〇〇〇" (jp-str :positional 11000000)))
  (is (equal "一一〇一〇〇〇〇" (jp-str :positional 11010000)))
  (is (equal "一一〇九〇〇〇〇" (jp-str :positional 11090000)))
  (is (equal "一一一〇〇〇〇〇" (jp-str :positional 11100000)))
  (is (equal "一一一一〇〇〇〇" (jp-str :positional 11110000)))
  (is (equal "一一一九〇〇〇〇" (jp-str :positional 11190000)))
  (is (equal "一一二〇〇〇〇〇" (jp-str :positional 11200000)))
  (is (equal "一一二一〇〇〇〇" (jp-str :positional 11210000)))
  (is (equal "一一二九〇〇〇〇" (jp-str :positional 11290000)))
  (is (equal "一二〇〇〇〇〇〇" (jp-str :positional 12000000)))
  (is (equal "一二〇一〇〇〇〇" (jp-str :positional 12010000)))
  (is (equal "一二〇九〇〇〇〇" (jp-str :positional 12090000)))
  (is (equal "一二一〇〇〇〇〇" (jp-str :positional 12100000)))
  (is (equal "一二一一〇〇〇〇" (jp-str :positional 12110000)))
  (is (equal "一二一九〇〇〇〇" (jp-str :positional 12190000)))
  (is (equal "一二二〇〇〇〇〇" (jp-str :positional 12200000)))
  (is (equal "一二二一〇〇〇〇" (jp-str :positional 12210000)))
  (is (equal "一二二九〇〇〇〇" (jp-str :positional 12290000)))
  (is (equal "二〇〇〇〇〇〇〇" (jp-str :positional 20000000)))
  (is (equal "二〇〇一〇〇〇〇" (jp-str :positional 20010000)))
  (is (equal "二〇〇九〇〇〇〇" (jp-str :positional 20090000)))
  (is (equal "二〇一〇〇〇〇〇" (jp-str :positional 20100000)))
  (is (equal "二〇一一〇〇〇〇" (jp-str :positional 20110000)))
  (is (equal "二〇一九〇〇〇〇" (jp-str :positional 20190000)))
  (is (equal "二〇二〇〇〇〇〇" (jp-str :positional 20200000)))
  (is (equal "二〇二一〇〇〇〇" (jp-str :positional 20210000)))
  (is (equal "二〇二九〇〇〇〇" (jp-str :positional 20290000)))
  (is (equal "二一〇〇〇〇〇〇" (jp-str :positional 21000000)))
  (is (equal "二一〇一〇〇〇〇" (jp-str :positional 21010000)))
  (is (equal "二一〇九〇〇〇〇" (jp-str :positional 21090000)))
  (is (equal "二一一〇〇〇〇〇" (jp-str :positional 21100000)))
  (is (equal "二一一一〇〇〇〇" (jp-str :positional 21110000)))
  (is (equal "二一一九〇〇〇〇" (jp-str :positional 21190000)))
  (is (equal "二一二〇〇〇〇〇" (jp-str :positional 21200000)))
  (is (equal "二一二一〇〇〇〇" (jp-str :positional 21210000)))
  (is (equal "二一二九〇〇〇〇" (jp-str :positional 21290000)))
  (is (equal "二二〇〇〇〇〇〇" (jp-str :positional 22000000)))
  (is (equal "二二〇一〇〇〇〇" (jp-str :positional 22010000)))
  (is (equal "二二〇九〇〇〇〇" (jp-str :positional 22090000)))
  (is (equal "二二一〇〇〇〇〇" (jp-str :positional 22100000)))
  (is (equal "二二一一〇〇〇〇" (jp-str :positional 22110000)))
  (is (equal "二二一九〇〇〇〇" (jp-str :positional 22190000)))
  (is (equal "二二二〇〇〇〇〇" (jp-str :positional 22200000)))
  (is (equal "二二二一〇〇〇〇" (jp-str :positional 22210000)))
  (is (equal "二二二九〇〇〇〇" (jp-str :positional 22290000)))
  (is (equal "九九九九〇〇〇〇" (jp-str :positional 99990000)))
  ;; 100000000 - 100009999
  (is (equal "一〇〇〇〇〇〇〇〇" (jp-str :positional 100000000)))
  (is (equal "一〇〇〇〇〇〇〇一" (jp-str :positional 100000001)))
  (is (equal "一〇〇〇〇〇〇〇九" (jp-str :positional 100000009)))
  (is (equal "一〇〇〇〇〇〇一〇" (jp-str :positional 100000010)))
  (is (equal "一〇〇〇〇〇〇一一" (jp-str :positional 100000011)))
  (is (equal "一〇〇〇〇〇〇一九" (jp-str :positional 100000019)))
  (is (equal "一〇〇〇〇〇〇二〇" (jp-str :positional 100000020)))
  (is (equal "一〇〇〇〇〇〇二一" (jp-str :positional 100000021)))
  (is (equal "一〇〇〇〇〇〇二九" (jp-str :positional 100000029)))
  (is (equal "一〇〇〇〇〇一〇〇" (jp-str :positional 100000100)))
  (is (equal "一〇〇〇〇〇一〇一" (jp-str :positional 100000101)))
  (is (equal "一〇〇〇〇〇一〇九" (jp-str :positional 100000109)))
  (is (equal "一〇〇〇〇〇一一〇" (jp-str :positional 100000110)))
  (is (equal "一〇〇〇〇〇一一一" (jp-str :positional 100000111)))
  (is (equal "一〇〇〇〇〇一一九" (jp-str :positional 100000119)))
  (is (equal "一〇〇〇〇〇一二〇" (jp-str :positional 100000120)))
  (is (equal "一〇〇〇〇〇一二一" (jp-str :positional 100000121)))
  (is (equal "一〇〇〇〇〇一二九" (jp-str :positional 100000129)))
  (is (equal "一〇〇〇〇〇二〇〇" (jp-str :positional 100000200)))
  (is (equal "一〇〇〇〇〇二〇一" (jp-str :positional 100000201)))
  (is (equal "一〇〇〇〇〇二〇九" (jp-str :positional 100000209)))
  (is (equal "一〇〇〇〇〇二一〇" (jp-str :positional 100000210)))
  (is (equal "一〇〇〇〇〇二一一" (jp-str :positional 100000211)))
  (is (equal "一〇〇〇〇〇二一九" (jp-str :positional 100000219)))
  (is (equal "一〇〇〇〇〇二二〇" (jp-str :positional 100000220)))
  (is (equal "一〇〇〇〇〇二二一" (jp-str :positional 100000221)))
  (is (equal "一〇〇〇〇〇二二九" (jp-str :positional 100000229)))
  (is (equal "一〇〇〇〇一〇〇〇" (jp-str :positional 100001000)))
  (is (equal "一〇〇〇〇一〇〇一" (jp-str :positional 100001001)))
  (is (equal "一〇〇〇〇一〇〇九" (jp-str :positional 100001009)))
  (is (equal "一〇〇〇〇一〇一〇" (jp-str :positional 100001010)))
  (is (equal "一〇〇〇〇一〇一一" (jp-str :positional 100001011)))
  (is (equal "一〇〇〇〇一〇一九" (jp-str :positional 100001019)))
  (is (equal "一〇〇〇〇一〇二〇" (jp-str :positional 100001020)))
  (is (equal "一〇〇〇〇一〇二一" (jp-str :positional 100001021)))
  (is (equal "一〇〇〇〇一〇二九" (jp-str :positional 100001029)))
  (is (equal "一〇〇〇〇一一〇〇" (jp-str :positional 100001100)))
  (is (equal "一〇〇〇〇一一〇一" (jp-str :positional 100001101)))
  (is (equal "一〇〇〇〇一一〇九" (jp-str :positional 100001109)))
  (is (equal "一〇〇〇〇一一一〇" (jp-str :positional 100001110)))
  (is (equal "一〇〇〇〇一一一一" (jp-str :positional 100001111)))
  (is (equal "一〇〇〇〇一一一九" (jp-str :positional 100001119)))
  (is (equal "一〇〇〇〇一一二〇" (jp-str :positional 100001120)))
  (is (equal "一〇〇〇〇一一二一" (jp-str :positional 100001121)))
  (is (equal "一〇〇〇〇一一二九" (jp-str :positional 100001129)))
  (is (equal "一〇〇〇〇一二〇〇" (jp-str :positional 100001200)))
  (is (equal "一〇〇〇〇一二〇一" (jp-str :positional 100001201)))
  (is (equal "一〇〇〇〇一二〇九" (jp-str :positional 100001209)))
  (is (equal "一〇〇〇〇一二一〇" (jp-str :positional 100001210)))
  (is (equal "一〇〇〇〇一二一一" (jp-str :positional 100001211)))
  (is (equal "一〇〇〇〇一二一九" (jp-str :positional 100001219)))
  (is (equal "一〇〇〇〇一二二〇" (jp-str :positional 100001220)))
  (is (equal "一〇〇〇〇一二二一" (jp-str :positional 100001221)))
  (is (equal "一〇〇〇〇一二二九" (jp-str :positional 100001229)))
  (is (equal "一〇〇〇〇二〇〇〇" (jp-str :positional 100002000)))
  (is (equal "一〇〇〇〇二〇〇一" (jp-str :positional 100002001)))
  (is (equal "一〇〇〇〇二〇〇九" (jp-str :positional 100002009)))
  (is (equal "一〇〇〇〇二〇一〇" (jp-str :positional 100002010)))
  (is (equal "一〇〇〇〇二〇一一" (jp-str :positional 100002011)))
  (is (equal "一〇〇〇〇二〇一九" (jp-str :positional 100002019)))
  (is (equal "一〇〇〇〇二〇二〇" (jp-str :positional 100002020)))
  (is (equal "一〇〇〇〇二〇二一" (jp-str :positional 100002021)))
  (is (equal "一〇〇〇〇二〇二九" (jp-str :positional 100002029)))
  (is (equal "一〇〇〇〇二一〇〇" (jp-str :positional 100002100)))
  (is (equal "一〇〇〇〇二一〇一" (jp-str :positional 100002101)))
  (is (equal "一〇〇〇〇二一〇九" (jp-str :positional 100002109)))
  (is (equal "一〇〇〇〇二一一〇" (jp-str :positional 100002110)))
  (is (equal "一〇〇〇〇二一一一" (jp-str :positional 100002111)))
  (is (equal "一〇〇〇〇二一一九" (jp-str :positional 100002119)))
  (is (equal "一〇〇〇〇二一二〇" (jp-str :positional 100002120)))
  (is (equal "一〇〇〇〇二一二一" (jp-str :positional 100002121)))
  (is (equal "一〇〇〇〇二一二九" (jp-str :positional 100002129)))
  (is (equal "一〇〇〇〇二二〇〇" (jp-str :positional 100002200)))
  (is (equal "一〇〇〇〇二二〇一" (jp-str :positional 100002201)))
  (is (equal "一〇〇〇〇二二〇九" (jp-str :positional 100002209)))
  (is (equal "一〇〇〇〇二二一〇" (jp-str :positional 100002210)))
  (is (equal "一〇〇〇〇二二一一" (jp-str :positional 100002211)))
  (is (equal "一〇〇〇〇二二一九" (jp-str :positional 100002219)))
  (is (equal "一〇〇〇〇二二二〇" (jp-str :positional 100002220)))
  (is (equal "一〇〇〇〇二二二一" (jp-str :positional 100002221)))
  (is (equal "一〇〇〇〇二二二九" (jp-str :positional 100002229)))
  (is (equal "一〇〇〇〇九九九九" (jp-str :positional 100009999)))
  ;; 100010000 - 100019999
  (is (equal "一〇〇〇一〇〇〇〇" (jp-str :positional 100010000)))
  (is (equal "一〇〇〇一〇〇〇一" (jp-str :positional 100010001)))
  (is (equal "一〇〇〇一〇〇〇九" (jp-str :positional 100010009)))
  (is (equal "一〇〇〇一〇〇一〇" (jp-str :positional 100010010)))
  (is (equal "一〇〇〇一〇〇一一" (jp-str :positional 100010011)))
  (is (equal "一〇〇〇一〇〇一九" (jp-str :positional 100010019)))
  (is (equal "一〇〇〇一〇〇二〇" (jp-str :positional 100010020)))
  (is (equal "一〇〇〇一〇〇二一" (jp-str :positional 100010021)))
  (is (equal "一〇〇〇一〇〇二九" (jp-str :positional 100010029)))
  (is (equal "一〇〇〇一〇一〇〇" (jp-str :positional 100010100)))
  (is (equal "一〇〇〇一〇一〇一" (jp-str :positional 100010101)))
  (is (equal "一〇〇〇一〇一〇九" (jp-str :positional 100010109)))
  (is (equal "一〇〇〇一〇一一〇" (jp-str :positional 100010110)))
  (is (equal "一〇〇〇一〇一一一" (jp-str :positional 100010111)))
  (is (equal "一〇〇〇一〇一一九" (jp-str :positional 100010119)))
  (is (equal "一〇〇〇一〇一二〇" (jp-str :positional 100010120)))
  (is (equal "一〇〇〇一〇一二一" (jp-str :positional 100010121)))
  (is (equal "一〇〇〇一〇一二九" (jp-str :positional 100010129)))
  (is (equal "一〇〇〇一〇二〇〇" (jp-str :positional 100010200)))
  (is (equal "一〇〇〇一〇二〇一" (jp-str :positional 100010201)))
  (is (equal "一〇〇〇一〇二〇九" (jp-str :positional 100010209)))
  (is (equal "一〇〇〇一〇二一〇" (jp-str :positional 100010210)))
  (is (equal "一〇〇〇一〇二一一" (jp-str :positional 100010211)))
  (is (equal "一〇〇〇一〇二一九" (jp-str :positional 100010219)))
  (is (equal "一〇〇〇一〇二二〇" (jp-str :positional 100010220)))
  (is (equal "一〇〇〇一〇二二一" (jp-str :positional 100010221)))
  (is (equal "一〇〇〇一〇二二九" (jp-str :positional 100010229)))
  (is (equal "一〇〇〇一一〇〇〇" (jp-str :positional 100011000)))
  (is (equal "一〇〇〇一一〇〇一" (jp-str :positional 100011001)))
  (is (equal "一〇〇〇一一〇〇九" (jp-str :positional 100011009)))
  (is (equal "一〇〇〇一一〇一〇" (jp-str :positional 100011010)))
  (is (equal "一〇〇〇一一〇一一" (jp-str :positional 100011011)))
  (is (equal "一〇〇〇一一〇一九" (jp-str :positional 100011019)))
  (is (equal "一〇〇〇一一〇二〇" (jp-str :positional 100011020)))
  (is (equal "一〇〇〇一一〇二一" (jp-str :positional 100011021)))
  (is (equal "一〇〇〇一一〇二九" (jp-str :positional 100011029)))
  (is (equal "一〇〇〇一一一〇〇" (jp-str :positional 100011100)))
  (is (equal "一〇〇〇一一一〇一" (jp-str :positional 100011101)))
  (is (equal "一〇〇〇一一一〇九" (jp-str :positional 100011109)))
  (is (equal "一〇〇〇一一一一〇" (jp-str :positional 100011110)))
  (is (equal "一〇〇〇一一一一一" (jp-str :positional 100011111)))
  (is (equal "一〇〇〇一一一一九" (jp-str :positional 100011119)))
  (is (equal "一〇〇〇一一一二〇" (jp-str :positional 100011120)))
  (is (equal "一〇〇〇一一一二一" (jp-str :positional 100011121)))
  (is (equal "一〇〇〇一一一二九" (jp-str :positional 100011129)))
  (is (equal "一〇〇〇一一二〇〇" (jp-str :positional 100011200)))
  (is (equal "一〇〇〇一一二〇一" (jp-str :positional 100011201)))
  (is (equal "一〇〇〇一一二〇九" (jp-str :positional 100011209)))
  (is (equal "一〇〇〇一一二一〇" (jp-str :positional 100011210)))
  (is (equal "一〇〇〇一一二一一" (jp-str :positional 100011211)))
  (is (equal "一〇〇〇一一二一九" (jp-str :positional 100011219)))
  (is (equal "一〇〇〇一一二二〇" (jp-str :positional 100011220)))
  (is (equal "一〇〇〇一一二二一" (jp-str :positional 100011221)))
  (is (equal "一〇〇〇一一二二九" (jp-str :positional 100011229)))
  (is (equal "一〇〇〇一二〇〇〇" (jp-str :positional 100012000)))
  (is (equal "一〇〇〇一二〇〇一" (jp-str :positional 100012001)))
  (is (equal "一〇〇〇一二〇〇九" (jp-str :positional 100012009)))
  (is (equal "一〇〇〇一二〇一〇" (jp-str :positional 100012010)))
  (is (equal "一〇〇〇一二〇一一" (jp-str :positional 100012011)))
  (is (equal "一〇〇〇一二〇一九" (jp-str :positional 100012019)))
  (is (equal "一〇〇〇一二〇二〇" (jp-str :positional 100012020)))
  (is (equal "一〇〇〇一二〇二一" (jp-str :positional 100012021)))
  (is (equal "一〇〇〇一二〇二九" (jp-str :positional 100012029)))
  (is (equal "一〇〇〇一二一〇〇" (jp-str :positional 100012100)))
  (is (equal "一〇〇〇一二一〇一" (jp-str :positional 100012101)))
  (is (equal "一〇〇〇一二一〇九" (jp-str :positional 100012109)))
  (is (equal "一〇〇〇一二一一〇" (jp-str :positional 100012110)))
  (is (equal "一〇〇〇一二一一一" (jp-str :positional 100012111)))
  (is (equal "一〇〇〇一二一一九" (jp-str :positional 100012119)))
  (is (equal "一〇〇〇一二一二〇" (jp-str :positional 100012120)))
  (is (equal "一〇〇〇一二一二一" (jp-str :positional 100012121)))
  (is (equal "一〇〇〇一二一二九" (jp-str :positional 100012129)))
  (is (equal "一〇〇〇一二二〇〇" (jp-str :positional 100012200)))
  (is (equal "一〇〇〇一二二〇一" (jp-str :positional 100012201)))
  (is (equal "一〇〇〇一二二〇九" (jp-str :positional 100012209)))
  (is (equal "一〇〇〇一二二一〇" (jp-str :positional 100012210)))
  (is (equal "一〇〇〇一二二一一" (jp-str :positional 100012211)))
  (is (equal "一〇〇〇一二二一九" (jp-str :positional 100012219)))
  (is (equal "一〇〇〇一二二二〇" (jp-str :positional 100012220)))
  (is (equal "一〇〇〇一二二二一" (jp-str :positional 100012221)))
  (is (equal "一〇〇〇一二二二九" (jp-str :positional 100012229)))
  (is (equal "一〇〇〇一九九九九" (jp-str :positional 100019999)))
  ;; 100020000 - 199990000
  (is (equal "一〇〇〇二〇〇〇〇" (jp-str :positional 100020000)))
  (is (equal "一〇〇〇九〇〇〇〇" (jp-str :positional 100090000)))
  (is (equal "一〇〇一〇〇〇〇〇" (jp-str :positional 100100000)))
  (is (equal "一〇〇一一〇〇〇〇" (jp-str :positional 100110000)))
  (is (equal "一〇〇一九〇〇〇〇" (jp-str :positional 100190000)))
  (is (equal "一〇〇二〇〇〇〇〇" (jp-str :positional 100200000)))
  (is (equal "一〇〇二一〇〇〇〇" (jp-str :positional 100210000)))
  (is (equal "一〇〇二九〇〇〇〇" (jp-str :positional 100290000)))
  (is (equal "一〇一〇〇〇〇〇〇" (jp-str :positional 101000000)))
  (is (equal "一〇一〇一〇〇〇〇" (jp-str :positional 101010000)))
  (is (equal "一〇一〇九〇〇〇〇" (jp-str :positional 101090000)))
  (is (equal "一〇一一〇〇〇〇〇" (jp-str :positional 101100000)))
  (is (equal "一〇一一一〇〇〇〇" (jp-str :positional 101110000)))
  (is (equal "一〇一一九〇〇〇〇" (jp-str :positional 101190000)))
  (is (equal "一〇一二〇〇〇〇〇" (jp-str :positional 101200000)))
  (is (equal "一〇一二一〇〇〇〇" (jp-str :positional 101210000)))
  (is (equal "一〇一二九〇〇〇〇" (jp-str :positional 101290000)))
  (is (equal "一〇二〇〇〇〇〇〇" (jp-str :positional 102000000)))
  (is (equal "一〇二〇一〇〇〇〇" (jp-str :positional 102010000)))
  (is (equal "一〇二〇九〇〇〇〇" (jp-str :positional 102090000)))
  (is (equal "一〇二一〇〇〇〇〇" (jp-str :positional 102100000)))
  (is (equal "一〇二一一〇〇〇〇" (jp-str :positional 102110000)))
  (is (equal "一〇二一九〇〇〇〇" (jp-str :positional 102190000)))
  (is (equal "一〇二二〇〇〇〇〇" (jp-str :positional 102200000)))
  (is (equal "一〇二二一〇〇〇〇" (jp-str :positional 102210000)))
  (is (equal "一〇二二九〇〇〇〇" (jp-str :positional 102290000)))
  (is (equal "一一〇〇〇〇〇〇〇" (jp-str :positional 110000000)))
  (is (equal "一一〇〇一〇〇〇〇" (jp-str :positional 110010000)))
  (is (equal "一一〇〇九〇〇〇〇" (jp-str :positional 110090000)))
  (is (equal "一一〇一〇〇〇〇〇" (jp-str :positional 110100000)))
  (is (equal "一一〇一一〇〇〇〇" (jp-str :positional 110110000)))
  (is (equal "一一〇一九〇〇〇〇" (jp-str :positional 110190000)))
  (is (equal "一一〇二〇〇〇〇〇" (jp-str :positional 110200000)))
  (is (equal "一一〇二一〇〇〇〇" (jp-str :positional 110210000)))
  (is (equal "一一〇二九〇〇〇〇" (jp-str :positional 110290000)))
  (is (equal "一一一〇〇〇〇〇〇" (jp-str :positional 111000000)))
  (is (equal "一一一〇一〇〇〇〇" (jp-str :positional 111010000)))
  (is (equal "一一一〇九〇〇〇〇" (jp-str :positional 111090000)))
  (is (equal "一一一一〇〇〇〇〇" (jp-str :positional 111100000)))
  (is (equal "一一一一一〇〇〇〇" (jp-str :positional 111110000)))
  (is (equal "一一一一九〇〇〇〇" (jp-str :positional 111190000)))
  (is (equal "一一一二〇〇〇〇〇" (jp-str :positional 111200000)))
  (is (equal "一一一二一〇〇〇〇" (jp-str :positional 111210000)))
  (is (equal "一一一二九〇〇〇〇" (jp-str :positional 111290000)))
  (is (equal "一一二〇〇〇〇〇〇" (jp-str :positional 112000000)))
  (is (equal "一一二〇一〇〇〇〇" (jp-str :positional 112010000)))
  (is (equal "一一二〇九〇〇〇〇" (jp-str :positional 112090000)))
  (is (equal "一一二一〇〇〇〇〇" (jp-str :positional 112100000)))
  (is (equal "一一二一一〇〇〇〇" (jp-str :positional 112110000)))
  (is (equal "一一二一九〇〇〇〇" (jp-str :positional 112190000)))
  (is (equal "一一二二〇〇〇〇〇" (jp-str :positional 112200000)))
  (is (equal "一一二二一〇〇〇〇" (jp-str :positional 112210000)))
  (is (equal "一一二二九〇〇〇〇" (jp-str :positional 112290000)))
  (is (equal "一二〇〇〇〇〇〇〇" (jp-str :positional 120000000)))
  (is (equal "一二〇〇一〇〇〇〇" (jp-str :positional 120010000)))
  (is (equal "一二〇〇九〇〇〇〇" (jp-str :positional 120090000)))
  (is (equal "一二〇一〇〇〇〇〇" (jp-str :positional 120100000)))
  (is (equal "一二〇一一〇〇〇〇" (jp-str :positional 120110000)))
  (is (equal "一二〇一九〇〇〇〇" (jp-str :positional 120190000)))
  (is (equal "一二〇二〇〇〇〇〇" (jp-str :positional 120200000)))
  (is (equal "一二〇二一〇〇〇〇" (jp-str :positional 120210000)))
  (is (equal "一二〇二九〇〇〇〇" (jp-str :positional 120290000)))
  (is (equal "一二一〇〇〇〇〇〇" (jp-str :positional 121000000)))
  (is (equal "一二一〇一〇〇〇〇" (jp-str :positional 121010000)))
  (is (equal "一二一〇九〇〇〇〇" (jp-str :positional 121090000)))
  (is (equal "一二一一〇〇〇〇〇" (jp-str :positional 121100000)))
  (is (equal "一二一一一〇〇〇〇" (jp-str :positional 121110000)))
  (is (equal "一二一一九〇〇〇〇" (jp-str :positional 121190000)))
  (is (equal "一二一二〇〇〇〇〇" (jp-str :positional 121200000)))
  (is (equal "一二一二一〇〇〇〇" (jp-str :positional 121210000)))
  (is (equal "一二一二九〇〇〇〇" (jp-str :positional 121290000)))
  (is (equal "一二二〇〇〇〇〇〇" (jp-str :positional 122000000)))
  (is (equal "一二二〇一〇〇〇〇" (jp-str :positional 122010000)))
  (is (equal "一二二〇九〇〇〇〇" (jp-str :positional 122090000)))
  (is (equal "一二二一〇〇〇〇〇" (jp-str :positional 122100000)))
  (is (equal "一二二一一〇〇〇〇" (jp-str :positional 122110000)))
  (is (equal "一二二一九〇〇〇〇" (jp-str :positional 122190000)))
  (is (equal "一二二二〇〇〇〇〇" (jp-str :positional 122200000)))
  (is (equal "一二二二一〇〇〇〇" (jp-str :positional 122210000)))
  (is (equal "一二二二九〇〇〇〇" (jp-str :positional 122290000)))
  (is (equal "一九九九九〇〇〇〇" (jp-str :positional 199990000)))

  ;; more big nums
  (let ((num 12300001001))
    (is (equal "一二三〇〇〇〇一〇〇一" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num)))
    (mulf num 10000)
    (is (equal "一二三〇〇〇〇一〇〇一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇" (jp-str :positional num))))
  ;; 
  t)

(test test-jp-positional-integer-minus
  (is (equal "−一" (jp-str :positional -1)))
  (is (equal "−二" (jp-str :positional -2)))
  (is (equal "−三" (jp-str :positional -3)))
  (is (equal "−四" (jp-str :positional -4)))
  (is (equal "−五" (jp-str :positional -5)))
  (is (equal "−六" (jp-str :positional -6)))
  (is (equal "−七" (jp-str :positional -7)))
  (is (equal "−八" (jp-str :positional -8)))
  (is (equal "−九" (jp-str :positional -9)))
  (is (equal "−一〇" (jp-str :positional -10)))
  (is (equal "−二〇" (jp-str :positional -20)))
  (is (equal "−一〇〇" (jp-str :positional -100)))
  (is (equal "−五〇〇" (jp-str :positional -500)))
  (is (equal "−一〇〇〇" (jp-str :positional -1000)))
  (is (equal "−一〇〇〇〇" (jp-str :positional -10000)))
  (is (equal "−一二三四五" (jp-str :positional -12345)))
  ;; 
  t)
  
(test test-jp-positional-rational
  (is (equal "一／二" (jp-str :positional 1/2)))
  (is (equal "一／一〇" (jp-str :positional 1/10)))
  (is (equal "一／二〇" (jp-str :positional 1/20)))
  (is (equal "一／一〇〇" (jp-str :positional 1/100)))
  (is (equal "一／一一〇" (jp-str :positional 1/110)))
  (is (equal "一／一一一" (jp-str :positional 1/111)))
  (is (equal "一／一二〇" (jp-str :positional 1/120)))
  (is (equal "一／一二一" (jp-str :positional 1/121)))
  (is (equal "一／二〇〇" (jp-str :positional 1/200)))
  (is (equal "一／二一〇" (jp-str :positional 1/210)))
  (is (equal "一／二一一" (jp-str :positional 1/211)))
  (is (equal "一／二二〇" (jp-str :positional 1/220)))
  (is (equal "一／二二一" (jp-str :positional 1/221)))
  (is (equal "一／一〇〇〇" (jp-str :positional 1/1000)))
  (is (equal "一／一〇一〇" (jp-str :positional 1/1010)))
  (is (equal "一／一〇一一" (jp-str :positional 1/1011)))
  (is (equal "一／一〇二〇" (jp-str :positional 1/1020)))
  (is (equal "一／一〇二一" (jp-str :positional 1/1021)))
  (is (equal "一／一一〇〇" (jp-str :positional 1/1100)))
  (is (equal "一／一一一〇" (jp-str :positional 1/1110)))
  (is (equal "一／一一一一" (jp-str :positional 1/1111)))
  (is (equal "一／一一二〇" (jp-str :positional 1/1120)))
  (is (equal "一／一一二一" (jp-str :positional 1/1121)))
  (is (equal "一／二二〇一" (jp-str :positional 1/2201)))
  (is (equal "一／一〇〇〇〇" (jp-str :positional 1/10000)))
  (is (equal "一／一一一一一" (jp-str :positional 1/11111)))
  (is (equal "一／二二二二二" (jp-str :positional 1/22222)))
  (is (equal "一／一〇〇〇〇〇〇〇〇" (jp-str :positional 1/100000000)))

  (is (equal "一／一九九九七" (jp-str :positional 1/19997))) ; 19997 is a prime.
  (is (equal "二／一九九九七" (jp-str :positional 2/19997)))
  (is (equal "一〇／一九九九七" (jp-str :positional 10/19997)))
  (is (equal "一一／一九九九七" (jp-str :positional 11/19997)))
  (is (equal "二一／一九九九七" (jp-str :positional 21/19997)))
  (is (equal "九九／一九九九七" (jp-str :positional 99/19997)))
  (is (equal "一〇〇／一九九九七" (jp-str :positional 100/19997)))
  (is (equal "一〇一／一九九九七" (jp-str :positional 101/19997)))
  (is (equal "一一一／一九九九七" (jp-str :positional 111/19997)))
  (is (equal "二一一／一九九九七" (jp-str :positional 211/19997)))
  (is (equal "一〇〇一／一九九九七" (jp-str :positional 1001/19997)))
  (is (equal "一一一一／一九九九七" (jp-str :positional 1111/19997)))
  (is (equal "二二二二／一九九九七" (jp-str :positional 2222/19997)))
  (is (equal "一〇〇〇〇／一九九九七" (jp-str :positional 10000/19997)))
  (is (equal "一〇〇〇一／一九九九七" (jp-str :positional 10001/19997)))
  (is (equal "一一一一〇／一九九九七" (jp-str :positional 11110/19997)))
  (is (equal "一五〇〇二／一九九九七" (jp-str :positional 15002/19997)))
  (is (equal "一九九九六／一九九九七" (jp-str :positional 19996/19997)))

  (is (equal "−一／二" (jp-str :positional -1/2)))
  ;; 
  t)
  
(test test-jp-positional-float
  ;; int
  (is (equal "〇・" (jp-str :positional 0.0)))
  (is (equal "一・" (jp-str :positional 1.0)))
  (is (equal "一〇・" (jp-str :positional 10.0)))
  ;; 0.1-0.9
  (is (equal "〇・一" (jp-str :positional 0.1)))
  (is (equal "〇・二" (jp-str :positional 0.2)))
  (is (equal "〇・三" (jp-str :positional 0.3)))
  (is (equal "〇・四" (jp-str :positional 0.4)))
  (is (equal "〇・五" (jp-str :positional 0.5)))
  (is (equal "〇・六" (jp-str :positional 0.6)))
  (is (equal "〇・七" (jp-str :positional 0.7)))
  (is (equal "〇・八" (jp-str :positional 0.8)))
  (is (equal "〇・九" (jp-str :positional 0.9)))
  ;; 0.10-0.30
  (is (equal "〇・一" (jp-str :positional 0.10)))
  (is (equal "〇・一一" (jp-str :positional 0.11)))
  (is (equal "〇・一二" (jp-str :positional 0.12)))
  (is (equal "〇・一三" (jp-str :positional 0.13)))
  (is (equal "〇・一四" (jp-str :positional 0.14)))
  (is (equal "〇・一五" (jp-str :positional 0.15)))
  (is (equal "〇・一六" (jp-str :positional 0.16)))
  (is (equal "〇・一七" (jp-str :positional 0.17)))
  (is (equal "〇・一八" (jp-str :positional 0.18)))
  (is (equal "〇・一九" (jp-str :positional 0.19)))
  (is (equal "〇・二" (jp-str :positional 0.20)))
  (is (equal "〇・二一" (jp-str :positional 0.21)))
  (is (equal "〇・二二" (jp-str :positional 0.22)))
  (is (equal "〇・二三" (jp-str :positional 0.23)))
  (is (equal "〇・二四" (jp-str :positional 0.24)))
  (is (equal "〇・二五" (jp-str :positional 0.25)))
  (is (equal "〇・二六" (jp-str :positional 0.26)))
  (is (equal "〇・二七" (jp-str :positional 0.27)))
  (is (equal "〇・二八" (jp-str :positional 0.28)))
  (is (equal "〇・二九" (jp-str :positional 0.29)))
  (is (equal "〇・三" (jp-str :positional 0.30)))
  ;; small nums
  (is (equal "一〇・三四" (jp-str :positional 10.34)))
  (is (equal "一・〇三四" (jp-str :positional 1.034)))
  (is (equal "〇・一〇三四" (jp-str :positional 0.1034)))
  (is (equal "〇・〇一〇三四" (jp-str :positional 0.01034)))
  (is (equal "〇・〇〇一〇三四" (jp-str :positional 0.001034)))
  (is (equal-or-free-format :positional "一〇・三四" 10.34))
  (is (equal-or-free-format :positional "一・〇三四" 1.034))
  (is (equal-or-free-format :positional "〇・一〇三四" 0.1034))
  (is (equal-or-free-format :positional "〇・〇一〇三四" 0.01034))
  (is (equal-or-free-format :positional "〇・〇〇一〇三四" 0.001034))
  (is (equal-or-free-format :positional "〇・〇〇〇一〇三四" 0.0001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇一〇三四" 0.00001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇一〇三四" 0.000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇一〇三四" 0.0000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇一〇三四" 0.00000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇一〇三四" 0.000000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇〇一〇三四" 0.0000000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇〇〇一〇三四" 0.00000000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇〇〇〇一〇三四" 0.000000000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇〇〇〇〇一〇三四" 0.0000000000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇一〇三四" 0.00000000000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇一〇三四" 0.000000000000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一〇三四" 0.0000000000000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一〇三四" 0.00000000000000001034))
  (is (equal-or-free-format :positional "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一〇三四" 0.000000000000000001034))
  ;; minus
  (is (equal "−〇・一" (jp-str :positional -0.1)))
  (is (equal "−〇・二" (jp-str :positional -0.2)))
  (is (equal "−〇・一一" (jp-str :positional -0.11)))
  (is (equal "−〇・〇二" (jp-str :positional -0.02)))
  (is (equal "−一・一" (jp-str :positional -1.1)))
  (is (equal "−一・〇一" (jp-str :positional -1.01)))
  ;;
  t)

(test test-jp-positional-fallback
  ;; too big num
  (is (equal "一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
	     (jp-str :positional (expt 10 68))))
  (is (equal "一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
	     (jp-str :positional (expt 10 72))))
  (is (equal "−一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
	     (jp-str :positional (- (expt 10 68)))))
  (is (equal "−一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
	     (jp-str :positional (- (expt 10 72)))))
  ;; too small num
  (is (equal-or-free-format :positional
			    "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
			    (float (expt 10 -21))))
  (is (equal-or-free-format :positional
  			    "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
  			    (float (expt 10 -22))))
  (is (equal-or-free-format :positional
  			    "−〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
  			    (- (float (expt 10 -21)))))
  (is (equal-or-free-format :positional
  			    "−〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
  			    (- (float (expt 10 -22)))))
  ;; complex
  (is (equal (format nil "~A" #c(1 1))
	     (jp-str :positional #c(1 1))))
  ;;
  t)

(test test-jp-positional-parameters
  ;; [Integer]
  ;; digits-after-dot -- ignored
  (is (equal "一" (jp-str :positional 1 :digits-after-dot nil)))
  (is (equal "一" (jp-str :positional 1 :digits-after-dot 0)))
  (is (equal "一" (jp-str :positional 1 :digits-after-dot 1)))
  #+allegro(is (equal "一" (jp-str :positional 1 :digits-after-dot -1)))
  ;; scale
  (is (equal "一" (jp-str :positional 1 :scale nil)))
  (is (equal "一" (jp-str :positional 1 :scale 0)))
  (is (equal "一〇" (jp-str :positional 1 :scale 1)))
  (is (equal "一／一〇" (jp-str :positional 1 :scale -1)))
  ;; radix-point
  (is (equal "一" (jp-str :positional 1 :radix-point nil)))
  (is (equal "一a" (jp-str :positional 1 :radix-point #\a)))
  (is (equal "一abc" (jp-str :positional 1 :radix-point "abc")))

  ;; [Rational]
  ;; digits-after-dot -- ignored
  (is (equal "一／二" (jp-str :positional 1/2 :digits-after-dot nil)))
  (is (equal "一／二" (jp-str :positional 1/2 :digits-after-dot 0)))
  (is (equal "一／二" (jp-str :positional 1/2 :digits-after-dot 1)))
  #+allegro(is (equal "一／二" (jp-str :positional 1/2 :digits-after-dot -1)))
  ;; scale
  (is (equal "一／二" (jp-str :positional 1/2 :scale nil)))
  (is (equal "一／二" (jp-str :positional 1/2 :scale 0)))
  (is (equal "五" (jp-str :positional 1/2 :scale 1)))
  (is (equal "一／二〇" (jp-str :positional 1/2 :scale -1)))
  ;; radix-point
  (is (equal "一／二" (jp-str :positional 1/2 :radix-point nil)))
  (is (equal "一／二a" (jp-str :positional 1/2 :radix-point #\a)))
  (is (equal "一／二abc" (jp-str :positional 1/2 :radix-point "abc")))

  ;; [Float]
  ;; digits-after-dot
  (is (equal "一二・三四" (jp-str :positional 12.34 :digits-after-dot nil)))
  (is (equal "一二・" (jp-str :positional 12.34 :digits-after-dot 0)))
  (is (equal "一二・三" (jp-str :positional 12.34 :digits-after-dot 1)))
  (is (equal "一二・三四" (jp-str :positional 12.34 :digits-after-dot 2)))
  (is (equal "一二・三四〇" (jp-str :positional 12.34 :digits-after-dot 3)))
  #+allegro(is (equal "一〇・" (jp-str :positional 12.34 :digits-after-dot -1)))
  #+allegro(is (equal "〇・" (jp-str :positional 12.34 :digits-after-dot -2)))
  ;; scale
  (is (equal "一二・三四" (jp-str :positional 12.34 :scale nil)))
  (is (equal "一二・三四" (jp-str :positional 12.34 :scale 0)))
  (is (equal "一二三・四" (jp-str :positional 12.34 :scale 1)))
  (is (equal "一二三四・" (jp-str :positional 12.34 :scale 2)))
  (is (equal "一・二三四" (jp-str :positional 12.34 :scale -1)))
  (is (equal "〇・一二三四" (jp-str :positional 12.34 :scale -2)))
  ;; radix-point
  (is (equal "一二・三四" (jp-str :positional 12.34 :radix-point nil)))
  (is (equal "一二a三四" (jp-str :positional 12.34 :radix-point #\a)))
  (is (equal "一二abc三四" (jp-str :positional 12.34 :radix-point "abc")))
  (is (equal "一二三四abc" (jp-str :positional 12.34 :radix-point "abc" :scale 2)))
  (is (equal "〇abc一二三四" (jp-str :positional 12.34 :radix-point "abc" :scale -2)))

  ;; 
  t)
