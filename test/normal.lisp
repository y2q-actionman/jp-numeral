;;; -*- coding: utf-8; -*-

(in-package :jp-numeral.test)

(defun test-jp-normal-integer-4digits ()
  ;; 0
  (assert-equal "〇" (jp-str :normal 0))
  ;; 1-9
  (assert-equal "一" (jp-str :normal 1))
  (assert-equal "二" (jp-str :normal 2))
  (assert-equal "三" (jp-str :normal 3))
  (assert-equal "四" (jp-str :normal 4))
  (assert-equal "五" (jp-str :normal 5))
  (assert-equal "六" (jp-str :normal 6))
  (assert-equal "七" (jp-str :normal 7))
  (assert-equal "八" (jp-str :normal 8))
  (assert-equal "九" (jp-str :normal 9))
  ;; 10-19
  (assert-equal "十" (jp-str :normal 10))
  (assert-equal "十一" (jp-str :normal 11))
  (assert-equal "十二" (jp-str :normal 12))
  (assert-equal "十三" (jp-str :normal 13))
  (assert-equal "十四" (jp-str :normal 14))
  (assert-equal "十五" (jp-str :normal 15))
  (assert-equal "十六" (jp-str :normal 16))
  (assert-equal "十七" (jp-str :normal 17))
  (assert-equal "十八" (jp-str :normal 18))
  (assert-equal "十九" (jp-str :normal 19))
  ;; 20-99
  (assert-equal "二十" (jp-str :normal 20))
  (assert-equal "二十一" (jp-str :normal 21))
  (assert-equal "二十九" (jp-str :normal 29))
  (assert-equal "三十" (jp-str :normal 30))
  (assert-equal "三十一" (jp-str :normal 31))
  (assert-equal "三十九" (jp-str :normal 39))
  (assert-equal "四十" (jp-str :normal 40))
  (assert-equal "四十一" (jp-str :normal 41))
  (assert-equal "四十九" (jp-str :normal 49))
  (assert-equal "五十" (jp-str :normal 50))
  (assert-equal "五十一" (jp-str :normal 51))
  (assert-equal "五十九" (jp-str :normal 59))
  (assert-equal "六十" (jp-str :normal 60))
  (assert-equal "六十一" (jp-str :normal 61))
  (assert-equal "六十九" (jp-str :normal 69))
  (assert-equal "七十" (jp-str :normal 70))
  (assert-equal "七十一" (jp-str :normal 71))
  (assert-equal "七十九" (jp-str :normal 79))
  (assert-equal "八十" (jp-str :normal 80))
  (assert-equal "八十一" (jp-str :normal 81))
  (assert-equal "八十九" (jp-str :normal 89))
  (assert-equal "九十" (jp-str :normal 90))
  (assert-equal "九十一" (jp-str :normal 91))
  (assert-equal "九十九" (jp-str :normal 99))
  ;; 100
  (assert-equal "百" (jp-str :normal 100))
  ;; 101-109
  (assert-equal "百一" (jp-str :normal 101))
  (assert-equal "百二" (jp-str :normal 102))
  (assert-equal "百三" (jp-str :normal 103))
  (assert-equal "百四" (jp-str :normal 104))
  (assert-equal "百五" (jp-str :normal 105))
  (assert-equal "百六" (jp-str :normal 106))
  (assert-equal "百七" (jp-str :normal 107))
  (assert-equal "百八" (jp-str :normal 108))
  (assert-equal "百九" (jp-str :normal 109))
  ;; 110-119
  (assert-equal "百十" (jp-str :normal 110))
  (assert-equal "百十一" (jp-str :normal 111))
  (assert-equal "百十二" (jp-str :normal 112))
  (assert-equal "百十三" (jp-str :normal 113))
  (assert-equal "百十四" (jp-str :normal 114))
  (assert-equal "百十五" (jp-str :normal 115))
  (assert-equal "百十六" (jp-str :normal 116))
  (assert-equal "百十七" (jp-str :normal 117))
  (assert-equal "百十八" (jp-str :normal 118))
  (assert-equal "百十九" (jp-str :normal 119))
  ;; 120-199
  (assert-equal "百二十" (jp-str :normal 120))
  (assert-equal "百二十一" (jp-str :normal 121))
  (assert-equal "百二十九" (jp-str :normal 129))
  (assert-equal "百三十" (jp-str :normal 130))
  (assert-equal "百三十一" (jp-str :normal 131))
  (assert-equal "百三十九" (jp-str :normal 139))
  (assert-equal "百四十" (jp-str :normal 140))
  (assert-equal "百四十一" (jp-str :normal 141))
  (assert-equal "百四十九" (jp-str :normal 149))
  (assert-equal "百五十" (jp-str :normal 150))
  (assert-equal "百五十一" (jp-str :normal 151))
  (assert-equal "百五十九" (jp-str :normal 159))
  (assert-equal "百六十" (jp-str :normal 160))
  (assert-equal "百六十一" (jp-str :normal 161))
  (assert-equal "百六十九" (jp-str :normal 169))
  (assert-equal "百七十" (jp-str :normal 170))
  (assert-equal "百七十一" (jp-str :normal 171))
  (assert-equal "百七十九" (jp-str :normal 179))
  (assert-equal "百八十" (jp-str :normal 180))
  (assert-equal "百八十一" (jp-str :normal 181))
  (assert-equal "百八十九" (jp-str :normal 189))
  (assert-equal "百九十" (jp-str :normal 190))
  (assert-equal "百九十一" (jp-str :normal 191))
  (assert-equal "百九十九" (jp-str :normal 199))
  ;; 200-999
  (assert-equal "二百" (jp-str :normal 200))
  (assert-equal "二百一" (jp-str :normal 201))
  (assert-equal "二百九" (jp-str :normal 209))
  (assert-equal "二百十" (jp-str :normal 210))
  (assert-equal "二百十一" (jp-str :normal 211))
  (assert-equal "二百十九" (jp-str :normal 219))
  (assert-equal "二百二十" (jp-str :normal 220))
  (assert-equal "二百二十一" (jp-str :normal 221))
  (assert-equal "二百九十九" (jp-str :normal 299))
  (assert-equal "三百" (jp-str :normal 300))
  (assert-equal "三百一" (jp-str :normal 301))
  (assert-equal "三百九" (jp-str :normal 309))
  (assert-equal "三百十" (jp-str :normal 310))
  (assert-equal "三百十一" (jp-str :normal 311))
  (assert-equal "三百十九" (jp-str :normal 319))
  (assert-equal "三百二十" (jp-str :normal 320))
  (assert-equal "三百二十一" (jp-str :normal 321))
  (assert-equal "三百九十九" (jp-str :normal 399))
  (assert-equal "四百" (jp-str :normal 400))
  (assert-equal "四百一" (jp-str :normal 401))
  (assert-equal "四百九" (jp-str :normal 409))
  (assert-equal "四百十" (jp-str :normal 410))
  (assert-equal "四百十一" (jp-str :normal 411))
  (assert-equal "四百十九" (jp-str :normal 419))
  (assert-equal "四百二十" (jp-str :normal 420))
  (assert-equal "四百二十一" (jp-str :normal 421))
  (assert-equal "四百九十九" (jp-str :normal 499))
  (assert-equal "五百" (jp-str :normal 500))
  (assert-equal "五百一" (jp-str :normal 501))
  (assert-equal "五百九" (jp-str :normal 509))
  (assert-equal "五百十" (jp-str :normal 510))
  (assert-equal "五百十一" (jp-str :normal 511))
  (assert-equal "五百十九" (jp-str :normal 519))
  (assert-equal "五百二十" (jp-str :normal 520))
  (assert-equal "五百二十一" (jp-str :normal 521))
  (assert-equal "五百九十九" (jp-str :normal 599))
  (assert-equal "六百" (jp-str :normal 600))
  (assert-equal "六百一" (jp-str :normal 601))
  (assert-equal "六百九" (jp-str :normal 609))
  (assert-equal "六百十" (jp-str :normal 610))
  (assert-equal "六百十一" (jp-str :normal 611))
  (assert-equal "六百十九" (jp-str :normal 619))
  (assert-equal "六百二十" (jp-str :normal 620))
  (assert-equal "六百二十一" (jp-str :normal 621))
  (assert-equal "六百九十九" (jp-str :normal 699))
  (assert-equal "七百" (jp-str :normal 700))
  (assert-equal "七百一" (jp-str :normal 701))
  (assert-equal "七百九" (jp-str :normal 709))
  (assert-equal "七百十" (jp-str :normal 710))
  (assert-equal "七百十一" (jp-str :normal 711))
  (assert-equal "七百十九" (jp-str :normal 719))
  (assert-equal "七百二十" (jp-str :normal 720))
  (assert-equal "七百二十一" (jp-str :normal 721))
  (assert-equal "七百九十九" (jp-str :normal 799))
  (assert-equal "八百" (jp-str :normal 800))
  (assert-equal "八百一" (jp-str :normal 801))
  (assert-equal "八百九" (jp-str :normal 809))
  (assert-equal "八百十" (jp-str :normal 810))
  (assert-equal "八百十一" (jp-str :normal 811))
  (assert-equal "八百十九" (jp-str :normal 819))
  (assert-equal "八百二十" (jp-str :normal 820))
  (assert-equal "八百二十一" (jp-str :normal 821))
  (assert-equal "八百九十九" (jp-str :normal 899))
  (assert-equal "九百" (jp-str :normal 900))
  (assert-equal "九百一" (jp-str :normal 901))
  (assert-equal "九百九" (jp-str :normal 909))
  (assert-equal "九百十" (jp-str :normal 910))
  (assert-equal "九百十一" (jp-str :normal 911))
  (assert-equal "九百十九" (jp-str :normal 919))
  (assert-equal "九百二十" (jp-str :normal 920))
  (assert-equal "九百二十一" (jp-str :normal 921))
  (assert-equal "九百九十九" (jp-str :normal 999))
  ;; 1000 - 1099
  (assert-equal "千" (jp-str :normal 1000))
  (assert-equal "千一" (jp-str :normal 1001))
  (assert-equal "千二" (jp-str :normal 1002))
  (assert-equal "千九" (jp-str :normal 1009))
  (assert-equal "千十" (jp-str :normal 1010))
  (assert-equal "千十一" (jp-str :normal 1011))
  (assert-equal "千十九" (jp-str :normal 1019))
  (assert-equal "千二十" (jp-str :normal 1020))
  (assert-equal "千二十一" (jp-str :normal 1021))
  (assert-equal "千二十九" (jp-str :normal 1029))
  (assert-equal "千三十" (jp-str :normal 1030))
  (assert-equal "千九十九" (jp-str :normal 1099))
  ;; 1100 - 9999
  (assert-equal "千百" (jp-str :normal 1100))
  (assert-equal "千百一" (jp-str :normal 1101))
  (assert-equal "千百九" (jp-str :normal 1109))
  (assert-equal "千百十" (jp-str :normal 1110))
  (assert-equal "千百十一" (jp-str :normal 1111))
  (assert-equal "千百十九" (jp-str :normal 1119))
  (assert-equal "千百二十" (jp-str :normal 1120))
  (assert-equal "千百二十一" (jp-str :normal 1121))
  (assert-equal "千百二十九" (jp-str :normal 1129))
  (assert-equal "千百九十九" (jp-str :normal 1199))
  (assert-equal "千二百" (jp-str :normal 1200))
  (assert-equal "千二百一" (jp-str :normal 1201))
  (assert-equal "千二百九" (jp-str :normal 1209))
  (assert-equal "千二百十" (jp-str :normal 1210))
  (assert-equal "千二百十一" (jp-str :normal 1211))
  (assert-equal "千二百十九" (jp-str :normal 1219))
  (assert-equal "千二百二十" (jp-str :normal 1220))
  (assert-equal "千二百二十一" (jp-str :normal 1221))
  (assert-equal "千二百二十九" (jp-str :normal 1229))
  (assert-equal "千二百九十九" (jp-str :normal 1299))
  (assert-equal "千九百" (jp-str :normal 1900))
  (assert-equal "千九百一" (jp-str :normal 1901))
  (assert-equal "千九百九" (jp-str :normal 1909))
  (assert-equal "千九百十" (jp-str :normal 1910))
  (assert-equal "千九百十一" (jp-str :normal 1911))
  (assert-equal "千九百十九" (jp-str :normal 1919))
  (assert-equal "千九百二十" (jp-str :normal 1920))
  (assert-equal "千九百二十一" (jp-str :normal 1921))
  (assert-equal "千九百二十九" (jp-str :normal 1929))
  (assert-equal "千九百九十九" (jp-str :normal 1999))
  ;; 2000 - 9999
  (assert-equal "二千" (jp-str :normal 2000))
  (assert-equal "二千一" (jp-str :normal 2001))
  (assert-equal "二千十" (jp-str :normal 2010))
  (assert-equal "二千十一" (jp-str :normal 2011))
  (assert-equal "二千二十" (jp-str :normal 2020))
  (assert-equal "二千二十一" (jp-str :normal 2021))
  (assert-equal "二千百" (jp-str :normal 2100))
  (assert-equal "二千百一" (jp-str :normal 2101))
  (assert-equal "二千百十" (jp-str :normal 2110))
  (assert-equal "二千百十一" (jp-str :normal 2111))
  (assert-equal "二千百二十" (jp-str :normal 2120))
  (assert-equal "二千百二十一" (jp-str :normal 2121))
  (assert-equal "二千二百" (jp-str :normal 2200))
  (assert-equal "二千二百一" (jp-str :normal 2201))
  (assert-equal "二千二百十" (jp-str :normal 2210))
  (assert-equal "二千二百十一" (jp-str :normal 2211))
  (assert-equal "二千二百二十" (jp-str :normal 2220))
  (assert-equal "二千二百二十一" (jp-str :normal 2221))
  (assert-equal "三千" (jp-str :normal 3000))
  (assert-equal "三千一" (jp-str :normal 3001))
  (assert-equal "三千十" (jp-str :normal 3010))
  (assert-equal "三千十一" (jp-str :normal 3011))
  (assert-equal "三千二十" (jp-str :normal 3020))
  (assert-equal "三千二十一" (jp-str :normal 3021))
  (assert-equal "三千百" (jp-str :normal 3100))
  (assert-equal "三千百一" (jp-str :normal 3101))
  (assert-equal "三千百十" (jp-str :normal 3110))
  (assert-equal "三千百十一" (jp-str :normal 3111))
  (assert-equal "三千百二十" (jp-str :normal 3120))
  (assert-equal "三千百二十一" (jp-str :normal 3121))
  (assert-equal "三千二百" (jp-str :normal 3200))
  (assert-equal "三千二百一" (jp-str :normal 3201))
  (assert-equal "三千二百十" (jp-str :normal 3210))
  (assert-equal "三千二百十一" (jp-str :normal 3211))
  (assert-equal "三千二百二十" (jp-str :normal 3220))
  (assert-equal "三千二百二十一" (jp-str :normal 3221))
  (assert-equal "四千" (jp-str :normal 4000))
  (assert-equal "四千一" (jp-str :normal 4001))
  (assert-equal "四千十" (jp-str :normal 4010))
  (assert-equal "四千十一" (jp-str :normal 4011))
  (assert-equal "四千二十" (jp-str :normal 4020))
  (assert-equal "四千二十一" (jp-str :normal 4021))
  (assert-equal "四千百" (jp-str :normal 4100))
  (assert-equal "四千百一" (jp-str :normal 4101))
  (assert-equal "四千百十" (jp-str :normal 4110))
  (assert-equal "四千百十一" (jp-str :normal 4111))
  (assert-equal "四千百二十" (jp-str :normal 4120))
  (assert-equal "四千百二十一" (jp-str :normal 4121))
  (assert-equal "四千二百" (jp-str :normal 4200))
  (assert-equal "四千二百一" (jp-str :normal 4201))
  (assert-equal "四千二百十" (jp-str :normal 4210))
  (assert-equal "四千二百十一" (jp-str :normal 4211))
  (assert-equal "四千二百二十" (jp-str :normal 4220))
  (assert-equal "四千二百二十一" (jp-str :normal 4221))
  (assert-equal "五千" (jp-str :normal 5000))
  (assert-equal "五千一" (jp-str :normal 5001))
  (assert-equal "五千十" (jp-str :normal 5010))
  (assert-equal "五千十一" (jp-str :normal 5011))
  (assert-equal "五千二十" (jp-str :normal 5020))
  (assert-equal "五千二十一" (jp-str :normal 5021))
  (assert-equal "五千百" (jp-str :normal 5100))
  (assert-equal "五千百一" (jp-str :normal 5101))
  (assert-equal "五千百十" (jp-str :normal 5110))
  (assert-equal "五千百十一" (jp-str :normal 5111))
  (assert-equal "五千百二十" (jp-str :normal 5120))
  (assert-equal "五千百二十一" (jp-str :normal 5121))
  (assert-equal "五千二百" (jp-str :normal 5200))
  (assert-equal "五千二百一" (jp-str :normal 5201))
  (assert-equal "五千二百十" (jp-str :normal 5210))
  (assert-equal "五千二百十一" (jp-str :normal 5211))
  (assert-equal "五千二百二十" (jp-str :normal 5220))
  (assert-equal "五千二百二十一" (jp-str :normal 5221))
  (assert-equal "六千" (jp-str :normal 6000))
  (assert-equal "六千一" (jp-str :normal 6001))
  (assert-equal "六千十" (jp-str :normal 6010))
  (assert-equal "六千十一" (jp-str :normal 6011))
  (assert-equal "六千二十" (jp-str :normal 6020))
  (assert-equal "六千二十一" (jp-str :normal 6021))
  (assert-equal "六千百" (jp-str :normal 6100))
  (assert-equal "六千百一" (jp-str :normal 6101))
  (assert-equal "六千百十" (jp-str :normal 6110))
  (assert-equal "六千百十一" (jp-str :normal 6111))
  (assert-equal "六千百二十" (jp-str :normal 6120))
  (assert-equal "六千百二十一" (jp-str :normal 6121))
  (assert-equal "六千二百" (jp-str :normal 6200))
  (assert-equal "六千二百一" (jp-str :normal 6201))
  (assert-equal "六千二百十" (jp-str :normal 6210))
  (assert-equal "六千二百十一" (jp-str :normal 6211))
  (assert-equal "六千二百二十" (jp-str :normal 6220))
  (assert-equal "六千二百二十一" (jp-str :normal 6221))
  (assert-equal "七千" (jp-str :normal 7000))
  (assert-equal "七千一" (jp-str :normal 7001))
  (assert-equal "七千十" (jp-str :normal 7010))
  (assert-equal "七千十一" (jp-str :normal 7011))
  (assert-equal "七千二十" (jp-str :normal 7020))
  (assert-equal "七千二十一" (jp-str :normal 7021))
  (assert-equal "七千百" (jp-str :normal 7100))
  (assert-equal "七千百一" (jp-str :normal 7101))
  (assert-equal "七千百十" (jp-str :normal 7110))
  (assert-equal "七千百十一" (jp-str :normal 7111))
  (assert-equal "七千百二十" (jp-str :normal 7120))
  (assert-equal "七千百二十一" (jp-str :normal 7121))
  (assert-equal "七千二百" (jp-str :normal 7200))
  (assert-equal "七千二百一" (jp-str :normal 7201))
  (assert-equal "七千二百十" (jp-str :normal 7210))
  (assert-equal "七千二百十一" (jp-str :normal 7211))
  (assert-equal "七千二百二十" (jp-str :normal 7220))
  (assert-equal "七千二百二十一" (jp-str :normal 7221))
  (assert-equal "八千" (jp-str :normal 8000))
  (assert-equal "八千一" (jp-str :normal 8001))
  (assert-equal "八千十" (jp-str :normal 8010))
  (assert-equal "八千十一" (jp-str :normal 8011))
  (assert-equal "八千二十" (jp-str :normal 8020))
  (assert-equal "八千二十一" (jp-str :normal 8021))
  (assert-equal "八千百" (jp-str :normal 8100))
  (assert-equal "八千百一" (jp-str :normal 8101))
  (assert-equal "八千百十" (jp-str :normal 8110))
  (assert-equal "八千百十一" (jp-str :normal 8111))
  (assert-equal "八千百二十" (jp-str :normal 8120))
  (assert-equal "八千百二十一" (jp-str :normal 8121))
  (assert-equal "八千二百" (jp-str :normal 8200))
  (assert-equal "八千二百一" (jp-str :normal 8201))
  (assert-equal "八千二百十" (jp-str :normal 8210))
  (assert-equal "八千二百十一" (jp-str :normal 8211))
  (assert-equal "八千二百二十" (jp-str :normal 8220))
  (assert-equal "八千二百二十一" (jp-str :normal 8221))
  (assert-equal "九千" (jp-str :normal 9000))
  (assert-equal "九千一" (jp-str :normal 9001))
  (assert-equal "九千十" (jp-str :normal 9010))
  (assert-equal "九千十一" (jp-str :normal 9011))
  (assert-equal "九千二十" (jp-str :normal 9020))
  (assert-equal "九千二十一" (jp-str :normal 9021))
  (assert-equal "九千百" (jp-str :normal 9100))
  (assert-equal "九千百一" (jp-str :normal 9101))
  (assert-equal "九千百十" (jp-str :normal 9110))
  (assert-equal "九千百十一" (jp-str :normal 9111))
  (assert-equal "九千百二十" (jp-str :normal 9120))
  (assert-equal "九千百二十一" (jp-str :normal 9121))
  (assert-equal "九千二百" (jp-str :normal 9200))
  (assert-equal "九千二百一" (jp-str :normal 9201))
  (assert-equal "九千二百十" (jp-str :normal 9210))
  (assert-equal "九千二百十一" (jp-str :normal 9211))
  (assert-equal "九千二百二十" (jp-str :normal 9220))
  (assert-equal "九千二百二十一" (jp-str :normal 9221))
  (assert-equal "九千九百九十九" (jp-str :normal 9999))
  ;; 
  t)

(defun test-jp-normal-integer-bignums ()
  ;; 10000 - 19999
  (assert-equal "一万" (jp-str :normal 10000))
  (assert-equal "一万一" (jp-str :normal 10001))
  (assert-equal "一万九" (jp-str :normal 10009))
  (assert-equal "一万十" (jp-str :normal 10010))
  (assert-equal "一万十一" (jp-str :normal 10011))
  (assert-equal "一万十九" (jp-str :normal 10019))
  (assert-equal "一万二十" (jp-str :normal 10020))
  (assert-equal "一万二十一" (jp-str :normal 10021))
  (assert-equal "一万二十九" (jp-str :normal 10029))
  (assert-equal "一万百" (jp-str :normal 10100))
  (assert-equal "一万百一" (jp-str :normal 10101))
  (assert-equal "一万百九" (jp-str :normal 10109))
  (assert-equal "一万百十" (jp-str :normal 10110))
  (assert-equal "一万百十一" (jp-str :normal 10111))
  (assert-equal "一万百十九" (jp-str :normal 10119))
  (assert-equal "一万百二十" (jp-str :normal 10120))
  (assert-equal "一万百二十一" (jp-str :normal 10121))
  (assert-equal "一万百二十九" (jp-str :normal 10129))
  (assert-equal "一万二百" (jp-str :normal 10200))
  (assert-equal "一万二百一" (jp-str :normal 10201))
  (assert-equal "一万二百九" (jp-str :normal 10209))
  (assert-equal "一万二百十" (jp-str :normal 10210))
  (assert-equal "一万二百十一" (jp-str :normal 10211))
  (assert-equal "一万二百十九" (jp-str :normal 10219))
  (assert-equal "一万二百二十" (jp-str :normal 10220))
  (assert-equal "一万二百二十一" (jp-str :normal 10221))
  (assert-equal "一万二百二十九" (jp-str :normal 10229))
  (assert-equal "一万千" (jp-str :normal 11000))
  (assert-equal "一万千一" (jp-str :normal 11001))
  (assert-equal "一万千九" (jp-str :normal 11009))
  (assert-equal "一万千十" (jp-str :normal 11010))
  (assert-equal "一万千十一" (jp-str :normal 11011))
  (assert-equal "一万千十九" (jp-str :normal 11019))
  (assert-equal "一万千二十" (jp-str :normal 11020))
  (assert-equal "一万千二十一" (jp-str :normal 11021))
  (assert-equal "一万千二十九" (jp-str :normal 11029))
  (assert-equal "一万千百" (jp-str :normal 11100))
  (assert-equal "一万千百一" (jp-str :normal 11101))
  (assert-equal "一万千百九" (jp-str :normal 11109))
  (assert-equal "一万千百十" (jp-str :normal 11110))
  (assert-equal "一万千百十一" (jp-str :normal 11111))
  (assert-equal "一万千百十九" (jp-str :normal 11119))
  (assert-equal "一万千百二十" (jp-str :normal 11120))
  (assert-equal "一万千百二十一" (jp-str :normal 11121))
  (assert-equal "一万千百二十九" (jp-str :normal 11129))
  (assert-equal "一万千二百" (jp-str :normal 11200))
  (assert-equal "一万千二百一" (jp-str :normal 11201))
  (assert-equal "一万千二百九" (jp-str :normal 11209))
  (assert-equal "一万千二百十" (jp-str :normal 11210))
  (assert-equal "一万千二百十一" (jp-str :normal 11211))
  (assert-equal "一万千二百十九" (jp-str :normal 11219))
  (assert-equal "一万千二百二十" (jp-str :normal 11220))
  (assert-equal "一万千二百二十一" (jp-str :normal 11221))
  (assert-equal "一万千二百二十九" (jp-str :normal 11229))
  (assert-equal "一万二千" (jp-str :normal 12000))
  (assert-equal "一万二千一" (jp-str :normal 12001))
  (assert-equal "一万二千九" (jp-str :normal 12009))
  (assert-equal "一万二千十" (jp-str :normal 12010))
  (assert-equal "一万二千十一" (jp-str :normal 12011))
  (assert-equal "一万二千十九" (jp-str :normal 12019))
  (assert-equal "一万二千二十" (jp-str :normal 12020))
  (assert-equal "一万二千二十一" (jp-str :normal 12021))
  (assert-equal "一万二千二十九" (jp-str :normal 12029))
  (assert-equal "一万二千百" (jp-str :normal 12100))
  (assert-equal "一万二千百一" (jp-str :normal 12101))
  (assert-equal "一万二千百九" (jp-str :normal 12109))
  (assert-equal "一万二千百十" (jp-str :normal 12110))
  (assert-equal "一万二千百十一" (jp-str :normal 12111))
  (assert-equal "一万二千百十九" (jp-str :normal 12119))
  (assert-equal "一万二千百二十" (jp-str :normal 12120))
  (assert-equal "一万二千百二十一" (jp-str :normal 12121))
  (assert-equal "一万二千百二十九" (jp-str :normal 12129))
  (assert-equal "一万二千二百" (jp-str :normal 12200))
  (assert-equal "一万二千二百一" (jp-str :normal 12201))
  (assert-equal "一万二千二百九" (jp-str :normal 12209))
  (assert-equal "一万二千二百十" (jp-str :normal 12210))
  (assert-equal "一万二千二百十一" (jp-str :normal 12211))
  (assert-equal "一万二千二百十九" (jp-str :normal 12219))
  (assert-equal "一万二千二百二十" (jp-str :normal 12220))
  (assert-equal "一万二千二百二十一" (jp-str :normal 12221))
  (assert-equal "一万二千二百二十九" (jp-str :normal 12229))
  (assert-equal "一万九千九百九十九" (jp-str :normal 19999))
  ;; 20000 - 99990000
  (assert-equal "二万" (jp-str :normal 20000))
  (assert-equal "九万" (jp-str :normal 90000))
  (assert-equal "十万" (jp-str :normal 100000))
  (assert-equal "十一万" (jp-str :normal 110000))
  (assert-equal "十九万" (jp-str :normal 190000))
  (assert-equal "二十万" (jp-str :normal 200000))
  (assert-equal "二十一万" (jp-str :normal 210000))
  (assert-equal "二十九万" (jp-str :normal 290000))
  (assert-equal "百万" (jp-str :normal 1000000))
  (assert-equal "百一万" (jp-str :normal 1010000))
  (assert-equal "百九万" (jp-str :normal 1090000))
  (assert-equal "百十万" (jp-str :normal 1100000))
  (assert-equal "百十一万" (jp-str :normal 1110000))
  (assert-equal "百十九万" (jp-str :normal 1190000))
  (assert-equal "百二十万" (jp-str :normal 1200000))
  (assert-equal "百二十一万" (jp-str :normal 1210000))
  (assert-equal "百二十九万" (jp-str :normal 1290000))
  (assert-equal "二百万" (jp-str :normal 2000000))
  (assert-equal "二百一万" (jp-str :normal 2010000))
  (assert-equal "二百九万" (jp-str :normal 2090000))
  (assert-equal "二百十万" (jp-str :normal 2100000))
  (assert-equal "二百十一万" (jp-str :normal 2110000))
  (assert-equal "二百十九万" (jp-str :normal 2190000))
  (assert-equal "二百二十万" (jp-str :normal 2200000))
  (assert-equal "二百二十一万" (jp-str :normal 2210000))
  (assert-equal "二百二十九万" (jp-str :normal 2290000))
  (assert-equal "一千万" (jp-str :normal 10000000))
  (assert-equal "千一万" (jp-str :normal 10010000))
  (assert-equal "千九万" (jp-str :normal 10090000))
  (assert-equal "千十万" (jp-str :normal 10100000))
  (assert-equal "千十一万" (jp-str :normal 10110000))
  (assert-equal "千十九万" (jp-str :normal 10190000))
  (assert-equal "千二十万" (jp-str :normal 10200000))
  (assert-equal "千二十一万" (jp-str :normal 10210000))
  (assert-equal "千二十九万" (jp-str :normal 10290000))
  (assert-equal "千百万" (jp-str :normal 11000000))
  (assert-equal "千百一万" (jp-str :normal 11010000))
  (assert-equal "千百九万" (jp-str :normal 11090000))
  (assert-equal "千百十万" (jp-str :normal 11100000))
  (assert-equal "千百十一万" (jp-str :normal 11110000))
  (assert-equal "千百十九万" (jp-str :normal 11190000))
  (assert-equal "千百二十万" (jp-str :normal 11200000))
  (assert-equal "千百二十一万" (jp-str :normal 11210000))
  (assert-equal "千百二十九万" (jp-str :normal 11290000))
  (assert-equal "千二百万" (jp-str :normal 12000000))
  (assert-equal "千二百一万" (jp-str :normal 12010000))
  (assert-equal "千二百九万" (jp-str :normal 12090000))
  (assert-equal "千二百十万" (jp-str :normal 12100000))
  (assert-equal "千二百十一万" (jp-str :normal 12110000))
  (assert-equal "千二百十九万" (jp-str :normal 12190000))
  (assert-equal "千二百二十万" (jp-str :normal 12200000))
  (assert-equal "千二百二十一万" (jp-str :normal 12210000))
  (assert-equal "千二百二十九万" (jp-str :normal 12290000))
  (assert-equal "二千万" (jp-str :normal 20000000))
  (assert-equal "二千一万" (jp-str :normal 20010000))
  (assert-equal "二千九万" (jp-str :normal 20090000))
  (assert-equal "二千十万" (jp-str :normal 20100000))
  (assert-equal "二千十一万" (jp-str :normal 20110000))
  (assert-equal "二千十九万" (jp-str :normal 20190000))
  (assert-equal "二千二十万" (jp-str :normal 20200000))
  (assert-equal "二千二十一万" (jp-str :normal 20210000))
  (assert-equal "二千二十九万" (jp-str :normal 20290000))
  (assert-equal "二千百万" (jp-str :normal 21000000))
  (assert-equal "二千百一万" (jp-str :normal 21010000))
  (assert-equal "二千百九万" (jp-str :normal 21090000))
  (assert-equal "二千百十万" (jp-str :normal 21100000))
  (assert-equal "二千百十一万" (jp-str :normal 21110000))
  (assert-equal "二千百十九万" (jp-str :normal 21190000))
  (assert-equal "二千百二十万" (jp-str :normal 21200000))
  (assert-equal "二千百二十一万" (jp-str :normal 21210000))
  (assert-equal "二千百二十九万" (jp-str :normal 21290000))
  (assert-equal "二千二百万" (jp-str :normal 22000000))
  (assert-equal "二千二百一万" (jp-str :normal 22010000))
  (assert-equal "二千二百九万" (jp-str :normal 22090000))
  (assert-equal "二千二百十万" (jp-str :normal 22100000))
  (assert-equal "二千二百十一万" (jp-str :normal 22110000))
  (assert-equal "二千二百十九万" (jp-str :normal 22190000))
  (assert-equal "二千二百二十万" (jp-str :normal 22200000))
  (assert-equal "二千二百二十一万" (jp-str :normal 22210000))
  (assert-equal "二千二百二十九万" (jp-str :normal 22290000))
  (assert-equal "九千九百九十九万" (jp-str :normal 99990000))
  ;; 100000000 - 100009999
  (assert-equal "一億" (jp-str :normal 100000000))
  (assert-equal "一億一" (jp-str :normal 100000001))
  (assert-equal "一億九" (jp-str :normal 100000009))
  (assert-equal "一億十" (jp-str :normal 100000010))
  (assert-equal "一億十一" (jp-str :normal 100000011))
  (assert-equal "一億十九" (jp-str :normal 100000019))
  (assert-equal "一億二十" (jp-str :normal 100000020))
  (assert-equal "一億二十一" (jp-str :normal 100000021))
  (assert-equal "一億二十九" (jp-str :normal 100000029))
  (assert-equal "一億百" (jp-str :normal 100000100))
  (assert-equal "一億百一" (jp-str :normal 100000101))
  (assert-equal "一億百九" (jp-str :normal 100000109))
  (assert-equal "一億百十" (jp-str :normal 100000110))
  (assert-equal "一億百十一" (jp-str :normal 100000111))
  (assert-equal "一億百十九" (jp-str :normal 100000119))
  (assert-equal "一億百二十" (jp-str :normal 100000120))
  (assert-equal "一億百二十一" (jp-str :normal 100000121))
  (assert-equal "一億百二十九" (jp-str :normal 100000129))
  (assert-equal "一億二百" (jp-str :normal 100000200))
  (assert-equal "一億二百一" (jp-str :normal 100000201))
  (assert-equal "一億二百九" (jp-str :normal 100000209))
  (assert-equal "一億二百十" (jp-str :normal 100000210))
  (assert-equal "一億二百十一" (jp-str :normal 100000211))
  (assert-equal "一億二百十九" (jp-str :normal 100000219))
  (assert-equal "一億二百二十" (jp-str :normal 100000220))
  (assert-equal "一億二百二十一" (jp-str :normal 100000221))
  (assert-equal "一億二百二十九" (jp-str :normal 100000229))
  (assert-equal "一億千" (jp-str :normal 100001000))
  (assert-equal "一億千一" (jp-str :normal 100001001))
  (assert-equal "一億千九" (jp-str :normal 100001009))
  (assert-equal "一億千十" (jp-str :normal 100001010))
  (assert-equal "一億千十一" (jp-str :normal 100001011))
  (assert-equal "一億千十九" (jp-str :normal 100001019))
  (assert-equal "一億千二十" (jp-str :normal 100001020))
  (assert-equal "一億千二十一" (jp-str :normal 100001021))
  (assert-equal "一億千二十九" (jp-str :normal 100001029))
  (assert-equal "一億千百" (jp-str :normal 100001100))
  (assert-equal "一億千百一" (jp-str :normal 100001101))
  (assert-equal "一億千百九" (jp-str :normal 100001109))
  (assert-equal "一億千百十" (jp-str :normal 100001110))
  (assert-equal "一億千百十一" (jp-str :normal 100001111))
  (assert-equal "一億千百十九" (jp-str :normal 100001119))
  (assert-equal "一億千百二十" (jp-str :normal 100001120))
  (assert-equal "一億千百二十一" (jp-str :normal 100001121))
  (assert-equal "一億千百二十九" (jp-str :normal 100001129))
  (assert-equal "一億千二百" (jp-str :normal 100001200))
  (assert-equal "一億千二百一" (jp-str :normal 100001201))
  (assert-equal "一億千二百九" (jp-str :normal 100001209))
  (assert-equal "一億千二百十" (jp-str :normal 100001210))
  (assert-equal "一億千二百十一" (jp-str :normal 100001211))
  (assert-equal "一億千二百十九" (jp-str :normal 100001219))
  (assert-equal "一億千二百二十" (jp-str :normal 100001220))
  (assert-equal "一億千二百二十一" (jp-str :normal 100001221))
  (assert-equal "一億千二百二十九" (jp-str :normal 100001229))
  (assert-equal "一億二千" (jp-str :normal 100002000))
  (assert-equal "一億二千一" (jp-str :normal 100002001))
  (assert-equal "一億二千九" (jp-str :normal 100002009))
  (assert-equal "一億二千十" (jp-str :normal 100002010))
  (assert-equal "一億二千十一" (jp-str :normal 100002011))
  (assert-equal "一億二千十九" (jp-str :normal 100002019))
  (assert-equal "一億二千二十" (jp-str :normal 100002020))
  (assert-equal "一億二千二十一" (jp-str :normal 100002021))
  (assert-equal "一億二千二十九" (jp-str :normal 100002029))
  (assert-equal "一億二千百" (jp-str :normal 100002100))
  (assert-equal "一億二千百一" (jp-str :normal 100002101))
  (assert-equal "一億二千百九" (jp-str :normal 100002109))
  (assert-equal "一億二千百十" (jp-str :normal 100002110))
  (assert-equal "一億二千百十一" (jp-str :normal 100002111))
  (assert-equal "一億二千百十九" (jp-str :normal 100002119))
  (assert-equal "一億二千百二十" (jp-str :normal 100002120))
  (assert-equal "一億二千百二十一" (jp-str :normal 100002121))
  (assert-equal "一億二千百二十九" (jp-str :normal 100002129))
  (assert-equal "一億二千二百" (jp-str :normal 100002200))
  (assert-equal "一億二千二百一" (jp-str :normal 100002201))
  (assert-equal "一億二千二百九" (jp-str :normal 100002209))
  (assert-equal "一億二千二百十" (jp-str :normal 100002210))
  (assert-equal "一億二千二百十一" (jp-str :normal 100002211))
  (assert-equal "一億二千二百十九" (jp-str :normal 100002219))
  (assert-equal "一億二千二百二十" (jp-str :normal 100002220))
  (assert-equal "一億二千二百二十一" (jp-str :normal 100002221))
  (assert-equal "一億二千二百二十九" (jp-str :normal 100002229))
  (assert-equal "一億九千九百九十九" (jp-str :normal 100009999))
  ;; 100010000 - 100019999
  (assert-equal "一億一万" (jp-str :normal 100010000))
  (assert-equal "一億一万一" (jp-str :normal 100010001))
  (assert-equal "一億一万九" (jp-str :normal 100010009))
  (assert-equal "一億一万十" (jp-str :normal 100010010))
  (assert-equal "一億一万十一" (jp-str :normal 100010011))
  (assert-equal "一億一万十九" (jp-str :normal 100010019))
  (assert-equal "一億一万二十" (jp-str :normal 100010020))
  (assert-equal "一億一万二十一" (jp-str :normal 100010021))
  (assert-equal "一億一万二十九" (jp-str :normal 100010029))
  (assert-equal "一億一万百" (jp-str :normal 100010100))
  (assert-equal "一億一万百一" (jp-str :normal 100010101))
  (assert-equal "一億一万百九" (jp-str :normal 100010109))
  (assert-equal "一億一万百十" (jp-str :normal 100010110))
  (assert-equal "一億一万百十一" (jp-str :normal 100010111))
  (assert-equal "一億一万百十九" (jp-str :normal 100010119))
  (assert-equal "一億一万百二十" (jp-str :normal 100010120))
  (assert-equal "一億一万百二十一" (jp-str :normal 100010121))
  (assert-equal "一億一万百二十九" (jp-str :normal 100010129))
  (assert-equal "一億一万二百" (jp-str :normal 100010200))
  (assert-equal "一億一万二百一" (jp-str :normal 100010201))
  (assert-equal "一億一万二百九" (jp-str :normal 100010209))
  (assert-equal "一億一万二百十" (jp-str :normal 100010210))
  (assert-equal "一億一万二百十一" (jp-str :normal 100010211))
  (assert-equal "一億一万二百十九" (jp-str :normal 100010219))
  (assert-equal "一億一万二百二十" (jp-str :normal 100010220))
  (assert-equal "一億一万二百二十一" (jp-str :normal 100010221))
  (assert-equal "一億一万二百二十九" (jp-str :normal 100010229))
  (assert-equal "一億一万千" (jp-str :normal 100011000))
  (assert-equal "一億一万千一" (jp-str :normal 100011001))
  (assert-equal "一億一万千九" (jp-str :normal 100011009))
  (assert-equal "一億一万千十" (jp-str :normal 100011010))
  (assert-equal "一億一万千十一" (jp-str :normal 100011011))
  (assert-equal "一億一万千十九" (jp-str :normal 100011019))
  (assert-equal "一億一万千二十" (jp-str :normal 100011020))
  (assert-equal "一億一万千二十一" (jp-str :normal 100011021))
  (assert-equal "一億一万千二十九" (jp-str :normal 100011029))
  (assert-equal "一億一万千百" (jp-str :normal 100011100))
  (assert-equal "一億一万千百一" (jp-str :normal 100011101))
  (assert-equal "一億一万千百九" (jp-str :normal 100011109))
  (assert-equal "一億一万千百十" (jp-str :normal 100011110))
  (assert-equal "一億一万千百十一" (jp-str :normal 100011111))
  (assert-equal "一億一万千百十九" (jp-str :normal 100011119))
  (assert-equal "一億一万千百二十" (jp-str :normal 100011120))
  (assert-equal "一億一万千百二十一" (jp-str :normal 100011121))
  (assert-equal "一億一万千百二十九" (jp-str :normal 100011129))
  (assert-equal "一億一万千二百" (jp-str :normal 100011200))
  (assert-equal "一億一万千二百一" (jp-str :normal 100011201))
  (assert-equal "一億一万千二百九" (jp-str :normal 100011209))
  (assert-equal "一億一万千二百十" (jp-str :normal 100011210))
  (assert-equal "一億一万千二百十一" (jp-str :normal 100011211))
  (assert-equal "一億一万千二百十九" (jp-str :normal 100011219))
  (assert-equal "一億一万千二百二十" (jp-str :normal 100011220))
  (assert-equal "一億一万千二百二十一" (jp-str :normal 100011221))
  (assert-equal "一億一万千二百二十九" (jp-str :normal 100011229))
  (assert-equal "一億一万二千" (jp-str :normal 100012000))
  (assert-equal "一億一万二千一" (jp-str :normal 100012001))
  (assert-equal "一億一万二千九" (jp-str :normal 100012009))
  (assert-equal "一億一万二千十" (jp-str :normal 100012010))
  (assert-equal "一億一万二千十一" (jp-str :normal 100012011))
  (assert-equal "一億一万二千十九" (jp-str :normal 100012019))
  (assert-equal "一億一万二千二十" (jp-str :normal 100012020))
  (assert-equal "一億一万二千二十一" (jp-str :normal 100012021))
  (assert-equal "一億一万二千二十九" (jp-str :normal 100012029))
  (assert-equal "一億一万二千百" (jp-str :normal 100012100))
  (assert-equal "一億一万二千百一" (jp-str :normal 100012101))
  (assert-equal "一億一万二千百九" (jp-str :normal 100012109))
  (assert-equal "一億一万二千百十" (jp-str :normal 100012110))
  (assert-equal "一億一万二千百十一" (jp-str :normal 100012111))
  (assert-equal "一億一万二千百十九" (jp-str :normal 100012119))
  (assert-equal "一億一万二千百二十" (jp-str :normal 100012120))
  (assert-equal "一億一万二千百二十一" (jp-str :normal 100012121))
  (assert-equal "一億一万二千百二十九" (jp-str :normal 100012129))
  (assert-equal "一億一万二千二百" (jp-str :normal 100012200))
  (assert-equal "一億一万二千二百一" (jp-str :normal 100012201))
  (assert-equal "一億一万二千二百九" (jp-str :normal 100012209))
  (assert-equal "一億一万二千二百十" (jp-str :normal 100012210))
  (assert-equal "一億一万二千二百十一" (jp-str :normal 100012211))
  (assert-equal "一億一万二千二百十九" (jp-str :normal 100012219))
  (assert-equal "一億一万二千二百二十" (jp-str :normal 100012220))
  (assert-equal "一億一万二千二百二十一" (jp-str :normal 100012221))
  (assert-equal "一億一万二千二百二十九" (jp-str :normal 100012229))
  (assert-equal "一億一万九千九百九十九" (jp-str :normal 100019999))
  ;; 100020000 - 199990000
  (assert-equal "一億二万" (jp-str :normal 100020000))
  (assert-equal "一億九万" (jp-str :normal 100090000))
  (assert-equal "一億十万" (jp-str :normal 100100000))
  (assert-equal "一億十一万" (jp-str :normal 100110000))
  (assert-equal "一億十九万" (jp-str :normal 100190000))
  (assert-equal "一億二十万" (jp-str :normal 100200000))
  (assert-equal "一億二十一万" (jp-str :normal 100210000))
  (assert-equal "一億二十九万" (jp-str :normal 100290000))
  (assert-equal "一億百万" (jp-str :normal 101000000))
  (assert-equal "一億百一万" (jp-str :normal 101010000))
  (assert-equal "一億百九万" (jp-str :normal 101090000))
  (assert-equal "一億百十万" (jp-str :normal 101100000))
  (assert-equal "一億百十一万" (jp-str :normal 101110000))
  (assert-equal "一億百十九万" (jp-str :normal 101190000))
  (assert-equal "一億百二十万" (jp-str :normal 101200000))
  (assert-equal "一億百二十一万" (jp-str :normal 101210000))
  (assert-equal "一億百二十九万" (jp-str :normal 101290000))
  (assert-equal "一億二百万" (jp-str :normal 102000000))
  (assert-equal "一億二百一万" (jp-str :normal 102010000))
  (assert-equal "一億二百九万" (jp-str :normal 102090000))
  (assert-equal "一億二百十万" (jp-str :normal 102100000))
  (assert-equal "一億二百十一万" (jp-str :normal 102110000))
  (assert-equal "一億二百十九万" (jp-str :normal 102190000))
  (assert-equal "一億二百二十万" (jp-str :normal 102200000))
  (assert-equal "一億二百二十一万" (jp-str :normal 102210000))
  (assert-equal "一億二百二十九万" (jp-str :normal 102290000))
  (assert-equal "一億一千万" (jp-str :normal 110000000))
  (assert-equal "一億千一万" (jp-str :normal 110010000))
  (assert-equal "一億千九万" (jp-str :normal 110090000))
  (assert-equal "一億千十万" (jp-str :normal 110100000))
  (assert-equal "一億千十一万" (jp-str :normal 110110000))
  (assert-equal "一億千十九万" (jp-str :normal 110190000))
  (assert-equal "一億千二十万" (jp-str :normal 110200000))
  (assert-equal "一億千二十一万" (jp-str :normal 110210000))
  (assert-equal "一億千二十九万" (jp-str :normal 110290000))
  (assert-equal "一億千百万" (jp-str :normal 111000000))
  (assert-equal "一億千百一万" (jp-str :normal 111010000))
  (assert-equal "一億千百九万" (jp-str :normal 111090000))
  (assert-equal "一億千百十万" (jp-str :normal 111100000))
  (assert-equal "一億千百十一万" (jp-str :normal 111110000))
  (assert-equal "一億千百十九万" (jp-str :normal 111190000))
  (assert-equal "一億千百二十万" (jp-str :normal 111200000))
  (assert-equal "一億千百二十一万" (jp-str :normal 111210000))
  (assert-equal "一億千百二十九万" (jp-str :normal 111290000))
  (assert-equal "一億千二百万" (jp-str :normal 112000000))
  (assert-equal "一億千二百一万" (jp-str :normal 112010000))
  (assert-equal "一億千二百九万" (jp-str :normal 112090000))
  (assert-equal "一億千二百十万" (jp-str :normal 112100000))
  (assert-equal "一億千二百十一万" (jp-str :normal 112110000))
  (assert-equal "一億千二百十九万" (jp-str :normal 112190000))
  (assert-equal "一億千二百二十万" (jp-str :normal 112200000))
  (assert-equal "一億千二百二十一万" (jp-str :normal 112210000))
  (assert-equal "一億千二百二十九万" (jp-str :normal 112290000))
  (assert-equal "一億二千万" (jp-str :normal 120000000))
  (assert-equal "一億二千一万" (jp-str :normal 120010000))
  (assert-equal "一億二千九万" (jp-str :normal 120090000))
  (assert-equal "一億二千十万" (jp-str :normal 120100000))
  (assert-equal "一億二千十一万" (jp-str :normal 120110000))
  (assert-equal "一億二千十九万" (jp-str :normal 120190000))
  (assert-equal "一億二千二十万" (jp-str :normal 120200000))
  (assert-equal "一億二千二十一万" (jp-str :normal 120210000))
  (assert-equal "一億二千二十九万" (jp-str :normal 120290000))
  (assert-equal "一億二千百万" (jp-str :normal 121000000))
  (assert-equal "一億二千百一万" (jp-str :normal 121010000))
  (assert-equal "一億二千百九万" (jp-str :normal 121090000))
  (assert-equal "一億二千百十万" (jp-str :normal 121100000))
  (assert-equal "一億二千百十一万" (jp-str :normal 121110000))
  (assert-equal "一億二千百十九万" (jp-str :normal 121190000))
  (assert-equal "一億二千百二十万" (jp-str :normal 121200000))
  (assert-equal "一億二千百二十一万" (jp-str :normal 121210000))
  (assert-equal "一億二千百二十九万" (jp-str :normal 121290000))
  (assert-equal "一億二千二百万" (jp-str :normal 122000000))
  (assert-equal "一億二千二百一万" (jp-str :normal 122010000))
  (assert-equal "一億二千二百九万" (jp-str :normal 122090000))
  (assert-equal "一億二千二百十万" (jp-str :normal 122100000))
  (assert-equal "一億二千二百十一万" (jp-str :normal 122110000))
  (assert-equal "一億二千二百十九万" (jp-str :normal 122190000))
  (assert-equal "一億二千二百二十万" (jp-str :normal 122200000))
  (assert-equal "一億二千二百二十一万" (jp-str :normal 122210000))
  (assert-equal "一億二千二百二十九万" (jp-str :normal 122290000))
  (assert-equal "一億九千九百九十九万" (jp-str :normal 199990000))

  ;; more big nums
  (let ((num 12300001001))
    (assert-equal "百二十三億千一" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三兆千一万" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三京千一億" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三垓千一兆" (jp-str :normal num))
    (mulf num 10000)
    (when (<= #x25771 char-code-limit)	; contains U+25771 (10^24)
      (assert-equal "百二十三𥝱千一京" (jp-str :normal num)))
    (mulf num 10000)
    (assert-equal "百二十三穣千一垓" (jp-str :normal num))
    (mulf num 10000)
    (when (<= #x25771 char-code-limit)	; contains U+25771 (10^24)
      (assert-equal "百二十三溝千一𥝱" (jp-str :normal num)))
    (mulf num 10000)
    (assert-equal "百二十三澗千一穣" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三正千一溝" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三載千一澗" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三極千一正" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三恒河沙千一載" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三阿僧祇千一極" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三那由他千一恒河沙" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三不可思議千一阿僧祇" (jp-str :normal num))
    (mulf num 10000)
    (assert-equal "百二十三無量大数千一那由他" (jp-str :normal num)))
  ;; 
  t)

(defun test-jp-normal-integer-minus ()
  (assert-equal "マイナス一" (jp-str :normal -1))
  (assert-equal "マイナス二" (jp-str :normal -2))
  (assert-equal "マイナス三" (jp-str :normal -3))
  (assert-equal "マイナス四" (jp-str :normal -4))
  (assert-equal "マイナス五" (jp-str :normal -5))
  (assert-equal "マイナス六" (jp-str :normal -6))
  (assert-equal "マイナス七" (jp-str :normal -7))
  (assert-equal "マイナス八" (jp-str :normal -8))
  (assert-equal "マイナス九" (jp-str :normal -9))
  (assert-equal "マイナス十" (jp-str :normal -10))
  (assert-equal "マイナス二十" (jp-str :normal -20))
  (assert-equal "マイナス百" (jp-str :normal -100))
  (assert-equal "マイナス五百" (jp-str :normal -500))
  (assert-equal "マイナス千" (jp-str :normal -1000))
  (assert-equal "マイナス一万" (jp-str :normal -10000))
  (assert-equal "マイナス一万二千三百四十五" (jp-str :normal -12345))
  ;; 
  t)
  
(defun test-jp-normal-rational ()
  (assert-equal "二分の一" (jp-str :normal 1/2))
  (assert-equal "十分の一" (jp-str :normal 1/10))
  (assert-equal "二十分の一" (jp-str :normal 1/20))
  (assert-equal "百分の一" (jp-str :normal 1/100))
  (assert-equal "百十分の一" (jp-str :normal 1/110))
  (assert-equal "百十一分の一" (jp-str :normal 1/111))
  (assert-equal "百二十分の一" (jp-str :normal 1/120))
  (assert-equal "百二十一分の一" (jp-str :normal 1/121))
  (assert-equal "二百分の一" (jp-str :normal 1/200))
  (assert-equal "二百十分の一" (jp-str :normal 1/210))
  (assert-equal "二百十一分の一" (jp-str :normal 1/211))
  (assert-equal "二百二十分の一" (jp-str :normal 1/220))
  (assert-equal "二百二十一分の一" (jp-str :normal 1/221))
  (assert-equal "千分の一" (jp-str :normal 1/1000))
  (assert-equal "千十分の一" (jp-str :normal 1/1010))
  (assert-equal "千十一分の一" (jp-str :normal 1/1011))
  (assert-equal "千二十分の一" (jp-str :normal 1/1020))
  (assert-equal "千二十一分の一" (jp-str :normal 1/1021))
  (assert-equal "千百分の一" (jp-str :normal 1/1100))
  (assert-equal "千百十分の一" (jp-str :normal 1/1110))
  (assert-equal "千百十一分の一" (jp-str :normal 1/1111))
  (assert-equal "千百二十分の一" (jp-str :normal 1/1120))
  (assert-equal "千百二十一分の一" (jp-str :normal 1/1121))
  (assert-equal "二千二百一分の一" (jp-str :normal 1/2201))
  (assert-equal "一万分の一" (jp-str :normal 1/10000))
  (assert-equal "一万千百十一分の一" (jp-str :normal 1/11111))
  (assert-equal "二万二千二百二十二分の一" (jp-str :normal 1/22222))
  (assert-equal "一億分の一" (jp-str :normal 1/100000000))

  (assert-equal "一万九千九百九十七分の一" (jp-str :normal 1/19997)) ; 19997 is a prime.
  (assert-equal "一万九千九百九十七分の二" (jp-str :normal 2/19997))
  (assert-equal "一万九千九百九十七分の十" (jp-str :normal 10/19997))
  (assert-equal "一万九千九百九十七分の十一" (jp-str :normal 11/19997))
  (assert-equal "一万九千九百九十七分の二十一" (jp-str :normal 21/19997))
  (assert-equal "一万九千九百九十七分の九十九" (jp-str :normal 99/19997))
  (assert-equal "一万九千九百九十七分の百" (jp-str :normal 100/19997))
  (assert-equal "一万九千九百九十七分の百一" (jp-str :normal 101/19997))
  (assert-equal "一万九千九百九十七分の百十一" (jp-str :normal 111/19997))
  (assert-equal "一万九千九百九十七分の二百十一" (jp-str :normal 211/19997))
  (assert-equal "一万九千九百九十七分の千一" (jp-str :normal 1001/19997))
  (assert-equal "一万九千九百九十七分の千百十一" (jp-str :normal 1111/19997))
  (assert-equal "一万九千九百九十七分の二千二百二十二" (jp-str :normal 2222/19997))
  (assert-equal "一万九千九百九十七分の一万" (jp-str :normal 10000/19997))
  (assert-equal "一万九千九百九十七分の一万一" (jp-str :normal 10001/19997))
  (assert-equal "一万九千九百九十七分の一万千百十" (jp-str :normal 11110/19997))
  (assert-equal "一万九千九百九十七分の一万五千二" (jp-str :normal 15002/19997))
  (assert-equal "一万九千九百九十七分の一万九千九百九十六" (jp-str :normal 19996/19997))

  (assert-equal "マイナス二分の一" (jp-str :normal -1/2))
  ;; 
  t)
  
(defun test-jp-normal-float ()
  ;; int
  (assert-equal "〇" (jp-str :normal 0.0))
  (assert-equal "一" (jp-str :normal 1.0))
  (assert-equal "十" (jp-str :normal 10.0))
  ;; 0.1-0.9
  (assert-equal "一分" (jp-str :normal 0.1))
  (assert-equal "二分" (jp-str :normal 0.2))
  (assert-equal "三分" (jp-str :normal 0.3))
  (assert-equal "四分" (jp-str :normal 0.4))
  (assert-equal "五分" (jp-str :normal 0.5))
  (assert-equal "六分" (jp-str :normal 0.6))
  (assert-equal "七分" (jp-str :normal 0.7))
  (assert-equal "八分" (jp-str :normal 0.8))
  (assert-equal "九分" (jp-str :normal 0.9))
  ;; 0.10-0.30
  (assert-equal "一分" (jp-str :normal 0.10))
  (assert-equal "一分一厘" (jp-str :normal 0.11))
  (assert-equal "一分二厘" (jp-str :normal 0.12))
  (assert-equal "一分三厘" (jp-str :normal 0.13))
  (assert-equal "一分四厘" (jp-str :normal 0.14))
  (assert-equal "一分五厘" (jp-str :normal 0.15))
  (assert-equal "一分六厘" (jp-str :normal 0.16))
  (assert-equal "一分七厘" (jp-str :normal 0.17))
  (assert-equal "一分八厘" (jp-str :normal 0.18))
  (assert-equal "一分九厘" (jp-str :normal 0.19))
  (assert-equal "二分" (jp-str :normal 0.20))
  (assert-equal "二分一厘" (jp-str :normal 0.21))
  (assert-equal "二分二厘" (jp-str :normal 0.22))
  (assert-equal "二分三厘" (jp-str :normal 0.23))
  (assert-equal "二分四厘" (jp-str :normal 0.24))
  (assert-equal "二分五厘" (jp-str :normal 0.25))
  (assert-equal "二分六厘" (jp-str :normal 0.26))
  (assert-equal "二分七厘" (jp-str :normal 0.27))
  (assert-equal "二分八厘" (jp-str :normal 0.28))
  (assert-equal "二分九厘" (jp-str :normal 0.29))
  (assert-equal "三分" (jp-str :normal 0.30))
  ;; small nums
  (assert-equal "十・三分四厘" (jp-str :normal 10.34))
  (assert-equal "一・三厘四毛" (jp-str :normal 1.034))
  (assert-equal "一分三毛四糸" (jp-str :normal 0.1034))
  (assert-equal "一厘三糸四忽" (jp-str :normal 0.01034))
  (assert-equal "一毛三忽四微" (jp-str :normal 0.001034))
  (assert-equal "一糸三微四繊" (jp-str :normal 0.0001034))
  (assert-equal "一忽三繊四沙" (jp-str :normal 0.00001034))
  (assert-equal "一微三沙四塵" (jp-str :normal 0.000001034))
  (assert-equal "一繊三塵四埃" (jp-str :normal 0.0000001034))
  (assert-equal "一沙三埃四渺" (jp-str :normal 0.00000001034))
  (assert-equal "一塵三渺四漠" (jp-str :normal 0.000000001034))
  (assert-equal "一埃三漠四模糊" (jp-str :normal 0.0000000001034))
  (assert-equal "一渺三模糊四逡巡" (jp-str :normal 0.00000000001034))
  (assert-equal "一漠三逡巡四須臾" (jp-str :normal 0.000000000001034))
  (assert-equal "一模糊三須臾四瞬息" (jp-str :normal 0.0000000000001034))
  (assert-equal "一逡巡三瞬息四弾指" (jp-str :normal 0.00000000000001034))
  (assert-equal "一須臾三弾指四刹那" (jp-str :normal 0.000000000000001034))
  (assert-equal "一瞬息三刹那四六徳" (jp-str :normal 0.0000000000000001034))
  (assert-equal "一弾指三六徳四虚空" (jp-str :normal 0.00000000000000001034))
  (assert-equal "一刹那三虚空四清浄" (jp-str :normal 0.000000000000000001034))
  ;; minus
  (assert-equal "マイナス一分" (jp-str :normal -0.1))
  (assert-equal "マイナス二分" (jp-str :normal -0.2))
  (assert-equal "マイナス一分一厘" (jp-str :normal -0.11))
  (assert-equal "マイナス二厘" (jp-str :normal -0.02))
  (assert-equal "マイナス一・一分" (jp-str :normal -1.1))
  (assert-equal "マイナス一・一厘" (jp-str :normal -1.01))
  ;;
  t)

(defun test-jp-normal-fallback ()
  ;; too big num
  (assert-equal "一無量大数" (jp-str :normal (expt 10 68)))
  (assert-equal "一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
		(jp-str :normal (expt 10 72)))
  (assert-equal "マイナス一無量大数" (jp-str :normal (- (expt 10 68))))
  (assert-equal "−一〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇"
		(jp-str :normal (- (expt 10 72))))
  ;; too small num
  (assert-equal "一清浄" (jp-str :normal (float (expt 10 -21))))
  (assert-equal "〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
		(jp-str :normal (float (expt 10 -22))))
  (assert-equal "マイナス一清浄" (jp-str :normal (- (float (expt 10 -21)))))
  (assert-equal "−〇・〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇一"
		(jp-str :normal (- (float (expt 10 -22)))))
  ;; complex
  (assert-equal (format nil "~A" #c(1 1))
		(jp-str :normal #c(1 1)))
  ;;
  t)

(defun test-jp-normal-parameters ()
  ;; [Integer]
  ;; digits-after-dot -- ignored
  (assert-equal "一" (jp-str :normal 1 :digits-after-dot nil))
  (assert-equal "一" (jp-str :normal 1 :digits-after-dot 0))
  (assert-equal "一" (jp-str :normal 1 :digits-after-dot 1))
  (assert-equal "一" (jp-str :normal 1 :digits-after-dot -1))
  ;; scale
  (assert-equal "一" (jp-str :normal 1 :scale nil))
  (assert-equal "一" (jp-str :normal 1 :scale 0))
  (assert-equal "十" (jp-str :normal 1 :scale 1))
  (assert-equal "十分の一" (jp-str :normal 1 :scale -1))
  ;; radix-point
  (assert-equal "一" (jp-str :normal 1 :radix-point nil))
  (assert-equal "一a" (jp-str :normal 1 :radix-point #\a))
  (assert-equal "一abc" (jp-str :normal 1 :radix-point "abc"))

  ;; [Rational]
  ;; digits-after-dot -- ignored
  (assert-equal "二分の一" (jp-str :normal 1/2 :digits-after-dot nil))
  (assert-equal "二分の一" (jp-str :normal 1/2 :digits-after-dot 0))
  (assert-equal "二分の一" (jp-str :normal 1/2 :digits-after-dot 1))
  (assert-equal "二分の一" (jp-str :normal 1/2 :digits-after-dot -1))
  ;; scale
  (assert-equal "二分の一" (jp-str :normal 1/2 :scale nil))
  (assert-equal "二分の一" (jp-str :normal 1/2 :scale 0))
  (assert-equal "五" (jp-str :normal 1/2 :scale 1))
  (assert-equal "二十分の一" (jp-str :normal 1/2 :scale -1))
  ;; radix-point
  (assert-equal "二分の一" (jp-str :normal 1/2 :radix-point nil))
  (assert-equal "二分の一a" (jp-str :normal 1/2 :radix-point #\a))
  (assert-equal "二分の一abc" (jp-str :normal 1/2 :radix-point "abc"))

  ;; [Float]
  ;; digits-after-dot
  (assert-equal "十二・三分四厘" (jp-str :normal 12.34 :digits-after-dot nil))
  (assert-equal "十二" (jp-str :normal 12.34 :digits-after-dot 0))
  (assert-equal "十二・三分" (jp-str :normal 12.34 :digits-after-dot 1))
  (assert-equal "十二・三分四厘" (jp-str :normal 12.34 :digits-after-dot 2))
  (assert-equal "十二・三分四厘" (jp-str :normal 12.34 :digits-after-dot 3))
  (assert-equal "十" (jp-str :normal 12.34 :digits-after-dot -1))
  (assert-equal "〇" (jp-str :normal 12.34 :digits-after-dot -2))
  ;; scale
  (assert-equal "十二・三分四厘" (jp-str :normal 12.34 :scale nil))
  (assert-equal "十二・三分四厘" (jp-str :normal 12.34 :scale 0))
  (assert-equal "百二十三・四分" (jp-str :normal 12.34 :scale 1))
  (assert-equal "千二百三十四" (jp-str :normal 12.34 :scale 2))
  (assert-equal "一・二分三厘四毛" (jp-str :normal 12.34 :scale -1))
  (assert-equal "一分二厘三毛四糸" (jp-str :normal 12.34 :scale -2))
  ;; radix-point
  (assert-equal "十二・三分四厘" (jp-str :normal 12.34 :radix-point nil))
  (assert-equal "十二a三分四厘" (jp-str :normal 12.34 :radix-point #\a))
  (assert-equal "十二abc三分四厘" (jp-str :normal 12.34 :radix-point "abc"))
  (assert-equal "千二百三十四abc" (jp-str :normal 12.34 :radix-point "abc" :scale 2))
  (assert-equal "〇abc一分二厘三毛四糸" (jp-str :normal 12.34 :radix-point "abc" :scale -2))
  ;; 
  t)

(defun test-jp-normal ()
  (and (test-jp-normal-integer-4digits)
       (test-jp-normal-integer-bignums)
       (test-jp-normal-integer-minus)
       (test-jp-normal-rational)
       (test-jp-normal-float)
       (test-jp-normal-fallback)
       (test-jp-normal-parameters)
       t))
