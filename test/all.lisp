;;; -*- coding: utf-8; -*-

(in-package :jp-numeral.test)

(defun test-jp-normal-integer-4digits ()
  (flet ((jp-str (n)
	   (format nil "~/jp-numeral:jp/" n)))
    ;; 0
    (assert (equal "〇" (jp-str 0)))
    ;; 1-9
    (assert (equal "一" (jp-str 1)))
    (assert (equal "二" (jp-str 2)))
    (assert (equal "三" (jp-str 3)))
    (assert (equal "四" (jp-str 4)))
    (assert (equal "五" (jp-str 5)))
    (assert (equal "六" (jp-str 6)))
    (assert (equal "七" (jp-str 7)))
    (assert (equal "八" (jp-str 8)))
    (assert (equal "九" (jp-str 9)))
    ;; 10-19
    (assert (equal "十" (jp-str 10)))
    (assert (equal "十一" (jp-str 11)))
    (assert (equal "十二" (jp-str 12)))
    (assert (equal "十三" (jp-str 13)))
    (assert (equal "十四" (jp-str 14)))
    (assert (equal "十五" (jp-str 15)))
    (assert (equal "十六" (jp-str 16)))
    (assert (equal "十七" (jp-str 17)))
    (assert (equal "十八" (jp-str 18)))
    (assert (equal "十九" (jp-str 19)))
    ;; 20-99
    (assert (equal "二十" (jp-str 20)))
    (assert (equal "二十一" (jp-str 21)))
    (assert (equal "二十九" (jp-str 29)))
    (assert (equal "三十" (jp-str 30)))
    (assert (equal "三十一" (jp-str 31)))
    (assert (equal "三十九" (jp-str 39)))
    (assert (equal "四十" (jp-str 40)))
    (assert (equal "四十一" (jp-str 41)))
    (assert (equal "四十九" (jp-str 49)))
    (assert (equal "五十" (jp-str 50)))
    (assert (equal "五十一" (jp-str 51)))
    (assert (equal "五十九" (jp-str 59)))
    (assert (equal "六十" (jp-str 60)))
    (assert (equal "六十一" (jp-str 61)))
    (assert (equal "六十九" (jp-str 69)))
    (assert (equal "七十" (jp-str 70)))
    (assert (equal "七十一" (jp-str 71)))
    (assert (equal "七十九" (jp-str 79)))
    (assert (equal "八十" (jp-str 80)))
    (assert (equal "八十一" (jp-str 81)))
    (assert (equal "八十九" (jp-str 89)))
    (assert (equal "九十" (jp-str 90)))
    (assert (equal "九十一" (jp-str 91)))
    (assert (equal "九十九" (jp-str 99)))
    ;; 100
    (assert (equal "百" (jp-str 100)))
    ;; 101-109
    (assert (equal "百一" (jp-str 101)))
    (assert (equal "百二" (jp-str 102)))
    (assert (equal "百三" (jp-str 103)))
    (assert (equal "百四" (jp-str 104)))
    (assert (equal "百五" (jp-str 105)))
    (assert (equal "百六" (jp-str 106)))
    (assert (equal "百七" (jp-str 107)))
    (assert (equal "百八" (jp-str 108)))
    (assert (equal "百九" (jp-str 109)))
    ;; 110-119
    (assert (equal "百十" (jp-str 110)))
    (assert (equal "百十一" (jp-str 111)))
    (assert (equal "百十二" (jp-str 112)))
    (assert (equal "百十三" (jp-str 113)))
    (assert (equal "百十四" (jp-str 114)))
    (assert (equal "百十五" (jp-str 115)))
    (assert (equal "百十六" (jp-str 116)))
    (assert (equal "百十七" (jp-str 117)))
    (assert (equal "百十八" (jp-str 118)))
    (assert (equal "百十九" (jp-str 119)))
    ;; 120-199
    (assert (equal "百二十" (jp-str 120)))
    (assert (equal "百二十一" (jp-str 121)))
    (assert (equal "百二十九" (jp-str 129)))
    (assert (equal "百三十" (jp-str 130)))
    (assert (equal "百三十一" (jp-str 131)))
    (assert (equal "百三十九" (jp-str 139)))
    (assert (equal "百四十" (jp-str 140)))
    (assert (equal "百四十一" (jp-str 141)))
    (assert (equal "百四十九" (jp-str 149)))
    (assert (equal "百五十" (jp-str 150)))
    (assert (equal "百五十一" (jp-str 151)))
    (assert (equal "百五十九" (jp-str 159)))
    (assert (equal "百六十" (jp-str 160)))
    (assert (equal "百六十一" (jp-str 161)))
    (assert (equal "百六十九" (jp-str 169)))
    (assert (equal "百七十" (jp-str 170)))
    (assert (equal "百七十一" (jp-str 171)))
    (assert (equal "百七十九" (jp-str 179)))
    (assert (equal "百八十" (jp-str 180)))
    (assert (equal "百八十一" (jp-str 181)))
    (assert (equal "百八十九" (jp-str 189)))
    (assert (equal "百九十" (jp-str 190)))
    (assert (equal "百九十一" (jp-str 191)))
    (assert (equal "百九十九" (jp-str 199)))
    ;; 200-999
    (assert (equal "二百" (jp-str 200)))
    (assert (equal "二百一" (jp-str 201)))
    (assert (equal "二百九" (jp-str 209)))
    (assert (equal "二百十" (jp-str 210)))
    (assert (equal "二百十一" (jp-str 211)))
    (assert (equal "二百十九" (jp-str 219)))
    (assert (equal "二百二十" (jp-str 220)))
    (assert (equal "二百二十一" (jp-str 221)))
    (assert (equal "二百九十九" (jp-str 299)))
    (assert (equal "三百" (jp-str 300)))
    (assert (equal "三百一" (jp-str 301)))
    (assert (equal "三百九" (jp-str 309)))
    (assert (equal "三百十" (jp-str 310)))
    (assert (equal "三百十一" (jp-str 311)))
    (assert (equal "三百十九" (jp-str 319)))
    (assert (equal "三百二十" (jp-str 320)))
    (assert (equal "三百二十一" (jp-str 321)))
    (assert (equal "三百九十九" (jp-str 399)))
    (assert (equal "四百" (jp-str 400)))
    (assert (equal "四百一" (jp-str 401)))
    (assert (equal "四百九" (jp-str 409)))
    (assert (equal "四百十" (jp-str 410)))
    (assert (equal "四百十一" (jp-str 411)))
    (assert (equal "四百十九" (jp-str 419)))
    (assert (equal "四百二十" (jp-str 420)))
    (assert (equal "四百二十一" (jp-str 421)))
    (assert (equal "四百九十九" (jp-str 499)))
    (assert (equal "五百" (jp-str 500)))
    (assert (equal "五百一" (jp-str 501)))
    (assert (equal "五百九" (jp-str 509)))
    (assert (equal "五百十" (jp-str 510)))
    (assert (equal "五百十一" (jp-str 511)))
    (assert (equal "五百十九" (jp-str 519)))
    (assert (equal "五百二十" (jp-str 520)))
    (assert (equal "五百二十一" (jp-str 521)))
    (assert (equal "五百九十九" (jp-str 599)))
    (assert (equal "六百" (jp-str 600)))
    (assert (equal "六百一" (jp-str 601)))
    (assert (equal "六百九" (jp-str 609)))
    (assert (equal "六百十" (jp-str 610)))
    (assert (equal "六百十一" (jp-str 611)))
    (assert (equal "六百十九" (jp-str 619)))
    (assert (equal "六百二十" (jp-str 620)))
    (assert (equal "六百二十一" (jp-str 621)))
    (assert (equal "六百九十九" (jp-str 699)))
    (assert (equal "七百" (jp-str 700)))
    (assert (equal "七百一" (jp-str 701)))
    (assert (equal "七百九" (jp-str 709)))
    (assert (equal "七百十" (jp-str 710)))
    (assert (equal "七百十一" (jp-str 711)))
    (assert (equal "七百十九" (jp-str 719)))
    (assert (equal "七百二十" (jp-str 720)))
    (assert (equal "七百二十一" (jp-str 721)))
    (assert (equal "七百九十九" (jp-str 799)))
    (assert (equal "八百" (jp-str 800)))
    (assert (equal "八百一" (jp-str 801)))
    (assert (equal "八百九" (jp-str 809)))
    (assert (equal "八百十" (jp-str 810)))
    (assert (equal "八百十一" (jp-str 811)))
    (assert (equal "八百十九" (jp-str 819)))
    (assert (equal "八百二十" (jp-str 820)))
    (assert (equal "八百二十一" (jp-str 821)))
    (assert (equal "八百九十九" (jp-str 899)))
    (assert (equal "九百" (jp-str 900)))
    (assert (equal "九百一" (jp-str 901)))
    (assert (equal "九百九" (jp-str 909)))
    (assert (equal "九百十" (jp-str 910)))
    (assert (equal "九百十一" (jp-str 911)))
    (assert (equal "九百十九" (jp-str 919)))
    (assert (equal "九百二十" (jp-str 920)))
    (assert (equal "九百二十一" (jp-str 921)))
    (assert (equal "九百九十九" (jp-str 999)))
    ;; 1000 - 1099
    (assert (equal "千" (jp-str 1000)))
    (assert (equal "千一" (jp-str 1001)))
    (assert (equal "千二" (jp-str 1002)))
    (assert (equal "千九" (jp-str 1009)))
    (assert (equal "千十" (jp-str 1010)))
    (assert (equal "千十一" (jp-str 1011)))
    (assert (equal "千十九" (jp-str 1019)))
    (assert (equal "千二十" (jp-str 1020)))
    (assert (equal "千二十一" (jp-str 1021)))
    (assert (equal "千二十九" (jp-str 1029)))
    (assert (equal "千三十" (jp-str 1030)))
    (assert (equal "千九十九" (jp-str 1099)))
    ;; 1100 - 9999
    (assert (equal "千百" (jp-str 1100)))
    (assert (equal "千百一" (jp-str 1101)))
    (assert (equal "千百九" (jp-str 1109)))
    (assert (equal "千百十" (jp-str 1110)))
    (assert (equal "千百十一" (jp-str 1111)))
    (assert (equal "千百十九" (jp-str 1119)))
    (assert (equal "千百二十" (jp-str 1120)))
    (assert (equal "千百二十一" (jp-str 1121)))
    (assert (equal "千百二十九" (jp-str 1129)))
    (assert (equal "千百九十九" (jp-str 1199)))
    (assert (equal "千二百" (jp-str 1200)))
    (assert (equal "千二百一" (jp-str 1201)))
    (assert (equal "千二百九" (jp-str 1209)))
    (assert (equal "千二百十" (jp-str 1210)))
    (assert (equal "千二百十一" (jp-str 1211)))
    (assert (equal "千二百十九" (jp-str 1219)))
    (assert (equal "千二百二十" (jp-str 1220)))
    (assert (equal "千二百二十一" (jp-str 1221)))
    (assert (equal "千二百二十九" (jp-str 1229)))
    (assert (equal "千二百九十九" (jp-str 1299)))
    (assert (equal "千九百" (jp-str 1900)))
    (assert (equal "千九百一" (jp-str 1901)))
    (assert (equal "千九百九" (jp-str 1909)))
    (assert (equal "千九百十" (jp-str 1910)))
    (assert (equal "千九百十一" (jp-str 1911)))
    (assert (equal "千九百十九" (jp-str 1919)))
    (assert (equal "千九百二十" (jp-str 1920)))
    (assert (equal "千九百二十一" (jp-str 1921)))
    (assert (equal "千九百二十九" (jp-str 1929)))
    (assert (equal "千九百九十九" (jp-str 1999)))
    ;; 2000 - 9999
    (assert (equal "二千" (jp-str 2000)))
    (assert (equal "二千一" (jp-str 2001)))
    (assert (equal "二千十" (jp-str 2010)))
    (assert (equal "二千十一" (jp-str 2011)))
    (assert (equal "二千二十" (jp-str 2020)))
    (assert (equal "二千二十一" (jp-str 2021)))
    (assert (equal "二千百" (jp-str 2100)))
    (assert (equal "二千百一" (jp-str 2101)))
    (assert (equal "二千百十" (jp-str 2110)))
    (assert (equal "二千百十一" (jp-str 2111)))
    (assert (equal "二千百二十" (jp-str 2120)))
    (assert (equal "二千百二十一" (jp-str 2121)))
    (assert (equal "二千二百" (jp-str 2200)))
    (assert (equal "二千二百一" (jp-str 2201)))
    (assert (equal "二千二百十" (jp-str 2210)))
    (assert (equal "二千二百十一" (jp-str 2211)))
    (assert (equal "二千二百二十" (jp-str 2220)))
    (assert (equal "二千二百二十一" (jp-str 2221)))
    (assert (equal "三千" (jp-str 3000)))
    (assert (equal "三千一" (jp-str 3001)))
    (assert (equal "三千十" (jp-str 3010)))
    (assert (equal "三千十一" (jp-str 3011)))
    (assert (equal "三千二十" (jp-str 3020)))
    (assert (equal "三千二十一" (jp-str 3021)))
    (assert (equal "三千百" (jp-str 3100)))
    (assert (equal "三千百一" (jp-str 3101)))
    (assert (equal "三千百十" (jp-str 3110)))
    (assert (equal "三千百十一" (jp-str 3111)))
    (assert (equal "三千百二十" (jp-str 3120)))
    (assert (equal "三千百二十一" (jp-str 3121)))
    (assert (equal "三千二百" (jp-str 3200)))
    (assert (equal "三千二百一" (jp-str 3201)))
    (assert (equal "三千二百十" (jp-str 3210)))
    (assert (equal "三千二百十一" (jp-str 3211)))
    (assert (equal "三千二百二十" (jp-str 3220)))
    (assert (equal "三千二百二十一" (jp-str 3221)))
    (assert (equal "四千" (jp-str 4000)))
    (assert (equal "四千一" (jp-str 4001)))
    (assert (equal "四千十" (jp-str 4010)))
    (assert (equal "四千十一" (jp-str 4011)))
    (assert (equal "四千二十" (jp-str 4020)))
    (assert (equal "四千二十一" (jp-str 4021)))
    (assert (equal "四千百" (jp-str 4100)))
    (assert (equal "四千百一" (jp-str 4101)))
    (assert (equal "四千百十" (jp-str 4110)))
    (assert (equal "四千百十一" (jp-str 4111)))
    (assert (equal "四千百二十" (jp-str 4120)))
    (assert (equal "四千百二十一" (jp-str 4121)))
    (assert (equal "四千二百" (jp-str 4200)))
    (assert (equal "四千二百一" (jp-str 4201)))
    (assert (equal "四千二百十" (jp-str 4210)))
    (assert (equal "四千二百十一" (jp-str 4211)))
    (assert (equal "四千二百二十" (jp-str 4220)))
    (assert (equal "四千二百二十一" (jp-str 4221)))
    (assert (equal "五千" (jp-str 5000)))
    (assert (equal "五千一" (jp-str 5001)))
    (assert (equal "五千十" (jp-str 5010)))
    (assert (equal "五千十一" (jp-str 5011)))
    (assert (equal "五千二十" (jp-str 5020)))
    (assert (equal "五千二十一" (jp-str 5021)))
    (assert (equal "五千百" (jp-str 5100)))
    (assert (equal "五千百一" (jp-str 5101)))
    (assert (equal "五千百十" (jp-str 5110)))
    (assert (equal "五千百十一" (jp-str 5111)))
    (assert (equal "五千百二十" (jp-str 5120)))
    (assert (equal "五千百二十一" (jp-str 5121)))
    (assert (equal "五千二百" (jp-str 5200)))
    (assert (equal "五千二百一" (jp-str 5201)))
    (assert (equal "五千二百十" (jp-str 5210)))
    (assert (equal "五千二百十一" (jp-str 5211)))
    (assert (equal "五千二百二十" (jp-str 5220)))
    (assert (equal "五千二百二十一" (jp-str 5221)))
    (assert (equal "六千" (jp-str 6000)))
    (assert (equal "六千一" (jp-str 6001)))
    (assert (equal "六千十" (jp-str 6010)))
    (assert (equal "六千十一" (jp-str 6011)))
    (assert (equal "六千二十" (jp-str 6020)))
    (assert (equal "六千二十一" (jp-str 6021)))
    (assert (equal "六千百" (jp-str 6100)))
    (assert (equal "六千百一" (jp-str 6101)))
    (assert (equal "六千百十" (jp-str 6110)))
    (assert (equal "六千百十一" (jp-str 6111)))
    (assert (equal "六千百二十" (jp-str 6120)))
    (assert (equal "六千百二十一" (jp-str 6121)))
    (assert (equal "六千二百" (jp-str 6200)))
    (assert (equal "六千二百一" (jp-str 6201)))
    (assert (equal "六千二百十" (jp-str 6210)))
    (assert (equal "六千二百十一" (jp-str 6211)))
    (assert (equal "六千二百二十" (jp-str 6220)))
    (assert (equal "六千二百二十一" (jp-str 6221)))
    (assert (equal "七千" (jp-str 7000)))
    (assert (equal "七千一" (jp-str 7001)))
    (assert (equal "七千十" (jp-str 7010)))
    (assert (equal "七千十一" (jp-str 7011)))
    (assert (equal "七千二十" (jp-str 7020)))
    (assert (equal "七千二十一" (jp-str 7021)))
    (assert (equal "七千百" (jp-str 7100)))
    (assert (equal "七千百一" (jp-str 7101)))
    (assert (equal "七千百十" (jp-str 7110)))
    (assert (equal "七千百十一" (jp-str 7111)))
    (assert (equal "七千百二十" (jp-str 7120)))
    (assert (equal "七千百二十一" (jp-str 7121)))
    (assert (equal "七千二百" (jp-str 7200)))
    (assert (equal "七千二百一" (jp-str 7201)))
    (assert (equal "七千二百十" (jp-str 7210)))
    (assert (equal "七千二百十一" (jp-str 7211)))
    (assert (equal "七千二百二十" (jp-str 7220)))
    (assert (equal "七千二百二十一" (jp-str 7221)))
    (assert (equal "八千" (jp-str 8000)))
    (assert (equal "八千一" (jp-str 8001)))
    (assert (equal "八千十" (jp-str 8010)))
    (assert (equal "八千十一" (jp-str 8011)))
    (assert (equal "八千二十" (jp-str 8020)))
    (assert (equal "八千二十一" (jp-str 8021)))
    (assert (equal "八千百" (jp-str 8100)))
    (assert (equal "八千百一" (jp-str 8101)))
    (assert (equal "八千百十" (jp-str 8110)))
    (assert (equal "八千百十一" (jp-str 8111)))
    (assert (equal "八千百二十" (jp-str 8120)))
    (assert (equal "八千百二十一" (jp-str 8121)))
    (assert (equal "八千二百" (jp-str 8200)))
    (assert (equal "八千二百一" (jp-str 8201)))
    (assert (equal "八千二百十" (jp-str 8210)))
    (assert (equal "八千二百十一" (jp-str 8211)))
    (assert (equal "八千二百二十" (jp-str 8220)))
    (assert (equal "八千二百二十一" (jp-str 8221)))
    (assert (equal "九千" (jp-str 9000)))
    (assert (equal "九千一" (jp-str 9001)))
    (assert (equal "九千十" (jp-str 9010)))
    (assert (equal "九千十一" (jp-str 9011)))
    (assert (equal "九千二十" (jp-str 9020)))
    (assert (equal "九千二十一" (jp-str 9021)))
    (assert (equal "九千百" (jp-str 9100)))
    (assert (equal "九千百一" (jp-str 9101)))
    (assert (equal "九千百十" (jp-str 9110)))
    (assert (equal "九千百十一" (jp-str 9111)))
    (assert (equal "九千百二十" (jp-str 9120)))
    (assert (equal "九千百二十一" (jp-str 9121)))
    (assert (equal "九千二百" (jp-str 9200)))
    (assert (equal "九千二百一" (jp-str 9201)))
    (assert (equal "九千二百十" (jp-str 9210)))
    (assert (equal "九千二百十一" (jp-str 9211)))
    (assert (equal "九千二百二十" (jp-str 9220)))
    (assert (equal "九千二百二十一" (jp-str 9221)))
    (assert (equal "九千九百九十九" (jp-str 9999)))
    ;; 
    t))

(defun test-jp-normal-integer-bignums ()
  (flet ((jp-str (n)
	   (format nil "~/jp-numeral:jp/" n)))
    ;; 10000 - 19999
    (assert (equal "一万" (jp-str 10000)))
    (assert (equal "一万一" (jp-str 10001)))
    (assert (equal "一万九" (jp-str 10009)))
    (assert (equal "一万十" (jp-str 10010)))
    (assert (equal "一万十一" (jp-str 10011)))
    (assert (equal "一万十九" (jp-str 10019)))
    (assert (equal "一万二十" (jp-str 10020)))
    (assert (equal "一万二十一" (jp-str 10021)))
    (assert (equal "一万二十九" (jp-str 10029)))
    (assert (equal "一万百" (jp-str 10100)))
    (assert (equal "一万百一" (jp-str 10101)))
    (assert (equal "一万百九" (jp-str 10109)))
    (assert (equal "一万百十" (jp-str 10110)))
    (assert (equal "一万百十一" (jp-str 10111)))
    (assert (equal "一万百十九" (jp-str 10119)))
    (assert (equal "一万百二十" (jp-str 10120)))
    (assert (equal "一万百二十一" (jp-str 10121)))
    (assert (equal "一万百二十九" (jp-str 10129)))
    (assert (equal "一万二百" (jp-str 10200)))
    (assert (equal "一万二百一" (jp-str 10201)))
    (assert (equal "一万二百九" (jp-str 10209)))
    (assert (equal "一万二百十" (jp-str 10210)))
    (assert (equal "一万二百十一" (jp-str 10211)))
    (assert (equal "一万二百十九" (jp-str 10219)))
    (assert (equal "一万二百二十" (jp-str 10220)))
    (assert (equal "一万二百二十一" (jp-str 10221)))
    (assert (equal "一万二百二十九" (jp-str 10229)))
    (assert (equal "一万千" (jp-str 11000)))
    (assert (equal "一万千一" (jp-str 11001)))
    (assert (equal "一万千九" (jp-str 11009)))
    (assert (equal "一万千十" (jp-str 11010)))
    (assert (equal "一万千十一" (jp-str 11011)))
    (assert (equal "一万千十九" (jp-str 11019)))
    (assert (equal "一万千二十" (jp-str 11020)))
    (assert (equal "一万千二十一" (jp-str 11021)))
    (assert (equal "一万千二十九" (jp-str 11029)))
    (assert (equal "一万千百" (jp-str 11100)))
    (assert (equal "一万千百一" (jp-str 11101)))
    (assert (equal "一万千百九" (jp-str 11109)))
    (assert (equal "一万千百十" (jp-str 11110)))
    (assert (equal "一万千百十一" (jp-str 11111)))
    (assert (equal "一万千百十九" (jp-str 11119)))
    (assert (equal "一万千百二十" (jp-str 11120)))
    (assert (equal "一万千百二十一" (jp-str 11121)))
    (assert (equal "一万千百二十九" (jp-str 11129)))
    (assert (equal "一万千二百" (jp-str 11200)))
    (assert (equal "一万千二百一" (jp-str 11201)))
    (assert (equal "一万千二百九" (jp-str 11209)))
    (assert (equal "一万千二百十" (jp-str 11210)))
    (assert (equal "一万千二百十一" (jp-str 11211)))
    (assert (equal "一万千二百十九" (jp-str 11219)))
    (assert (equal "一万千二百二十" (jp-str 11220)))
    (assert (equal "一万千二百二十一" (jp-str 11221)))
    (assert (equal "一万千二百二十九" (jp-str 11229)))
    (assert (equal "一万二千" (jp-str 12000)))
    (assert (equal "一万二千一" (jp-str 12001)))
    (assert (equal "一万二千九" (jp-str 12009)))
    (assert (equal "一万二千十" (jp-str 12010)))
    (assert (equal "一万二千十一" (jp-str 12011)))
    (assert (equal "一万二千十九" (jp-str 12019)))
    (assert (equal "一万二千二十" (jp-str 12020)))
    (assert (equal "一万二千二十一" (jp-str 12021)))
    (assert (equal "一万二千二十九" (jp-str 12029)))
    (assert (equal "一万二千百" (jp-str 12100)))
    (assert (equal "一万二千百一" (jp-str 12101)))
    (assert (equal "一万二千百九" (jp-str 12109)))
    (assert (equal "一万二千百十" (jp-str 12110)))
    (assert (equal "一万二千百十一" (jp-str 12111)))
    (assert (equal "一万二千百十九" (jp-str 12119)))
    (assert (equal "一万二千百二十" (jp-str 12120)))
    (assert (equal "一万二千百二十一" (jp-str 12121)))
    (assert (equal "一万二千百二十九" (jp-str 12129)))
    (assert (equal "一万二千二百" (jp-str 12200)))
    (assert (equal "一万二千二百一" (jp-str 12201)))
    (assert (equal "一万二千二百九" (jp-str 12209)))
    (assert (equal "一万二千二百十" (jp-str 12210)))
    (assert (equal "一万二千二百十一" (jp-str 12211)))
    (assert (equal "一万二千二百十九" (jp-str 12219)))
    (assert (equal "一万二千二百二十" (jp-str 12220)))
    (assert (equal "一万二千二百二十一" (jp-str 12221)))
    (assert (equal "一万二千二百二十九" (jp-str 12229)))
    (assert (equal "一万九千九百九十九" (jp-str 19999)))
    ;; 20000 - 99990000
    (assert (equal "二万" (jp-str 20000)))
    (assert (equal "九万" (jp-str 90000)))
    (assert (equal "十万" (jp-str 100000)))
    (assert (equal "十一万" (jp-str 110000)))
    (assert (equal "十九万" (jp-str 190000)))
    (assert (equal "二十万" (jp-str 200000)))
    (assert (equal "二十一万" (jp-str 210000)))
    (assert (equal "二十九万" (jp-str 290000)))
    (assert (equal "百万" (jp-str 1000000)))
    (assert (equal "百一万" (jp-str 1010000)))
    (assert (equal "百九万" (jp-str 1090000)))
    (assert (equal "百十万" (jp-str 1100000)))
    (assert (equal "百十一万" (jp-str 1110000)))
    (assert (equal "百十九万" (jp-str 1190000)))
    (assert (equal "百二十万" (jp-str 1200000)))
    (assert (equal "百二十一万" (jp-str 1210000)))
    (assert (equal "百二十九万" (jp-str 1290000)))
    (assert (equal "二百万" (jp-str 2000000)))
    (assert (equal "二百一万" (jp-str 2010000)))
    (assert (equal "二百九万" (jp-str 2090000)))
    (assert (equal "二百十万" (jp-str 2100000)))
    (assert (equal "二百十一万" (jp-str 2110000)))
    (assert (equal "二百十九万" (jp-str 2190000)))
    (assert (equal "二百二十万" (jp-str 2200000)))
    (assert (equal "二百二十一万" (jp-str 2210000)))
    (assert (equal "二百二十九万" (jp-str 2290000)))
    (assert (equal "千万" (jp-str 10000000)))
    (assert (equal "千一万" (jp-str 10010000)))
    (assert (equal "千九万" (jp-str 10090000)))
    (assert (equal "千十万" (jp-str 10100000)))
    (assert (equal "千十一万" (jp-str 10110000)))
    (assert (equal "千十九万" (jp-str 10190000)))
    (assert (equal "千二十万" (jp-str 10200000)))
    (assert (equal "千二十一万" (jp-str 10210000)))
    (assert (equal "千二十九万" (jp-str 10290000)))
    (assert (equal "千百万" (jp-str 11000000)))
    (assert (equal "千百一万" (jp-str 11010000)))
    (assert (equal "千百九万" (jp-str 11090000)))
    (assert (equal "千百十万" (jp-str 11100000)))
    (assert (equal "千百十一万" (jp-str 11110000)))
    (assert (equal "千百十九万" (jp-str 11190000)))
    (assert (equal "千百二十万" (jp-str 11200000)))
    (assert (equal "千百二十一万" (jp-str 11210000)))
    (assert (equal "千百二十九万" (jp-str 11290000)))
    (assert (equal "千二百万" (jp-str 12000000)))
    (assert (equal "千二百一万" (jp-str 12010000)))
    (assert (equal "千二百九万" (jp-str 12090000)))
    (assert (equal "千二百十万" (jp-str 12100000)))
    (assert (equal "千二百十一万" (jp-str 12110000)))
    (assert (equal "千二百十九万" (jp-str 12190000)))
    (assert (equal "千二百二十万" (jp-str 12200000)))
    (assert (equal "千二百二十一万" (jp-str 12210000)))
    (assert (equal "千二百二十九万" (jp-str 12290000)))
    (assert (equal "二千万" (jp-str 20000000)))
    (assert (equal "二千一万" (jp-str 20010000)))
    (assert (equal "二千九万" (jp-str 20090000)))
    (assert (equal "二千十万" (jp-str 20100000)))
    (assert (equal "二千十一万" (jp-str 20110000)))
    (assert (equal "二千十九万" (jp-str 20190000)))
    (assert (equal "二千二十万" (jp-str 20200000)))
    (assert (equal "二千二十一万" (jp-str 20210000)))
    (assert (equal "二千二十九万" (jp-str 20290000)))
    (assert (equal "二千百万" (jp-str 21000000)))
    (assert (equal "二千百一万" (jp-str 21010000)))
    (assert (equal "二千百九万" (jp-str 21090000)))
    (assert (equal "二千百十万" (jp-str 21100000)))
    (assert (equal "二千百十一万" (jp-str 21110000)))
    (assert (equal "二千百十九万" (jp-str 21190000)))
    (assert (equal "二千百二十万" (jp-str 21200000)))
    (assert (equal "二千百二十一万" (jp-str 21210000)))
    (assert (equal "二千百二十九万" (jp-str 21290000)))
    (assert (equal "二千二百万" (jp-str 22000000)))
    (assert (equal "二千二百一万" (jp-str 22010000)))
    (assert (equal "二千二百九万" (jp-str 22090000)))
    (assert (equal "二千二百十万" (jp-str 22100000)))
    (assert (equal "二千二百十一万" (jp-str 22110000)))
    (assert (equal "二千二百十九万" (jp-str 22190000)))
    (assert (equal "二千二百二十万" (jp-str 22200000)))
    (assert (equal "二千二百二十一万" (jp-str 22210000)))
    (assert (equal "二千二百二十九万" (jp-str 22290000)))
    (assert (equal "九千九百九十九万" (jp-str 99990000)))
    ;; 100000000 - 100009999
    (assert (equal "一億" (jp-str 100000000)))
    (assert (equal "一億一" (jp-str 100000001)))
    (assert (equal "一億九" (jp-str 100000009)))
    (assert (equal "一億十" (jp-str 100000010)))
    (assert (equal "一億十一" (jp-str 100000011)))
    (assert (equal "一億十九" (jp-str 100000019)))
    (assert (equal "一億二十" (jp-str 100000020)))
    (assert (equal "一億二十一" (jp-str 100000021)))
    (assert (equal "一億二十九" (jp-str 100000029)))
    (assert (equal "一億百" (jp-str 100000100)))
    (assert (equal "一億百一" (jp-str 100000101)))
    (assert (equal "一億百九" (jp-str 100000109)))
    (assert (equal "一億百十" (jp-str 100000110)))
    (assert (equal "一億百十一" (jp-str 100000111)))
    (assert (equal "一億百十九" (jp-str 100000119)))
    (assert (equal "一億百二十" (jp-str 100000120)))
    (assert (equal "一億百二十一" (jp-str 100000121)))
    (assert (equal "一億百二十九" (jp-str 100000129)))
    (assert (equal "一億二百" (jp-str 100000200)))
    (assert (equal "一億二百一" (jp-str 100000201)))
    (assert (equal "一億二百九" (jp-str 100000209)))
    (assert (equal "一億二百十" (jp-str 100000210)))
    (assert (equal "一億二百十一" (jp-str 100000211)))
    (assert (equal "一億二百十九" (jp-str 100000219)))
    (assert (equal "一億二百二十" (jp-str 100000220)))
    (assert (equal "一億二百二十一" (jp-str 100000221)))
    (assert (equal "一億二百二十九" (jp-str 100000229)))
    (assert (equal "一億千" (jp-str 100001000)))
    (assert (equal "一億千一" (jp-str 100001001)))
    (assert (equal "一億千九" (jp-str 100001009)))
    (assert (equal "一億千十" (jp-str 100001010)))
    (assert (equal "一億千十一" (jp-str 100001011)))
    (assert (equal "一億千十九" (jp-str 100001019)))
    (assert (equal "一億千二十" (jp-str 100001020)))
    (assert (equal "一億千二十一" (jp-str 100001021)))
    (assert (equal "一億千二十九" (jp-str 100001029)))
    (assert (equal "一億千百" (jp-str 100001100)))
    (assert (equal "一億千百一" (jp-str 100001101)))
    (assert (equal "一億千百九" (jp-str 100001109)))
    (assert (equal "一億千百十" (jp-str 100001110)))
    (assert (equal "一億千百十一" (jp-str 100001111)))
    (assert (equal "一億千百十九" (jp-str 100001119)))
    (assert (equal "一億千百二十" (jp-str 100001120)))
    (assert (equal "一億千百二十一" (jp-str 100001121)))
    (assert (equal "一億千百二十九" (jp-str 100001129)))
    (assert (equal "一億千二百" (jp-str 100001200)))
    (assert (equal "一億千二百一" (jp-str 100001201)))
    (assert (equal "一億千二百九" (jp-str 100001209)))
    (assert (equal "一億千二百十" (jp-str 100001210)))
    (assert (equal "一億千二百十一" (jp-str 100001211)))
    (assert (equal "一億千二百十九" (jp-str 100001219)))
    (assert (equal "一億千二百二十" (jp-str 100001220)))
    (assert (equal "一億千二百二十一" (jp-str 100001221)))
    (assert (equal "一億千二百二十九" (jp-str 100001229)))
    (assert (equal "一億二千" (jp-str 100002000)))
    (assert (equal "一億二千一" (jp-str 100002001)))
    (assert (equal "一億二千九" (jp-str 100002009)))
    (assert (equal "一億二千十" (jp-str 100002010)))
    (assert (equal "一億二千十一" (jp-str 100002011)))
    (assert (equal "一億二千十九" (jp-str 100002019)))
    (assert (equal "一億二千二十" (jp-str 100002020)))
    (assert (equal "一億二千二十一" (jp-str 100002021)))
    (assert (equal "一億二千二十九" (jp-str 100002029)))
    (assert (equal "一億二千百" (jp-str 100002100)))
    (assert (equal "一億二千百一" (jp-str 100002101)))
    (assert (equal "一億二千百九" (jp-str 100002109)))
    (assert (equal "一億二千百十" (jp-str 100002110)))
    (assert (equal "一億二千百十一" (jp-str 100002111)))
    (assert (equal "一億二千百十九" (jp-str 100002119)))
    (assert (equal "一億二千百二十" (jp-str 100002120)))
    (assert (equal "一億二千百二十一" (jp-str 100002121)))
    (assert (equal "一億二千百二十九" (jp-str 100002129)))
    (assert (equal "一億二千二百" (jp-str 100002200)))
    (assert (equal "一億二千二百一" (jp-str 100002201)))
    (assert (equal "一億二千二百九" (jp-str 100002209)))
    (assert (equal "一億二千二百十" (jp-str 100002210)))
    (assert (equal "一億二千二百十一" (jp-str 100002211)))
    (assert (equal "一億二千二百十九" (jp-str 100002219)))
    (assert (equal "一億二千二百二十" (jp-str 100002220)))
    (assert (equal "一億二千二百二十一" (jp-str 100002221)))
    (assert (equal "一億二千二百二十九" (jp-str 100002229)))
    (assert (equal "一億九千九百九十九" (jp-str 100009999)))
    ;; 100010000 - 100019999
    (assert (equal "一億一万" (jp-str 100010000)))
    (assert (equal "一億一万一" (jp-str 100010001)))
    (assert (equal "一億一万九" (jp-str 100010009)))
    (assert (equal "一億一万十" (jp-str 100010010)))
    (assert (equal "一億一万十一" (jp-str 100010011)))
    (assert (equal "一億一万十九" (jp-str 100010019)))
    (assert (equal "一億一万二十" (jp-str 100010020)))
    (assert (equal "一億一万二十一" (jp-str 100010021)))
    (assert (equal "一億一万二十九" (jp-str 100010029)))
    (assert (equal "一億一万百" (jp-str 100010100)))
    (assert (equal "一億一万百一" (jp-str 100010101)))
    (assert (equal "一億一万百九" (jp-str 100010109)))
    (assert (equal "一億一万百十" (jp-str 100010110)))
    (assert (equal "一億一万百十一" (jp-str 100010111)))
    (assert (equal "一億一万百十九" (jp-str 100010119)))
    (assert (equal "一億一万百二十" (jp-str 100010120)))
    (assert (equal "一億一万百二十一" (jp-str 100010121)))
    (assert (equal "一億一万百二十九" (jp-str 100010129)))
    (assert (equal "一億一万二百" (jp-str 100010200)))
    (assert (equal "一億一万二百一" (jp-str 100010201)))
    (assert (equal "一億一万二百九" (jp-str 100010209)))
    (assert (equal "一億一万二百十" (jp-str 100010210)))
    (assert (equal "一億一万二百十一" (jp-str 100010211)))
    (assert (equal "一億一万二百十九" (jp-str 100010219)))
    (assert (equal "一億一万二百二十" (jp-str 100010220)))
    (assert (equal "一億一万二百二十一" (jp-str 100010221)))
    (assert (equal "一億一万二百二十九" (jp-str 100010229)))
    (assert (equal "一億一万千" (jp-str 100011000)))
    (assert (equal "一億一万千一" (jp-str 100011001)))
    (assert (equal "一億一万千九" (jp-str 100011009)))
    (assert (equal "一億一万千十" (jp-str 100011010)))
    (assert (equal "一億一万千十一" (jp-str 100011011)))
    (assert (equal "一億一万千十九" (jp-str 100011019)))
    (assert (equal "一億一万千二十" (jp-str 100011020)))
    (assert (equal "一億一万千二十一" (jp-str 100011021)))
    (assert (equal "一億一万千二十九" (jp-str 100011029)))
    (assert (equal "一億一万千百" (jp-str 100011100)))
    (assert (equal "一億一万千百一" (jp-str 100011101)))
    (assert (equal "一億一万千百九" (jp-str 100011109)))
    (assert (equal "一億一万千百十" (jp-str 100011110)))
    (assert (equal "一億一万千百十一" (jp-str 100011111)))
    (assert (equal "一億一万千百十九" (jp-str 100011119)))
    (assert (equal "一億一万千百二十" (jp-str 100011120)))
    (assert (equal "一億一万千百二十一" (jp-str 100011121)))
    (assert (equal "一億一万千百二十九" (jp-str 100011129)))
    (assert (equal "一億一万千二百" (jp-str 100011200)))
    (assert (equal "一億一万千二百一" (jp-str 100011201)))
    (assert (equal "一億一万千二百九" (jp-str 100011209)))
    (assert (equal "一億一万千二百十" (jp-str 100011210)))
    (assert (equal "一億一万千二百十一" (jp-str 100011211)))
    (assert (equal "一億一万千二百十九" (jp-str 100011219)))
    (assert (equal "一億一万千二百二十" (jp-str 100011220)))
    (assert (equal "一億一万千二百二十一" (jp-str 100011221)))
    (assert (equal "一億一万千二百二十九" (jp-str 100011229)))
    (assert (equal "一億一万二千" (jp-str 100012000)))
    (assert (equal "一億一万二千一" (jp-str 100012001)))
    (assert (equal "一億一万二千九" (jp-str 100012009)))
    (assert (equal "一億一万二千十" (jp-str 100012010)))
    (assert (equal "一億一万二千十一" (jp-str 100012011)))
    (assert (equal "一億一万二千十九" (jp-str 100012019)))
    (assert (equal "一億一万二千二十" (jp-str 100012020)))
    (assert (equal "一億一万二千二十一" (jp-str 100012021)))
    (assert (equal "一億一万二千二十九" (jp-str 100012029)))
    (assert (equal "一億一万二千百" (jp-str 100012100)))
    (assert (equal "一億一万二千百一" (jp-str 100012101)))
    (assert (equal "一億一万二千百九" (jp-str 100012109)))
    (assert (equal "一億一万二千百十" (jp-str 100012110)))
    (assert (equal "一億一万二千百十一" (jp-str 100012111)))
    (assert (equal "一億一万二千百十九" (jp-str 100012119)))
    (assert (equal "一億一万二千百二十" (jp-str 100012120)))
    (assert (equal "一億一万二千百二十一" (jp-str 100012121)))
    (assert (equal "一億一万二千百二十九" (jp-str 100012129)))
    (assert (equal "一億一万二千二百" (jp-str 100012200)))
    (assert (equal "一億一万二千二百一" (jp-str 100012201)))
    (assert (equal "一億一万二千二百九" (jp-str 100012209)))
    (assert (equal "一億一万二千二百十" (jp-str 100012210)))
    (assert (equal "一億一万二千二百十一" (jp-str 100012211)))
    (assert (equal "一億一万二千二百十九" (jp-str 100012219)))
    (assert (equal "一億一万二千二百二十" (jp-str 100012220)))
    (assert (equal "一億一万二千二百二十一" (jp-str 100012221)))
    (assert (equal "一億一万二千二百二十九" (jp-str 100012229)))
    (assert (equal "一億一万九千九百九十九" (jp-str 100019999)))
    ;; 100020000 - 199990000
    (assert (equal "一億二万" (jp-str 100020000)))
    (assert (equal "一億九万" (jp-str 100090000)))
    (assert (equal "一億十万" (jp-str 100100000)))
    (assert (equal "一億十一万" (jp-str 100110000)))
    (assert (equal "一億十九万" (jp-str 100190000)))
    (assert (equal "一億二十万" (jp-str 100200000)))
    (assert (equal "一億二十一万" (jp-str 100210000)))
    (assert (equal "一億二十九万" (jp-str 100290000)))
    (assert (equal "一億百万" (jp-str 101000000)))
    (assert (equal "一億百一万" (jp-str 101010000)))
    (assert (equal "一億百九万" (jp-str 101090000)))
    (assert (equal "一億百十万" (jp-str 101100000)))
    (assert (equal "一億百十一万" (jp-str 101110000)))
    (assert (equal "一億百十九万" (jp-str 101190000)))
    (assert (equal "一億百二十万" (jp-str 101200000)))
    (assert (equal "一億百二十一万" (jp-str 101210000)))
    (assert (equal "一億百二十九万" (jp-str 101290000)))
    (assert (equal "一億二百万" (jp-str 102000000)))
    (assert (equal "一億二百一万" (jp-str 102010000)))
    (assert (equal "一億二百九万" (jp-str 102090000)))
    (assert (equal "一億二百十万" (jp-str 102100000)))
    (assert (equal "一億二百十一万" (jp-str 102110000)))
    (assert (equal "一億二百十九万" (jp-str 102190000)))
    (assert (equal "一億二百二十万" (jp-str 102200000)))
    (assert (equal "一億二百二十一万" (jp-str 102210000)))
    (assert (equal "一億二百二十九万" (jp-str 102290000)))
    (assert (equal "一億千万" (jp-str 110000000)))
    (assert (equal "一億千一万" (jp-str 110010000)))
    (assert (equal "一億千九万" (jp-str 110090000)))
    (assert (equal "一億千十万" (jp-str 110100000)))
    (assert (equal "一億千十一万" (jp-str 110110000)))
    (assert (equal "一億千十九万" (jp-str 110190000)))
    (assert (equal "一億千二十万" (jp-str 110200000)))
    (assert (equal "一億千二十一万" (jp-str 110210000)))
    (assert (equal "一億千二十九万" (jp-str 110290000)))
    (assert (equal "一億千百万" (jp-str 111000000)))
    (assert (equal "一億千百一万" (jp-str 111010000)))
    (assert (equal "一億千百九万" (jp-str 111090000)))
    (assert (equal "一億千百十万" (jp-str 111100000)))
    (assert (equal "一億千百十一万" (jp-str 111110000)))
    (assert (equal "一億千百十九万" (jp-str 111190000)))
    (assert (equal "一億千百二十万" (jp-str 111200000)))
    (assert (equal "一億千百二十一万" (jp-str 111210000)))
    (assert (equal "一億千百二十九万" (jp-str 111290000)))
    (assert (equal "一億千二百万" (jp-str 112000000)))
    (assert (equal "一億千二百一万" (jp-str 112010000)))
    (assert (equal "一億千二百九万" (jp-str 112090000)))
    (assert (equal "一億千二百十万" (jp-str 112100000)))
    (assert (equal "一億千二百十一万" (jp-str 112110000)))
    (assert (equal "一億千二百十九万" (jp-str 112190000)))
    (assert (equal "一億千二百二十万" (jp-str 112200000)))
    (assert (equal "一億千二百二十一万" (jp-str 112210000)))
    (assert (equal "一億千二百二十九万" (jp-str 112290000)))
    (assert (equal "一億二千万" (jp-str 120000000)))
    (assert (equal "一億二千一万" (jp-str 120010000)))
    (assert (equal "一億二千九万" (jp-str 120090000)))
    (assert (equal "一億二千十万" (jp-str 120100000)))
    (assert (equal "一億二千十一万" (jp-str 120110000)))
    (assert (equal "一億二千十九万" (jp-str 120190000)))
    (assert (equal "一億二千二十万" (jp-str 120200000)))
    (assert (equal "一億二千二十一万" (jp-str 120210000)))
    (assert (equal "一億二千二十九万" (jp-str 120290000)))
    (assert (equal "一億二千百万" (jp-str 121000000)))
    (assert (equal "一億二千百一万" (jp-str 121010000)))
    (assert (equal "一億二千百九万" (jp-str 121090000)))
    (assert (equal "一億二千百十万" (jp-str 121100000)))
    (assert (equal "一億二千百十一万" (jp-str 121110000)))
    (assert (equal "一億二千百十九万" (jp-str 121190000)))
    (assert (equal "一億二千百二十万" (jp-str 121200000)))
    (assert (equal "一億二千百二十一万" (jp-str 121210000)))
    (assert (equal "一億二千百二十九万" (jp-str 121290000)))
    (assert (equal "一億二千二百万" (jp-str 122000000)))
    (assert (equal "一億二千二百一万" (jp-str 122010000)))
    (assert (equal "一億二千二百九万" (jp-str 122090000)))
    (assert (equal "一億二千二百十万" (jp-str 122100000)))
    (assert (equal "一億二千二百十一万" (jp-str 122110000)))
    (assert (equal "一億二千二百十九万" (jp-str 122190000)))
    (assert (equal "一億二千二百二十万" (jp-str 122200000)))
    (assert (equal "一億二千二百二十一万" (jp-str 122210000)))
    (assert (equal "一億二千二百二十九万" (jp-str 122290000)))
    (assert (equal "一億九千九百九十九万" (jp-str 199990000)))

    ;; more big nums
    (let ((num 12300001001))
      (assert (equal "百二十三億千一" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三兆千一万" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三京千一億" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三垓千一兆" (jp-str num)))
      (mulf num 10000)
      (when (<= #x25771 char-code-limit) ; contains U+25771 (10^24)
	(assert (equal "百二十三𥝱千一京" (jp-str num))))
      (mulf num 10000)
      (assert (equal "百二十三穣千一垓" (jp-str num)))
      (mulf num 10000)
      (when (<= #x25771 char-code-limit) ; contains U+25771 (10^24)
	(assert (equal "百二十三溝千一𥝱" (jp-str num))))
      (mulf num 10000)
      (assert (equal "百二十三澗千一穣" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三正千一溝" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三載千一澗" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三極千一正" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三恒河沙千一載" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三阿僧祇千一極" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三那由他千一恒河沙" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三不可思議千一阿僧祇" (jp-str num)))
      (mulf num 10000)
      (assert (equal "百二十三無量大数千一那由他" (jp-str num))))
    t))

(defun test-jp-normal-integer-minus ()
  (flet ((jp-str (n)
	   (format nil "~/jp-numeral:jp/" n)))
    (assert (equal "マイナス一" (jp-str -1)))
    (assert (equal "マイナス二" (jp-str -2)))
    (assert (equal "マイナス三" (jp-str -3)))
    (assert (equal "マイナス四" (jp-str -4)))
    (assert (equal "マイナス五" (jp-str -5)))
    (assert (equal "マイナス六" (jp-str -6)))
    (assert (equal "マイナス七" (jp-str -7)))
    (assert (equal "マイナス八" (jp-str -8)))
    (assert (equal "マイナス九" (jp-str -9)))
    (assert (equal "マイナス十" (jp-str -10)))
    (assert (equal "マイナス二十" (jp-str -20)))
    (assert (equal "マイナス百" (jp-str -100)))
    (assert (equal "マイナス五百" (jp-str -500)))
    (assert (equal "マイナス千" (jp-str -1000)))
    (assert (equal "マイナス一万" (jp-str -10000)))
    (assert (equal "マイナス一万二千三百四十五" (jp-str -12345)))
    t))
  
(defun test-jp-normal-rational ()
  (flet ((jp-str (n)
	   (format nil "~/jp-numeral:jp/" n)))
    (assert (equal "二分の一" (jp-str 1/2)))
    (assert (equal "十分の一" (jp-str 1/10)))
    (assert (equal "二十分の一" (jp-str 1/20)))
    (assert (equal "百分の一" (jp-str 1/100)))
    (assert (equal "百十分の一" (jp-str 1/110)))
    (assert (equal "百十一分の一" (jp-str 1/111)))
    (assert (equal "百二十分の一" (jp-str 1/120)))
    (assert (equal "百二十一分の一" (jp-str 1/121)))
    (assert (equal "二百分の一" (jp-str 1/200)))
    (assert (equal "二百十分の一" (jp-str 1/210)))
    (assert (equal "二百十一分の一" (jp-str 1/211)))
    (assert (equal "二百二十分の一" (jp-str 1/220)))
    (assert (equal "二百二十一分の一" (jp-str 1/221)))
    (assert (equal "千分の一" (jp-str 1/1000)))
    (assert (equal "千十分の一" (jp-str 1/1010)))
    (assert (equal "千十一分の一" (jp-str 1/1011)))
    (assert (equal "千二十分の一" (jp-str 1/1020)))
    (assert (equal "千二十一分の一" (jp-str 1/1021)))
    (assert (equal "千百分の一" (jp-str 1/1100)))
    (assert (equal "千百十分の一" (jp-str 1/1110)))
    (assert (equal "千百十一分の一" (jp-str 1/1111)))
    (assert (equal "千百二十分の一" (jp-str 1/1120)))
    (assert (equal "千百二十一分の一" (jp-str 1/1121)))
    (assert (equal "二千二百一分の一" (jp-str 1/2201)))
    (assert (equal "一万分の一" (jp-str 1/10000)))
    (assert (equal "一万千百十一分の一" (jp-str 1/11111)))
    (assert (equal "二万二千二百二十二分の一" (jp-str 1/22222)))
    (assert (equal "一億分の一" (jp-str 1/100000000)))

    (assert (equal "一万九千九百九十七分の一" (jp-str 1/19997))) ; 19997 is a prime.
    (assert (equal "一万九千九百九十七分の二" (jp-str 2/19997)))
    (assert (equal "一万九千九百九十七分の十" (jp-str 10/19997)))
    (assert (equal "一万九千九百九十七分の十一" (jp-str 11/19997)))
    (assert (equal "一万九千九百九十七分の二十一" (jp-str 21/19997)))
    (assert (equal "一万九千九百九十七分の九十九" (jp-str 99/19997)))
    (assert (equal "一万九千九百九十七分の百" (jp-str 100/19997)))
    (assert (equal "一万九千九百九十七分の百一" (jp-str 101/19997)))
    (assert (equal "一万九千九百九十七分の百十一" (jp-str 111/19997)))
    (assert (equal "一万九千九百九十七分の二百十一" (jp-str 211/19997)))
    (assert (equal "一万九千九百九十七分の千一" (jp-str 1001/19997)))
    (assert (equal "一万九千九百九十七分の千百十一" (jp-str 1111/19997)))
    (assert (equal "一万九千九百九十七分の二千二百二十二" (jp-str 2222/19997)))
    (assert (equal "一万九千九百九十七分の一万" (jp-str 10000/19997)))
    (assert (equal "一万九千九百九十七分の一万一" (jp-str 10001/19997)))
    (assert (equal "一万九千九百九十七分の一万千百十" (jp-str 11110/19997)))
    (assert (equal "一万九千九百九十七分の一万五千二" (jp-str 15002/19997)))
    (assert (equal "一万九千九百九十七分の一万九千九百九十六" (jp-str 19996/19997)))

    (assert (equal "マイナス二分の一" (jp-str -1/2)))
    t))
  

(defun main ()
  (and (test-jp-normal-integer-4digits)
       (test-jp-normal-integer-bignums)
       (test-jp-normal-integer-minus)
       (test-jp-normal-rational)
       ;; TODO:
       ;; - float
       ;; - checks fallback to positional  
       t))
